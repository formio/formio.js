<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">src/Webform.unit.js | formiojs</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="JavaScript powered Forms with JSON Form Builder"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="formiojs"><meta property="twitter:description" content="JavaScript powered Forms with JSON Form Builder"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/formio/formio.js"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/EventEmitter.js~EventEmitter.html">EventEmitter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Form.js~Form.html">Form</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/FormBuilder.js~FormBuilder.html">FormBuilder</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Formio.js~Formio.html">Formio</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/PDFBuilder.js~PDFBuilder.html">PDFBuilder</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/WizardBuilder.js~WizardBuilder.html">WizardBuilder</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-embed">embed</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-GlobalFormio">GlobalFormio</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#addons">addons</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/addons/FormioAddon.js~FormioAddon.html">FormioAddon</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-editForms">editForms</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#builders">builders</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/builders/Builders.js~Builders.html">Builders</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components">components</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/Components.js~Components.html">Components</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components--classes-component">components/_classes/component</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Component">Component</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components--classes-component-editform">components/_classes/component/editForm</a><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EditFormUtils">EditFormUtils</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components--classes-field">components/_classes/field</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/_classes/field/Field.js~Field.html">Field</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components--classes-nested">components/_classes/nested</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-NestedComponent">NestedComponent</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-address">components/address</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Address">Address</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-button">components/button</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Button">Button</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-checkbox">components/checkbox</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/checkbox/Checkbox.js~CheckBoxComponent.html">CheckBoxComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Checkbox">Checkbox</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-columns">components/columns</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Columns">Columns</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-container">components/container</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/container/Container.js~ContainerComponent.html">ContainerComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Container">Container</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-content">components/content</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Content">Content</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-currency">components/currency</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/currency/Currency.js~CurrencyComponent.html">CurrencyComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Currency">Currency</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-datagrid">components/datagrid</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-DataGrid">DataGrid</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-datamap">components/datamap</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-DataMap">DataMap</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-datetime">components/datetime</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/datetime/DateTime.js~DateTimeComponent.html">DateTimeComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-DateTime">DateTime</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-day">components/day</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Day">Day</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-editgrid">components/editgrid</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-EditGrid">EditGrid</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-email">components/email</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/email/Email.js~EmailComponent.html">EmailComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Email">Email</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-fieldset">components/fieldset</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/fieldset/Fieldset.js~FieldsetComponent.html">FieldsetComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Fieldset">Fieldset</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-file">components/file</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-File">File</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-form">components/form</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Form">Form</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-hidden">components/hidden</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/hidden/Hidden.js~HiddenComponent.html">HiddenComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Hidden">Hidden</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-html">components/html</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/html/HTML.js~HTMLComponent.html">HTMLComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-HTML">HTML</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-number">components/number</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Number">Number</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-panel">components/panel</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Panel">Panel</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-password">components/password</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/password/Password.js~PasswordComponent.html">PasswordComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Password">Password</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-phonenumber">components/phonenumber</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/phonenumber/PhoneNumber.js~PhoneNumberComponent.html">PhoneNumberComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-PhoneNumber">PhoneNumber</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-radio">components/radio</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Radio">Radio</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-recaptcha">components/recaptcha</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/recaptcha/ReCaptcha.js~ReCaptchaComponent.html">ReCaptchaComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ReCaptcha">ReCaptcha</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-resource">components/resource</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/resource/Resource.js~ResourceComponent.html">ResourceComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Resource">Resource</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-select">components/select</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Select">Select</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-select-fixtures">components/select/fixtures</a><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-multiSelect">multiSelect</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-multiSelectOptions">multiSelectOptions</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-selectboxes">components/selectboxes</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-SelectBoxes">SelectBoxes</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-signature">components/signature</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Signature">Signature</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-survey">components/survey</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Survey">Survey</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-table">components/table</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/table/Table.js~TableComponent.html">TableComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Table">Table</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-tabs">components/tabs</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/tabs/Tabs.js~TabsComponent.html">TabsComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Tabs">Tabs</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-tags">components/tags</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/tags/Tags.js~TagsComponent.html">TagsComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Tags">Tags</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-textarea">components/textarea</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-TextArea">TextArea</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-textfield">components/textfield</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-TextField">TextField</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-time">components/time</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/time/Time.js~TimeComponent.html">TimeComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Time">Time</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-tree">components/tree</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/tree/Node.js~Node.html">Node</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Tree">Tree</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-unknown">components/unknown</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/unknown/Unknown.js~UnknownComponent.html">UnknownComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Unknown">Unknown</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-url">components/url</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/url/Url.js~UrlComponent.html">UrlComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Url">Url</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-well">components/well</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/well/Well.js~WellComponent.html">WellComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Well">Well</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#contrib">contrib</a><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Contrib">Contrib</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#contrib-edittable">contrib/edittable</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/contrib/edittable/EditTable.js~EditTableComponent.html">EditTableComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-EditTable">EditTable</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#contrib-location">contrib/location</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/contrib/location/Location.js~LocationComponent.html">LocationComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Location">Location</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#contrib-modaledit">contrib/modaledit</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/contrib/modaledit/ModalEdit.js~ModalEditComponent.html">ModalEditComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ModalEdit">ModalEdit</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#contrib-stripe-checkout">contrib/stripe/checkout</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/contrib/stripe/checkout/StripeCheckout.js~StripeCheckoutComponent.html">StripeCheckoutComponent</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#contrib-stripe-stripe">contrib/stripe/stripe</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/contrib/stripe/stripe/Stripe.js~StripeComponent.html">StripeComponent</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#displays">displays</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/displays/Displays.js~Displays.html">Displays</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#providers">providers</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/providers/Providers.js~Providers.html">Providers</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#providers-address">providers/address</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/providers/address/AddressProvider.js~AddressProvider.html">AddressProvider</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/providers/address/AzureAddressProvider.js~AzureAddressProvider.html">AzureAddressProvider</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/providers/address/CustomAddressProvider.js~CustomAddressProvider.html">CustomAddressProvider</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/providers/address/NominatimAddressProvider.js~NominatimAddressProvider.html">NominatimAddressProvider</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#providers-processor">providers/processor</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-fileProcessor">fileProcessor</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#providers-storage">providers/storage</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-azure">azure</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-base64">base64</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-dropbox">dropbox</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-googledrive">googledrive</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-indexeddb">indexeddb</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-s3">s3</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getFormioUploadAdapterPlugin">getFormioUploadAdapterPlugin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-url">url</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setXhrHeaders">setXhrHeaders</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-XHR">XHR</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#templates">templates</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/templates/Templates.js~Templates.html">Templates</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#templates-bootstrap">templates/bootstrap</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-iconClass">iconClass</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#utils">utils</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/utils/ChoicesWrapper.js~ChoicesWrapper.html">ChoicesWrapper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-checkInvalidDate">checkInvalidDate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-lessOrGreater">lessOrGreater</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-applyFormChanges">applyFormChanges</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-eachComponent">eachComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-escapeRegExCharacters">escapeRegExCharacters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-findComponent">findComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-findComponents">findComponents</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-flattenComponents">flattenComponents</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-formatAsCurrency">formatAsCurrency</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generateFormChange">generateFormChange</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getComponent">getComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getStrings">getStrings</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getValue">getValue</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-hasCondition">hasCondition</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isLayoutComponent">isLayoutComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-matchComponent">matchComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-parseFloatExt">parseFloatExt</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-removeComponent">removeComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-searchComponents">searchComponents</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-KEY_CODES">KEY_CODES</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Evaluator">Evaluator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-CALENDAR_ERROR_MESSAGES">CALENDAR_ERROR_MESSAGES</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#utils-jsonlogic">utils/jsonlogic</a><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-lodashOperators">lodashOperators</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#validator">validator</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/validator/Rules.js~Rules.html">Rules</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#validator-conjunctions">validator/conjunctions</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/validator/conjunctions/index.js~Conjunctions.html">Conjunctions</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#validator-operators">validator/operators</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/validator/operators/index.js~Operators.html">Operators</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#validator-quickrules">validator/quickRules</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/validator/quickRules/index.js~QuickRules.html">QuickRules</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#validator-transformers">validator/transformers</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/validator/transformers/index.js~Transformers.html">Transformers</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#validator-valuesources">validator/valueSources</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/validator/valueSources/index.js~ValueSources.html">ValueSources</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#widgets">widgets</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/widgets/InputWidget.js~InputWidget.html">InputWidget</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/Webform.unit.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import assert from &apos;power-assert&apos;;
import { expect } from &apos;chai&apos;;
import sinon from &apos;sinon&apos;;
import _ from &apos;lodash&apos;;
import each from &apos;lodash/each&apos;;
import i18next from &apos;i18next&apos;;
import Harness from &apos;../test/harness&apos;;
import FormTests from &apos;../test/forms&apos;;
import Webform from &apos;./Webform&apos;;
import &apos;flatpickr&apos;;
import Formio from &apos;./Formio&apos;;
import {
  settingErrors,
  clearOnHide,
  manualOverride,
  validationOnBlur,
  calculateValueWithManualOverride,
  formWithAdvancedLogic,
  formWithPatternValidation,
  calculatedSelectboxes,
  calculateZeroValue,
  formWithConditionalLogic,
  formWithCalculatedValueWithoutOverriding,
  formWithTimeComponent,
  formWithEditGridModalDrafts,
  formWithBlurValidationInsidePanel,
  modalEditComponents,
  calculatedNotPersistentValue,
  calculateValueInEditingMode,
  initiallyCollapsedPanel,
  multipleTextareaInsideConditionalComponent,
  disabledNestedForm,
  formWithEditGridAndNestedDraftModalRow,
  formWithDateTimeComponents,
  formWithCollapsedPanel,
  formWithCustomFormatDate,
} from &apos;../test/formtest&apos;;
import DataGridOnBlurValidation from &apos;../test/forms/dataGridOnBlurValidation&apos;;
import UpdateErrorClassesWidgets from &apos;../test/forms/updateErrorClasses-widgets&apos;;
import nestedModalWizard from &apos;../test/forms/nestedModalWizard&apos;;
import disableSubmitButton from &apos;../test/forms/disableSubmitButton&apos;;
import formWithAddressComponent from &apos;../test/forms/formWithAddressComponent&apos;;
import formWithDataGridInitEmpty from &apos;../test/forms/dataGridWithInitEmpty&apos;;
import nestedFormInsideDataGrid from &apos;../test/forms/dataGrid-nestedForm&apos;;
import formWithDataGrid from &apos;../test/forms/formWithDataGrid&apos;;
import translationTestForm from &apos;../test/forms/translationTestForm&apos;;
import formWithDataGridWithCondColumn from &apos;../test/forms/dataGridWithConditionalColumn&apos;;
import { nestedFormInWizard } from &apos;../test/fixtures&apos;;
import NativePromise from &apos;native-promise-only&apos;;
import { fastCloneDeep } from &apos;../lib/utils/utils&apos;;

import truncateMultipleSpaces from &apos;../test/forms/truncateMultipleSpaces&apos;;
import calculatedValue from &apos;../test/forms/calculatedValue&apos;;
import conditionalDataGridWithTableAndRadio from &apos;../test/forms/conditionalDataGridWithTableAndRadio&apos;;
import calculateValueWithManualOverrideLableValueDataGrid
  from &apos;../test/forms/calculateValueWithManualOverrideLableValueDataGrid&apos;;
import deeplyNestedDataGridAndContainer from &apos;../test/forms/nestedDataGridsAndContainers&apos;;
import columnWithConditionalComponents from &apos;../test/forms/columnWithConditionalComponents&apos;;
import formWithSurvey from &apos;../test/forms/formWithSurvey&apos;;
import formWithSelectBoxes from &apos;../test/forms/formWithSelectBoxes&apos;;
import formWithDayComp from &apos;../test/forms/formWithDayComp&apos;;
import formWithCalcValue from &apos;../test/forms/formWithCalcValue&apos;;
import formWithAllowCalculateOverride from &apos;../test/forms/formWithAllowCalculateOverride&apos;;
import testClearOnHideInsideEditGrid from &apos;../test/forms/clearOnHideInsideEditGrid&apos;;
import formWithNestedDataGridInitEmpty from &apos;../test/forms/nestedDataGridWithInitEmpty&apos;;
import * as FormioUtils from &apos;./utils/utils&apos;;
import htmlRenderMode from &apos;../test/forms/htmlRenderMode&apos;;
import optionalSanitize from &apos;../test/forms/optionalSanitize&apos;;

global.requestAnimationFrame = (cb) =&gt; cb();
global.cancelAnimationFrame = () =&gt; {};

/* eslint-disable max-statements */
describe(&apos;Webform tests&apos;, function() {
  this.retries(3);

  it(&apos;Should recalculate value when submission is being set in edit mode&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement);

    form.setForm(formWithCalcValue).then(() =&gt; {
      const numberComp = form.getComponent(&apos;number&apos;);
      const checkbox = form.getComponent(&apos;checkbox&apos;);

      form.setSubmission({}).then(() =&gt; {
        setTimeout(() =&gt; {
          assert.equal(numberComp.dataValue, 0);
          assert.equal(checkbox.dataValue, true);
          form.setSubmission({ data: { number: 7, checkbox: true } }).then(() =&gt; {
            setTimeout(() =&gt; {
              assert.equal(numberComp.dataValue, 7);
              assert.equal(checkbox.dataValue, false);
              done();
            }, 500);
          });
        }, 500);
      });
    }).catch((err) =&gt; done(err));
  });

  it(&apos;Should show survey values in html render mode&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement, { renderMode: &apos;html&apos;, readOnly: true });

    form.setForm(formWithSurvey).then(() =&gt; {
      form.setSubmission({ data: { survey: { question1: &apos;a3&apos;, question2: &apos;a1&apos; } } }).then(() =&gt; {
        const survey = form.getComponent(&apos;survey&apos;);
        const values = survey.element.querySelectorAll(&apos;td&apos;);

        assert.equal(values.length, 2);
        assert.equal(values[0].innerHTML.trim(), &apos;a3&apos;);
        assert.equal(values[1].innerHTML.trim(), &apos;a1&apos;);
        done();
      });
   }).catch((err) =&gt; done(err));
  });

  it(&apos;Should show select boxes values in html render mode&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement, { renderMode: &apos;html&apos;, readOnly: true });

    form.setForm(formWithSelectBoxes).then(() =&gt; {
      form.setSubmission({ data: { selectBoxes: { a: true, b: true, c: false } } }).then(() =&gt; {
        const selectBoxes = form.getComponent(&apos;selectBoxes&apos;);
        const values = selectBoxes.element.querySelector(&apos;[ref=&quot;value&quot;]&apos;).textContent.trim();

        assert.equal(values, &apos;a, b&apos;);
        done();
      });
   }).catch((err) =&gt; done(err));
  });

  it(&apos;Should show day value in html render mode&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement, { renderMode: &apos;html&apos;, readOnly: true });

    form.setForm(formWithDayComp).then(() =&gt; {
      form.setSubmission({ data: { day: &apos;05/07/2020&apos; } }).then(() =&gt; {
        const day = form.getComponent(&apos;day&apos;);
        const value = day.element.querySelector(&apos;[ref=&quot;value&quot;]&apos;).textContent.trim();

        assert.equal(value, &apos;05/07/2020&apos;);
        done();
      });
   }).catch((err) =&gt; done(err));
  });

  it(&apos;Should allow to input value and add rows in deeply nested conditional dataGrid&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement);

    form.setForm(deeplyNestedDataGridAndContainer).then(() =&gt; {
      const parentDataGrid = form.getComponent(&apos;dataGrid6&apos;);

      assert.equal(parentDataGrid.rows.length, 1);
      assert.equal(parentDataGrid.rows[0].dataGrid5.visible, false);

      const checkbox = form.getComponent(&apos;checkbox&apos;);
      checkbox.setValue(true);

      setTimeout(() =&gt; {
        assert.equal(parentDataGrid.rows.length, 1);
        assert.equal(parentDataGrid.rows[0].dataGrid5.visible, true);

        const numberInput = parentDataGrid.rows[0].dataGrid5.rows[0].number.refs.input[0];
        numberInput.value = 555;

        const inputEvent = new Event(&apos;input&apos;);
        numberInput.dispatchEvent(inputEvent);

        setTimeout(() =&gt; {
          const conditionalDataGrid = form.getComponent(&apos;dataGrid6&apos;).rows[0].dataGrid5;
          const numberComp = conditionalDataGrid.rows[0].number;

          assert.equal(numberComp.dataValue, 555);
          assert.equal(numberComp.refs.input[0].value, 555);

          const addRowBtn = conditionalDataGrid.refs[`${&apos;datagrid-dataGrid5-addRow&apos;}`][0];
          const clickEvent = new Event(&apos;click&apos;);
          addRowBtn.dispatchEvent(clickEvent);

          setTimeout(() =&gt; {
            assert.equal(conditionalDataGrid.rows.length, 2);
            done();
          }, 300);
        }, 300);
      }, 300);
    }).catch((err) =&gt; done(err));
  });

  it(&apos;Should adjust columns when conditional fields appear/disappear&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement);

    form.setForm(columnWithConditionalComponents).then(() =&gt; {
      const selectBoxes = form.getComponent(&apos;selectBoxes&apos;);
      const columns = form.getComponent(&apos;columns&apos;);

      columns.columns.forEach((column, index) =&gt; {
        assert.equal(column[0].visible, false,  `Column ${index + 1} component should be hidden`);
        assert.equal( columns.component.columns[index].currentWidth, 0,  `Column ${index + 1}  width should be 0`);
      });

      selectBoxes.setValue({ &apos;1&apos;: false, &apos;2&apos;: false, &apos;3&apos;: true, &apos;4&apos;: false, &apos;5&apos;: false, &apos;6&apos;: true });

      setTimeout(() =&gt; {
        columns.columns.forEach((column, index) =&gt; {
          if ([3,6].includes(index+1)) {
            assert.equal(column[0].visible, true, `Column ${index + 1} component should be visible`);
            assert.equal(columns.component.columns[index].currentWidth, 2, `Column ${index + 1}  width should be 2`);
          }
          else {
            assert.equal(column[0].visible, false, `Column ${index + 1} component should be hidden`);
            assert.equal( columns.component.columns[index].currentWidth, 0, `Column ${index + 1}  width should be 0`);
          }
        });

        const visibleTextField1 = columns.columns[2][0].refs.input[0];
        const visibleTextField2 = columns.columns[5][0].refs.input[0];

        visibleTextField1.value = &apos;test   &apos;;
        visibleTextField2.value = &apos; some &apos;;

        const inputEvent = new Event(&apos;input&apos;);
        visibleTextField1.dispatchEvent(inputEvent);
        visibleTextField2.dispatchEvent(inputEvent);

        setTimeout(() =&gt; {
          const visibleTextField1 = columns.columns[2][0].refs.input[0];
          const visibleTextField2 = columns.columns[5][0].refs.input[0];

          assert.equal(visibleTextField1.value,&apos;test   &apos;, &apos;Should not cut whitespaces while inputting into the conditional component inside column&apos;);
          assert.equal(visibleTextField2.value,&apos; some &apos;, &apos;Should not cut whitespaces while inputting into the conditional component inside column&apos;);
          selectBoxes.setValue({ &apos;1&apos;: false, &apos;2&apos;: false, &apos;3&apos;: false, &apos;4&apos;: false, &apos;5&apos;: false, &apos;6&apos;: true });

          setTimeout(() =&gt; {
            columns.columns.forEach((column, index) =&gt; {
              if ([6].includes(index+1)) {
                assert.equal(column[0].visible, true, `Column ${index + 1} component should be visible`);
                assert.equal( columns.component.columns[index].currentWidth, 2,  `Column ${index + 1}  width should be 2`);
              }
              else {
                assert.equal(column[0].visible, false, `Column ${index + 1} component should be hidden`);
                assert.equal( columns.component.columns[index].currentWidth, 0,  `Column ${index + 1}  width should be 0`);
              }
            });
            done();
          }, 300);
        }, 300);
      }, 300);
    }).catch((err) =&gt; done(err));
  });

  it(&apos;Should not translate en value if _userInput option is provided and value presents in reserved translation names&apos;, done =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement, {
     language: &apos;en&apos;
    });
    form.setForm(translationTestForm).then(() =&gt; {
      setTimeout(() =&gt; {
        const selectComp = form.getComponent(&apos;select&apos;);
        const options = selectComp.element.querySelector(&apos;[role=&quot;listbox&quot;]&apos;).children;
        const option1 = options[0].textContent.trim();
        const option2 = options[1].textContent.trim();
        const label = selectComp.element.querySelector(&apos;label&apos;).textContent.trim();
        assert.equal(option1, translationTestForm.components[0].data.values[0].label);
        assert.equal(option2, translationTestForm.components[0].data.values[1].label);
        assert.equal(label, translationTestForm.components[0].label);
        document.body.innerHTML = &apos;&apos;;
        done();
      }, 100);
    }).catch(done);
  });

  it(&apos;Should translate in English if _userInput option is provided and value does not present in reserved translation names&apos;, done =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    const selectLabel = &apos;Select test label&apos;;
    const translationForm = fastCloneDeep(translationTestForm);
    translationForm.components[0].label = selectLabel;
    const form = new Webform(formElement, {
      language: &apos;en&apos;,
      i18n: {
        en: {
          &apos;Select test label&apos;: &apos;English Label&apos;
        },
        fr: {
          &apos;Select test label&apos;: &apos;French Label&apos;
        }
      }
    });

    form.setForm(translationForm).then(() =&gt; {
      const selectComp = form.getComponent(&apos;select&apos;);
      const label = selectComp.element.querySelector(&apos;label&apos;).textContent.trim();

      assert.equal(label, &apos;English Label&apos;);
      document.body.innerHTML = &apos;&apos;;
      done();
    }).catch(done);
  });

  it(&apos;Should translate value in franch if _userInput option is provided and value does not present in reserved translation names&apos;, done =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    const selectLabel = &apos;Select test label&apos;;
    const translationForm = fastCloneDeep(translationTestForm);
    translationForm.components[0].label = selectLabel;
    const form = new Webform(formElement, {
      language: &apos;fr&apos;,
      i18n: {
        en: {
          &apos;Select test label&apos;: &apos;English Label&apos;
        },
        fr: {
          &apos;Select test label&apos;: &apos;French Label&apos;
        }
      }
    });

    form.setForm(translationForm).then(() =&gt; {
      const selectComp = form.getComponent(&apos;select&apos;);
      const label = selectComp.element.querySelector(&apos;label&apos;).textContent.trim();

      assert.equal(label, &apos;French Label&apos;);
      document.body.innerHTML = &apos;&apos;;
      done();
    }).catch(done);
  });

  it(&apos;Should display dataGrid conditional column once the condition is met&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const formWithCondDataGridColumn = new Webform(formElement);

    formWithCondDataGridColumn.setForm(formWithDataGridWithCondColumn).then(() =&gt; {
      const condDataGridField = formWithCondDataGridColumn.element.querySelector( &apos;[name=&quot;data[dataGrid][0][numberCond]&quot;]&apos;);
      assert.equal(!!condDataGridField, false);

      const textField = formWithCondDataGridColumn.element.querySelector( &apos;[name=&quot;data[textField]&quot;]&apos;);
      textField.value = &apos;show&apos;;

      const inputEvent = new Event(&apos;input&apos;);
      textField.dispatchEvent(inputEvent);

      setTimeout(() =&gt; {
        const condDataGridFieldAfterFulfillingCond = formWithCondDataGridColumn.element.querySelector( &apos;[name=&quot;data[dataGrid][0][numberCond]&quot;]&apos;);
        assert.equal(!!condDataGridFieldAfterFulfillingCond, true);

        done();
      }, 300);
    }).catch((err) =&gt; done(err));
  });

  it(&apos;Should remove dataGrid extra rows and components after setting value with less row number&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const formWithDG = new Webform(formElement);

    formWithDG.setForm(formWithDataGrid.form).then(() =&gt; {
    formWithDG.setSubmission(formWithDataGrid.submission3rows);

      setTimeout(() =&gt; {
        assert.equal(formWithDG.components[0].rows.length, 3);
        assert.equal(formWithDG.components[0].components.length, 3);

        formWithDG.setSubmission(formWithDataGrid.submission1row);

        setTimeout(() =&gt; {
          assert.equal(formWithDG.components[0].rows.length, 1);
          assert.equal(formWithDG.components[0].components.length, 1);

          done();
        }, 200);
      }, 100);
    }).catch((err) =&gt; done(err));
  });

  it(&apos;Should not delete/change date value in dataGrid after adding new row&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const formWithDate = new Webform(formElement);

    formWithDate.setForm(formWithCustomFormatDate).then(() =&gt; {
      setTimeout(() =&gt; {
        const clickEvent = new Event(&apos;click&apos;);

        const dateCompInputWidget = formWithDate.element.querySelector(&apos;.formio-component-textField&apos;).querySelector(&apos;.flatpickr-input&apos;).widget;
        const dateAltFormat = dateCompInputWidget.calendar.config.altFormat;
        dateCompInputWidget.calendar.setDate(&apos;30-05-2020&apos;, true, dateAltFormat);

        const dateCompInputWidget1 = formWithDate.element.querySelector(&apos;.formio-component-dateTime&apos;).querySelector(&apos;.flatpickr-input&apos;).widget;
        const dateAltFormat1 = dateCompInputWidget1.calendar.config.altFormat;
        dateCompInputWidget1.calendar.setDate(&apos;30-05-2020&apos;, true, dateAltFormat1);

        const dateCompInputWidget2 = formWithDate.element.querySelector(&apos;.formio-component-textField2&apos;).querySelector(&apos;.flatpickr-input&apos;).widget;
        const dateAltFormat2 = dateCompInputWidget2.calendar.config.altFormat;
        dateCompInputWidget2.calendar.setDate(&apos;30-05-2020&apos;, true, dateAltFormat2);

        setTimeout(() =&gt; {
        const dateCompAltInput = formWithDate.element.querySelector(&apos;.formio-component-textField&apos;).querySelector(&apos;.flatpickr-input&apos;);
        const dateComp = formWithDate.element.querySelector(&apos;.formio-component-textField&apos;).querySelector(&apos;[type=&quot;text&quot;]&apos;);

        const dateCompAltInput1 = formWithDate.element.querySelector(&apos;.formio-component-dateTime&apos;).querySelector(&apos;.flatpickr-input&apos;);
        const dateComp1 = formWithDate.element.querySelector(&apos;.formio-component-dateTime&apos;).querySelector(&apos;[type=&quot;text&quot;]&apos;);

        const dateCompAltInput2 = formWithDate.element.querySelector(&apos;.formio-component-textField2&apos;).querySelector(&apos;.flatpickr-input&apos;);
        const dateComp2 = formWithDate.element.querySelector(&apos;.formio-component-textField2&apos;).querySelector(&apos;[type=&quot;text&quot;]&apos;);

        assert.equal(dateCompAltInput.value,&apos;30-05-2020&apos;);
        assert.equal(dateComp.value,&apos;30-05-2020&apos;);

        assert.equal(dateCompAltInput1.value,&apos;2020-05-30T00:00:00&apos;);
        assert.equal(dateComp1.value,&apos;30-05-2020&apos;);

        assert.equal(dateCompAltInput2.value,&apos;2020-05-30T00:00:00&apos;);
        assert.equal(dateComp2.value,&apos;30-05-2020&apos;);

        const addNewRowBtn = formWithDate.element.querySelector(&apos;.formio-button-add-row&apos;);
        addNewRowBtn.dispatchEvent(clickEvent);

        setTimeout(() =&gt; {
          const dataGridRows = formWithDate.element.querySelectorAll(&apos;[ref=&quot;datagrid-dataGrid-row&quot;]&apos;);
          assert.equal(dataGridRows.length, 2);

          const dateCompAltInputAfterAddingRow = formWithDate.element.querySelectorAll(&apos;.formio-component-textField&apos;)[0].querySelector(&apos;.flatpickr-input&apos;);
          const dateCompAfterAddingRow = formWithDate.element.querySelectorAll(&apos;.formio-component-textField&apos;)[0].querySelector(&apos;[type=&quot;text&quot;]&apos;);

          const dateCompAltInputAfterAddingRow1 = formWithDate.element.querySelectorAll(&apos;.formio-component-dateTime&apos;)[0].querySelector(&apos;.flatpickr-input&apos;);
          const dateCompAfterAddingRow1 = formWithDate.element.querySelectorAll(&apos;.formio-component-dateTime&apos;)[0].querySelector(&apos;[type=&quot;text&quot;]&apos;);

          const dateCompAltInputAfterAddingRow2 = formWithDate.element.querySelectorAll(&apos;.formio-component-textField2&apos;)[0].querySelector(&apos;.flatpickr-input&apos;);
          const dateCompAfterAddingRow2 = formWithDate.element.querySelectorAll(&apos;.formio-component-textField2&apos;)[0].querySelector(&apos;[type=&quot;text&quot;]&apos;);

          assert.equal(dateCompAltInputAfterAddingRow.value,&apos;30-05-2020&apos;);
          assert.equal(dateCompAfterAddingRow.value,&apos;30-05-2020&apos;);

          assert.equal(dateCompAltInputAfterAddingRow1.value,&apos;2020-05-30T00:00:00&apos;);
          assert.equal(dateCompAfterAddingRow1.value,&apos;30-05-2020&apos;);

          assert.equal(dateCompAltInputAfterAddingRow2.value,&apos;2020-05-30T00:00:00&apos;);
          assert.equal(dateCompAfterAddingRow2.value,&apos;30-05-2020&apos;);

          done();
         }, 150);
        }, 50);
      }, 100);
    }).catch((err) =&gt; done(err));
  });

  it(&apos;Should open collapsed panel with invalid components inside container that is inside the panel on submit&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const formWithPanel = new Webform(formElement);

    formWithPanel.setForm(formWithCollapsedPanel).then(() =&gt; {
      const clickEvent = new Event(&apos;click&apos;);

      assert.equal(formWithPanel.components[0].collapsed, true);

      const submitBtn = formWithPanel.element.querySelector(&apos;[name=&quot;data[submit]&quot;]&apos;);
      submitBtn.dispatchEvent(clickEvent);

      setTimeout(() =&gt; {
        assert.equal(formWithPanel.components[0].collapsed, false);
        done();
      }, 200);
    }).catch((err) =&gt; done(err));
  });

  it(&apos;Should correctly set date after collapsing and openning the panel&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const formWithDate = new Webform(formElement);

    formWithDate.setForm(formWithDateTimeComponents).then(() =&gt; {
      const clickEvent = new Event(&apos;click&apos;);

      const dateTimeCompInputWidget = formWithDate.element.querySelector(&apos;.formio-component-dateTime1&apos;).querySelector(&apos;.flatpickr-input&apos;).widget;
      const dateTimeAltFormat = dateTimeCompInputWidget.calendar.config.altFormat;
      dateTimeCompInputWidget.calendar.setDate(&apos;05-05-2020T00:00:00&apos;, true, dateTimeAltFormat);

      const textFieldDateCompWidget = formWithDate.element.querySelector(&apos;.formio-component-textField1&apos;).querySelector(&apos;.flatpickr-input&apos;).widget;
      const textFieldDateAltFormat = textFieldDateCompWidget.calendar.config.altFormat;
      textFieldDateCompWidget.calendar.setDate(&apos;04-04-2020T00:00:00&apos;, true, textFieldDateAltFormat);

      setTimeout(() =&gt; {
      const dateTimeCompAltInput = formWithDate.element.querySelector(&apos;.formio-component-dateTime1&apos;).querySelector(&apos;.flatpickr-input&apos;);
      const textFieldDateCompAltInput = formWithDate.element.querySelector(&apos;.formio-component-textField1&apos;).querySelector(&apos;.flatpickr-input&apos;);

      const dateTimeComp = formWithDate.element.querySelector(&apos;.formio-component-dateTime1&apos;).querySelector(&apos;[type=&quot;text&quot;]&apos;);
      const textFieldDateComp = formWithDate.element.querySelector(&apos;.formio-component-textField1&apos;).querySelector(&apos;[type=&quot;text&quot;]&apos;);

      assert.equal(dateTimeCompAltInput.value,&apos;2020-05-05T00:00:00&apos;);
      assert.equal(textFieldDateCompAltInput.value,&apos;2020-04-04T00:00:00&apos;);

      assert.equal(dateTimeComp.value,&apos;05-05-2020&apos;);
      assert.equal(textFieldDateComp.value,&apos;04-04-2020&apos;);

      const panelCollapseBtn = formWithDate.element.querySelector(&apos;.formio-collapse-icon&apos;);
      panelCollapseBtn.dispatchEvent(clickEvent);

      setTimeout(() =&gt; {
        const panelBody = formWithDate.element.querySelector(&apos;.panel-body&apos;);
        assert.equal(!!panelBody, false);

        formWithDate.element.querySelector(&apos;.formio-collapse-icon&apos;).dispatchEvent(clickEvent);

        setTimeout(() =&gt; {
          const dateTimeCompAfterOpenningPanel = formWithDate.element.querySelector(&apos;.formio-component-dateTime1&apos;).querySelector(&apos;[type=&quot;text&quot;]&apos;);
          const textFieldDateCompAfterOpenningPanel = formWithDate.element.querySelector(&apos;.formio-component-textField1&apos;).querySelector(&apos;[type=&quot;text&quot;]&apos;);

          const dateTimeCompAltInputAfterOpenningPanel = formWithDate.element.querySelector(&apos;.formio-component-dateTime1&apos;).querySelector(&apos;.flatpickr-input&apos;);
          const textFieldDateCompAltInputAfterOpenningPanel = formWithDate.element.querySelector(&apos;.formio-component-textField1&apos;).querySelector(&apos;.flatpickr-input&apos;);

          assert.equal(dateTimeCompAltInputAfterOpenningPanel.value,&apos;2020-05-05T00:00:00&apos;);
          assert.equal(textFieldDateCompAltInputAfterOpenningPanel.value,&apos;2020-04-04T00:00:00&apos;);

          assert.equal(dateTimeCompAfterOpenningPanel.value,&apos;05-05-2020&apos;);
          assert.equal(textFieldDateCompAfterOpenningPanel.value,&apos;04-04-2020&apos;);
          done();
         }, 250);
       }, 150);
      }, 50);
    }).catch((err) =&gt; done(err));
  });

  it(`Should show confirmation alert when clicking X btn or clicking outside modal window after editing
  editGrid modal draft row`, function(done) {
   const formElement = document.createElement(&apos;div&apos;);
   const formWithNestedDraftModals = new Webform(formElement);

   formWithNestedDraftModals.setForm(formWithEditGridAndNestedDraftModalRow).then(() =&gt; {
     const editGrid = formWithNestedDraftModals.getComponent(&apos;editGrid&apos;);
     const clickEvent = new Event(&apos;click&apos;);
     const inputEvent = new Event(&apos;input&apos;);

     const addRowBtn = formWithNestedDraftModals.element.querySelector( &apos;[ref=&quot;editgrid-editGrid-addRow&quot;]&apos;);
     //click to open row in modal view
     addRowBtn.dispatchEvent(clickEvent);

     setTimeout(() =&gt; {
       const rowModal = document.querySelector(`.editgrid-row-modal-${editGrid.id}`);
       //checking if row modal was openned
       assert.equal(!!rowModal, true);

       const textField = rowModal.querySelector(&apos;[name=&quot;data[textField]&quot;]&apos;);
       textField.value = &apos;test&apos;;
       //input value
       textField.dispatchEvent(inputEvent);

       setTimeout(() =&gt; {
         //checking if the value was set inside the field
         assert.equal(textField.value, &apos;test&apos;);

         const saveModalBtn = rowModal.querySelector(&apos;.btn-primary&apos;);
         //clicking save button to save row draft
         saveModalBtn.dispatchEvent(clickEvent);

        setTimeout(() =&gt; {
          const editGridRows = formWithNestedDraftModals.element.querySelectorAll(&apos;[ref=&quot;editgrid-editGrid-row&quot;]&apos;);
          //checking if the editGrid row was created
          assert.equal(editGridRows.length, 1);

          const editRowBtn = editGridRows[0].querySelector(&apos;.editRow&apos;);
          //click the edit btn to open the row again
          editRowBtn.dispatchEvent(clickEvent);

          setTimeout(() =&gt; {
            const rowModalForEditing = document.querySelector(`.editgrid-row-modal-${editGrid.id}`);
            const textFieldInputForEditing = rowModalForEditing.querySelector(&apos;[name=&quot;data[textField]&quot;]&apos;);
            textFieldInputForEditing.value = &apos;changed value&apos;;
            //changing textfield value
            textFieldInputForEditing.dispatchEvent(inputEvent);

            setTimeout(() =&gt; {
              //checking if the textfield value was changed
              const inputValue = textFieldInputForEditing.value;
              assert.equal(inputValue, &apos;changed value&apos;);

              const XCloseBtn = rowModalForEditing.querySelector(&apos;[ref=&quot;dialogClose&quot;]&apos;);
              //clicking modal close btn
              XCloseBtn.dispatchEvent(clickEvent);

                setTimeout(() =&gt; {
                  const dialogConfirmationWindows = document.querySelectorAll(`.editgrid-row-modal-confirmation-${editGrid.id}`);
                  //checking if confirmation dialog is openned
                  assert.equal(dialogConfirmationWindows.length, 1);

                  const dialogCancelBtn = dialogConfirmationWindows[0].querySelector(&apos;[ref=&quot;dialogCancelButton&quot;]&apos;);
                  //closing confirmation dialog
                  dialogCancelBtn.dispatchEvent(clickEvent);

                  setTimeout(() =&gt; {
                    const confirmationWindows = document.querySelectorAll(`.editgrid-row-modal-confirmation-${editGrid.id}`);
                    //checking if confirmation dialig is closed
                    assert.equal(confirmationWindows.length, 0);

                    const dialog = document.querySelector(`.editgrid-row-modal-${editGrid.id}`);
                    const overlay = dialog.querySelector(&apos;[ref=&quot;dialogOverlay&quot;]&apos;);
                    //clocking model overlay to open confirmation dialog again
                    overlay.dispatchEvent(clickEvent);

                    setTimeout(() =&gt; {
                      const confirmationDialogsAfterClickingOverlay = document.querySelectorAll(`.editgrid-row-modal-confirmation-${editGrid.id}`);
                      assert.equal(confirmationDialogsAfterClickingOverlay.length, 1);

                      document.body.innerHTML = &apos;&apos;;
                      done();
                     }, 190);
                   }, 170);
                 }, 150);
              }, 130);
            }, 110);
          }, 100);
        }, 70);
      }, 50);
    }).catch((err) =&gt; done(err));
 });

  it(&apos;Should not show validation errors when saving invalid draft row in dataGrid&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const formWithDraftModals = new Webform(formElement);

    formWithDraftModals.setForm(formWithEditGridModalDrafts).then(() =&gt; {
      const clickEvent = new Event(&apos;click&apos;);
      const inputEvent = new Event(&apos;input&apos;);

      const addRowBtn =  formWithDraftModals.element.querySelector( &apos;[ref=&quot;editgrid-editGrid-addRow&quot;]&apos;);
      //click to open row in modal view
      addRowBtn.dispatchEvent(clickEvent);

      setTimeout(() =&gt; {
        const rowModal = document.querySelector(&apos;.formio-dialog-content&apos;);
        //checking if row modal was openned
        assert.equal(!!rowModal, true);

        const textFieldInput = rowModal.querySelector(&apos;[name=&quot;data[editGrid][0][textField]&quot;]&apos;);
        textFieldInput.value = &apos;test&apos;;
        //input value in one of required row fields
        textFieldInput.dispatchEvent(inputEvent);

        setTimeout(() =&gt; {
          //checking if the value was set inside the field
          assert.equal(textFieldInput.value, &apos;test&apos;);

          const saveModalBtn = rowModal.querySelector(&apos;.btn-primary&apos;);
          //clicking save button to save row draft
          saveModalBtn.dispatchEvent(clickEvent);

          setTimeout(() =&gt; {
            const editGridRows = formWithDraftModals.element.querySelectorAll( &apos;[ref=&quot;editgrid-editGrid-row&quot;]&apos;);
            //checking if the editGrid row was created
            assert.equal(editGridRows.length, 1);
            const rowError = formWithDraftModals.element.querySelector(&apos;.editgrid-row-error&apos;).textContent.trim();
            const editGridError = formWithDraftModals.element.querySelector(&apos;[ref=&quot;messageContainer&quot;]&apos;).querySelector(&apos;.error&apos;);

            assert.equal(!!rowError, false);
            assert.equal(!!editGridError, false);

            done();
          }, 200);
        }, 100);
      }, 50);
    }).catch((err) =&gt; done(err));
  });

  it(&apos;Should show dataGrid rows when viewing submission in dataGrid with initEmpty option&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const formWithDataGridInitEmptyOption = new Webform(formElement);

    formWithDataGridInitEmptyOption.setForm(formWithDataGridInitEmpty.form).then(() =&gt; {
      formWithDataGridInitEmptyOption.setSubmission(formWithDataGridInitEmpty.submission2);

      setTimeout(() =&gt; {
        const dataGridRows =  formWithDataGridInitEmptyOption.element.querySelectorAll(&apos;[ref = &quot;datagrid-dataGrid-row&quot;]&apos;);
        const dataGrid1Rows =  formWithDataGridInitEmptyOption.element.querySelectorAll(&apos;[ref = &quot;datagrid-dataGrid1-row&quot;]&apos;);

        assert.equal(dataGrid1Rows.length, 1);
        assert.equal(dataGridRows.length, 1);

        formWithDataGridInitEmptyOption.setSubmission(formWithDataGridInitEmpty.submission3);

        setTimeout(() =&gt; {
          const dataGridRows1 =  formWithDataGridInitEmptyOption.element.querySelectorAll(&apos;[ref = &quot;datagrid-dataGrid-row&quot;]&apos;);
          const dataGrid1Rows1 =  formWithDataGridInitEmptyOption.element.querySelectorAll(&apos;[ref = &quot;datagrid-dataGrid1-row&quot;]&apos;);
          const dataGridSecondRowComponentValue = formWithDataGridInitEmptyOption.element.querySelector(&apos;[name = &quot;data[dataGrid][1][textField]&quot;]&apos;);
          const dataGrid1FirstRowComponentValue = formWithDataGridInitEmptyOption.element.querySelector(&apos;[name = &quot;data[dataGrid1][0][textArea]&quot;]&apos;);
          const dataGrid1SecondRowComponentValue = formWithDataGridInitEmptyOption.element.querySelector(&apos;[name = &quot;data[dataGrid1][1][number]&quot;]&apos;);

          assert.equal(dataGrid1Rows1.length, 2);
          assert.equal(dataGridRows1.length, 2);
          assert.equal(dataGridSecondRowComponentValue.value, &apos;test2&apos;);
          assert.equal(dataGrid1FirstRowComponentValue.textContent, &apos;test3&apos;);
          assert.equal(dataGrid1SecondRowComponentValue.value, 222);

          done();
        }, 300);
      }, 200);
    })
    .catch((err) =&gt; done(err));
  });

  it(&apos;Should not show dataGrid rows when empty submission is set for dataGrid with initEmpty&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const formWithDataGridInitEmptyOption = new Webform(formElement);

    formWithDataGridInitEmptyOption.setForm(formWithDataGridInitEmpty.form).then(() =&gt; {
      formWithDataGridInitEmptyOption.setSubmission(formWithDataGridInitEmpty.submission1);

      setTimeout(() =&gt; {
        const dataGridRows =  formWithDataGridInitEmptyOption.element.querySelectorAll(&apos;[ref = &quot;datagrid-dataGrid-row&quot;]&apos;);
        const dataGrid1Rows =  formWithDataGridInitEmptyOption.element.querySelectorAll(&apos;[ref = &quot;datagrid-dataGrid1-row&quot;]&apos;);

        assert.equal(dataGridRows.length, 0);
        assert.equal(dataGrid1Rows.length, 0);

        formWithDataGridInitEmptyOption.setSubmission({ data: {} });
        setTimeout(() =&gt; {
          const dataGridRows1 =  formWithDataGridInitEmptyOption.element.querySelectorAll(&apos;[ref = &quot;datagrid-dataGrid-row&quot;]&apos;);
          const dataGrid1Rows1 =  formWithDataGridInitEmptyOption.element.querySelectorAll(&apos;[ref = &quot;datagrid-dataGrid1-row&quot;]&apos;);

          assert.equal(dataGridRows1.length, 0);
          assert.equal(dataGrid1Rows1.length, 0);

          done();
        }, 300);
      }, 200);
    })
    .catch((err) =&gt; done(err));
  });

  it(&apos;Should show address submission data inside dataGrid&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const formWithAddress = new Webform(formElement);

    formWithAddress.setForm(formWithAddressComponent.form).then(() =&gt; {
      formWithAddress.setSubmission({ data: formWithAddressComponent.submission });

      setTimeout(() =&gt; {
        const addressInput = formWithAddress.element.querySelector(&apos;[name = &quot;data[dataGrid][0][address]&quot;]&apos;);

        assert.equal(addressInput.value, formWithAddressComponent.submission.dataGrid[0].address[&apos;formatted_address&apos;]);

        done();
      }, 300);
    })
    .catch((err) =&gt; done(err));
  });

  it(&apos;Should validate field on blur inside panel&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const formWithBlurValidation = new Webform(formElement);

    formWithBlurValidation.setForm(formWithBlurValidationInsidePanel).then(() =&gt; {
      const inputEvent = new Event(&apos;input&apos;);
      const focusEvent = new Event(&apos;focus&apos;);
      const blurEvent = new Event(&apos;blur&apos;);
      const fieldWithBlurValidation = formWithBlurValidation.element.querySelector(&apos;[name=&quot;data[textField]&quot;]&apos;);

      fieldWithBlurValidation.dispatchEvent(focusEvent);
        &apos;test&apos;.split(&apos;&apos;).forEach(character =&gt; {
          fieldWithBlurValidation.value = fieldWithBlurValidation.value + character;
          fieldWithBlurValidation.dispatchEvent(inputEvent);
      });

      setTimeout(() =&gt; {
        const validationErrorBeforeBlur = formWithBlurValidation.element.querySelector(&apos;.error&apos;);
        assert.equal(!!validationErrorBeforeBlur, false);
        assert.equal(formWithBlurValidation.data.textField, &apos;test&apos;);

        fieldWithBlurValidation.dispatchEvent(blurEvent);

        setTimeout(() =&gt; {
          const validationErrorAfterBlur = formWithBlurValidation.element.querySelector(&apos;.error&apos;);

          assert.equal(!!validationErrorAfterBlur, true);
          assert.equal(validationErrorAfterBlur.textContent, &apos;Text Field must have at least 5 characters.&apos;);

          done();
        }, 350);
      }, 300);
    })
    .catch((err) =&gt; done(err));
  });

  it(&apos;Should submit form with empty time field when time field is not required&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const formWithTime = new Webform(formElement);

    formWithTime.setForm(formWithTimeComponent).then(() =&gt; {
      const clickEvent = new Event(&apos;click&apos;);
      const submitBtn = formWithTime.element.querySelector(&apos;[name=&quot;data[submit]&quot;]&apos;);

      submitBtn.dispatchEvent(clickEvent);

      setTimeout(() =&gt; {
        assert.equal(formWithTime.errors.length, 0);
        assert.equal(formWithTime.data.submit, true);

        done();
      }, 200);
    })
    .catch((err) =&gt; done(err));
  });

  it(`Should show validation errors and update validation errors list when openning and editing edit grid rows
  in draft modal mode after pushing submit btn`, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const formWithDraftModals = new Webform(formElement, { sanitize: true });

    formWithDraftModals.setForm(formWithEditGridModalDrafts).then(() =&gt; {
      const clickEvent = new Event(&apos;click&apos;);
      const inputEvent = new Event(&apos;input&apos;);

      const addRowBtn = formWithDraftModals.element.querySelector( &apos;[ref=&quot;editgrid-editGrid-addRow&quot;]&apos;);
      //click to open row in modal view
      addRowBtn.dispatchEvent(clickEvent);

      setTimeout(() =&gt; {
        const editGrid = formWithDraftModals.getComponent(&apos;editGrid&apos;);

        assert.equal(editGrid.editRows.length, 1, &apos;Should create a row&apos;);

        const rowModal = editGrid.editRows[0].dialog;
        //checking if row modal was openned
        assert.equal(!!rowModal, true, &apos;Should open a modal window&apos;);

        const textFieldInput = rowModal.querySelector(&apos;[name=&quot;data[editGrid][0][textField]&quot;]&apos;);
        textFieldInput.value = &apos;test&apos;;
        //input value in one of required row fields
        textFieldInput.dispatchEvent(inputEvent);

        setTimeout(() =&gt; {
          //checking if the value was set inside the field
          assert.equal(textFieldInput.value, &apos;test&apos;);

          const saveModalBtn = rowModal.querySelector(&apos;.btn-primary&apos;);
          //clicking save button to save row draft
          saveModalBtn.dispatchEvent(clickEvent);

          setTimeout(() =&gt; {
            const editGridRows = formWithDraftModals.element.querySelectorAll( &apos;[ref=&quot;editgrid-editGrid-row&quot;]&apos;);
            //checking if the editGrid row was created
            assert.equal(editGridRows.length, 1);

            const submitBtn = formWithDraftModals.element.querySelector(&apos;[name=&quot;data[submit]&quot;]&apos;);
            //pushing submit button to trigger validation
            submitBtn.dispatchEvent(clickEvent);

            setTimeout(() =&gt; {
              //checking the number of appeared errors
              assert.equal(formWithDraftModals.errors.length, 2);

              const rowError = formWithDraftModals.element.querySelector(&apos;.editgrid-row-error&apos;).textContent.trim();
              const editGridError = formWithDraftModals.element.querySelector(&apos;[ref=&quot;messageContainer&quot;]&apos;).querySelector(&apos;.error&apos;).textContent;
              //checking if right errors were shown in right places
              assert.equal(rowError, &apos;Invalid row. Please correct it or delete.&apos;);
              assert.equal(editGridError, &apos;Please correct invalid rows before proceeding.&apos;);

              const rowEditBtn = editGridRows[0].querySelector(&apos;.editRow&apos;);
              //open row modal again to check if there are errors
              rowEditBtn.dispatchEvent(clickEvent);

              setTimeout(() =&gt; {
                const rowModalAfterValidation = editGrid.editRows[0].dialog;

                const alertWithErrorText = rowModalAfterValidation.querySelector(&apos;.alert-danger&apos;);
                //checking if alert with errors list appeared inside the modal
                assert.equal(!!alertWithErrorText, true, &apos;Should show error alert&apos;);

                const alertErrorMessages = rowModalAfterValidation.querySelectorAll(&apos;[ref=&quot;messageRef&quot;]&apos;);
                assert.equal(alertErrorMessages.length, 1);

                const numberComponentError = rowModalAfterValidation.querySelector(&apos;.formio-component-number&apos;).querySelector(&apos;.error&apos;).textContent;
                //checking if error was shown for empty required field
                assert.equal(numberComponentError, &apos;Number is required&apos;);

                const numberInput = rowModalAfterValidation.querySelector(&apos;[name=&quot;data[editGrid][0][number]&quot;]&apos;);
                numberInput.value = 123;
                //input value to make the field valid
                numberInput.dispatchEvent(inputEvent);

                setTimeout(() =&gt; {
                  const rowModalWithValidFields = document.querySelector(`.editgrid-row-modal-${editGrid.id}`);
                  const alertErrorMessagesAfterInputtingValidValues = rowModalWithValidFields.querySelectorAll(&apos;[ref=&quot;messageRef&quot;]&apos;);
                  assert.equal(alertErrorMessagesAfterInputtingValidValues.length, 0);

                  //input values to make all row fields invalid
                  const validNumberInput = rowModalWithValidFields.querySelector(&apos;[name=&quot;data[editGrid][0][number]&quot;]&apos;);
                  validNumberInput.value = null;
                  validNumberInput.dispatchEvent(inputEvent);

                  const validTextInput = rowModalWithValidFields.querySelector(&apos;[name=&quot;data[editGrid][0][textField]&quot;]&apos;);
                  validTextInput.value = &apos;&apos;;
                  validTextInput.dispatchEvent(inputEvent);

                  setTimeout(() =&gt; {
                    const alertErrorMessagesAfterInputtingInvalidValues = document
                      .querySelector(`.editgrid-row-modal-${editGrid.id}`)
                      .querySelectorAll(&apos;[ref=&quot;messageRef&quot;]&apos;);

                    assert.equal(alertErrorMessagesAfterInputtingInvalidValues.length, 2);
                    document.body.innerHTML = &apos;&apos;;

                    done();
                  }, 280);
                }, 240);
              }, 200);
            }, 160);
          }, 120);
        }, 80);
      }, 50);
    }).catch((err) =&gt; done(err));
  });

  it(&apos;Should not override calculated value&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const formWithCalculatedAmount = new Webform(formElement);

    formWithCalculatedAmount.setForm(formWithCalculatedValueWithoutOverriding).then(() =&gt; {
      const inputEvent = new Event(&apos;input&apos;);

      const amountInput1 = formWithCalculatedAmount.element.querySelector(&apos;[name=&quot;data[amount1]&quot;]&apos;);
      const amountInput2 = formWithCalculatedAmount.element.querySelector(&apos;[name=&quot;data[amount2]&quot;]&apos;);

      amountInput1.value = 6;
      amountInput2.value = 4;

      amountInput1.dispatchEvent(inputEvent);
      amountInput2.dispatchEvent(inputEvent);

      setTimeout(() =&gt; {
        const totalAmountInput = formWithCalculatedAmount.element.querySelector(&apos;[name=&quot;data[currency]&quot;]&apos;);
        //checking if the value was calculated correctly
        assert.equal(totalAmountInput.value, &apos;$10.00&apos;);

        const inputEvent = new Event(&apos;input&apos;);
        //trying to override calculated value
        totalAmountInput.value =  55;
        totalAmountInput.dispatchEvent(inputEvent);

        setTimeout(() =&gt; {
          const totalAmountInput = formWithCalculatedAmount.element.querySelector(&apos;[name=&quot;data[currency]&quot;]&apos;);
          //checking if the value was overridden
          assert.equal(totalAmountInput.value, &apos;$10.00&apos;);

          done();
        }, 400);
      }, 300);
    })
    .catch((err) =&gt; done(err));
  });

  it(&apos;Should modify calculated value only if it was not manually modified when allowCalculateOverride is true&apos;, (done) =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement);

    form.setForm(formWithAllowCalculateOverride).then(() =&gt; {
      const labelComp = form.getComponent(&apos;label&apos;);
      const valueComp = form.getComponent(&apos;value&apos;);

      const inputEvent = new Event(&apos;input&apos;);
      const labelInput = labelComp.refs.input[0];
      const valueInput = valueComp.refs.input[0];
      labelInput.value = &apos;Hello&apos;;
      labelInput.dispatchEvent(inputEvent);

      setTimeout(() =&gt; {
        assert.equal(labelComp.dataValue, &apos;Hello&apos;);
        assert.equal(valueComp.dataValue, &apos;hello&apos;);

        valueInput.value = &apos;hello123&apos;;
        valueInput.dispatchEvent(inputEvent);

        setTimeout(() =&gt; {
          assert.equal(valueComp.dataValue, &apos;hello123&apos;);

          labelInput.value = &apos;HeLLo World&apos;;
          labelInput.dispatchEvent(inputEvent);

          setTimeout(() =&gt; {
            assert.equal(labelComp.dataValue, &apos;HeLLo World&apos;);
            assert.equal(valueComp.dataValue, &apos;hello123&apos;);
            done();
          }, 500);
        }, 500);
      }, 500);
    }).catch(done);
  });

  it(`Should show field only in container where radio component has &apos;yes&apos; value when containers contain radio
  components with the same key`, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const formWithCondition = new Webform(formElement);

    formWithCondition.setForm(formWithConditionalLogic).then(() =&gt; {
      Harness.clickElement(formWithCondition, formWithCondition.element.querySelector(&apos;.formio-component-container1&apos;).querySelector(&apos;[value=&quot;yes&quot;]&apos;));

      setTimeout(() =&gt; {
        const conditionalFieldInContainer1 = formWithCondition.element.querySelector(&apos;[name=&quot;data[container1][textField]&quot;]&apos;);
        const conditionalFieldInContainer2 = formWithCondition.element.querySelector(&apos;[name=&quot;data[container2][textField]&quot;]&apos;);

        assert.equal(!!conditionalFieldInContainer1, true);
        assert.equal(!!conditionalFieldInContainer2, false);

        done();
      }, 400);
    })
    .catch((err) =&gt; done(err));
  });

  it(&apos;Should show only &quot;required field&quot; error when submitting empty required field with pattern validation&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const formWithPattern = new Webform(formElement);

    formWithPattern.setForm(formWithPatternValidation).then(() =&gt; {
    Harness.clickElement(formWithPattern, formWithPattern.element.querySelector(&apos;[name=&quot;data[submit]&quot;]&apos;));

    setTimeout(() =&gt; {
      assert.equal(formWithPattern.element.querySelector(&apos;.formio-component-textField&apos;).querySelectorAll(&apos;.error&apos;).length, 1);
      assert.equal(formWithPattern.errors[0].messages.length, 1);
      assert.equal(formWithPattern.errors[0].messages[0].message, &apos;Text Field is required&apos;);
      assert.equal(formWithPattern.element.querySelector(&apos;[ref=&quot;errorRef&quot;]&apos;).textContent.trim(), &apos;Text Field is required&apos;);
      done();
    }, 500);
    })
    .catch((err) =&gt; done(err));
  });

  it(&apos;Should disable field applying advanced logic if dot is used inside component key&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const formWithLogic = new Webform(formElement);

    formWithLogic.setForm(formWithAdvancedLogic).then(() =&gt; {
      assert.equal(formWithLogic.components[1].disabled, false);

      Harness.clickElement(formWithLogic, formWithLogic.element.querySelector(&apos;[name=&quot;data[requestedCovers.HOUSECONTENT_JEWELRY]&quot;]&apos;));

      setTimeout(() =&gt; {
        assert.equal(formWithLogic.components[1].disabled, true);
        done();
      }, 500);
    })
    .catch((err) =&gt; done(err));
  });

  it(&apos;Should only scroll to alerts dialog when submitting an invalid form&apos;, function(done) {
    const formJson =  {
      components: [
        {
          &apos;label&apos;: &apos;Number&apos;,
          &apos;inputFormat&apos;: &apos;plain&apos;,
          &apos;validate&apos;: {
            &apos;required&apos;: true,
            &apos;max&apos;: 10
          },
          &apos;key&apos;: &apos;number&apos;,
          &apos;type&apos;: &apos;number&apos;,
          &apos;input&apos;: true
        },
        {
          label: &apos;Submit&apos;,
          showValidations: false,
          tableView: false,
          key: &apos;submit&apos;,
          type: &apos;button&apos;,
          input: true,
          saveOnEnter: false,
        }
      ]
    };

    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement);
    const scrollIntoView = sinon.spy(form, &apos;scrollIntoView&apos;);

    form.setForm(formJson).then(() =&gt; {
      Harness.clickElement(form, form.element.querySelector(&apos;[name=&quot;data[submit]&quot;]&apos;));

      setTimeout(() =&gt; {
        assert.equal(form.errors[0].messages.length, 1);
        assert(scrollIntoView.calledOnceWith(form.root.alert));

        //changes do not trigger scrolling
        const inputEvent = new Event(&apos;input&apos;);
        const input1 = form.components[0].refs.input[0];

        //invalid input value
        input1.value =  55;
        input1.dispatchEvent(inputEvent);

        setTimeout(() =&gt; {
          assert.equal(form.errors[0].messages.length, 1);
          assert.equal(scrollIntoView.callCount, 1);

          //valid input value
          input1.value =  5;
          input1.dispatchEvent(inputEvent);

          setTimeout(() =&gt; {
            assert.equal(form.errors.length, 0);
            assert.equal(scrollIntoView.callCount, 1);
            done();
          }, 250);
        }, 250);
      }, 250);
    })
    .catch((err) =&gt; done(err));
  });

  let formWithCalculatedValue;

  it(&apos;Should calculate the field value after validation errors appeared on submit&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    formWithCalculatedValue = new Webform(formElement);
    formWithCalculatedValue.setForm(manualOverride).then(() =&gt; {
      Harness.clickElement(formWithCalculatedValue, formWithCalculatedValue.components[2].refs.button);
      setTimeout(() =&gt; {
        const inputEvent = new Event(&apos;input&apos;);
        const input1 = formWithCalculatedValue.components[0].refs.input[0];

          input1.value =  55;
          input1.dispatchEvent(inputEvent);

        setTimeout(() =&gt; {
          const input2 = formElement.querySelector(&apos;input[name=&quot;data[number2]&quot;]&apos;);
          assert.equal(input2.value, &apos;55&apos;);
          assert.equal(input1.value, 55);
          done();
        }, 250);
      }, 250);
    })
    .catch((err) =&gt; done(err));
  });

  it(&apos;Should calculate the value when editing set values with possibility of manual override&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    formWithCalculatedValue = new Webform(formElement);
    formWithCalculatedValue.setForm(manualOverride).then(() =&gt; {
      formWithCalculatedValue.setSubmission({
        data:{
          number1: 66,
          number2:66
        }
      }).then(()=&gt;{
        setTimeout(()=&gt;{
          const input1 = formElement.querySelector(&apos;input[name=&quot;data[number1]&quot;]&apos;);
          const input2 = formElement.querySelector(&apos;input[name=&quot;data[number2]&quot;]&apos;);

          assert.equal(input2.value, &apos;66&apos;);
          assert.equal(input1.value, 66);

          const inputEvent = new Event(&apos;input&apos;);

          input1.value =  `${input1.value}` + &apos;78&apos;;
          input1.dispatchEvent(inputEvent);

          setTimeout(() =&gt; {
            assert.equal(input2.value, &apos;66&apos;);
            assert.equal(input1.value, 6678);
            //set a number as calculated value
            formWithCalculatedValue.components[1].calculatedValue = 6678;
            //change the value
            input1.value =  +(`${input1.value}` + &apos;90&apos;);
            input1.dispatchEvent(inputEvent);

            setTimeout(() =&gt; {
              assert.equal(input2.value, &apos;66&apos;);
              assert.equal(input1.value, 667890);
              done();
            }, 250);
          }, 250);
        }, 900);
      });
    });
  });

  let simpleForm = null;
  it(&apos;Should create a simple form&apos;, (done) =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    simpleForm = new Webform(formElement);
    simpleForm.setForm({
      title: &apos;Simple Form&apos;,
      components: [
        {
          type: &apos;textfield&apos;,
          key: &apos;firstName&apos;,
          input: true
        },
        {
          type: &apos;textfield&apos;,
          key: &apos;lastName&apos;,
          input: true
        }
      ]
    }).then(() =&gt; {
      Harness.testElements(simpleForm, &apos;input[type=&quot;text&quot;]&apos;, 2);
      Harness.testElements(simpleForm, &apos;input[name=&quot;data[firstName]&quot;]&apos;, 1);
      Harness.testElements(simpleForm, &apos;input[name=&quot;data[lastName]&quot;]&apos;, 1);
      done();
    }).catch(done);
  });

  it(&apos;Should set a submission to the form.&apos;, () =&gt; {
    Harness.testSubmission(simpleForm, { data: {
      firstName: &apos;Joe&apos;,
      lastName: &apos;Smith&apos;
    } });
  });

  it(&apos;Should translate a form from options&apos;, done =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    const translateForm = new Webform(formElement, {
      template: &apos;bootstrap3&apos;,
      language: &apos;es&apos;,
      i18n: {
        es: {
          &apos;Default Label&apos;: &apos;Spanish Label&apos;
        }
      }
    });
    translateForm.setForm({
      title: &apos;Translate Form&apos;,
      components: [
        {
          type: &apos;textfield&apos;,
          label: &apos;Default Label&apos;,
          key: &apos;myfield&apos;,
          input: true,
          inputType: &apos;text&apos;,
          validate: {}
        }
      ]
    }).then(() =&gt; {
      const label = formElement.querySelector(&apos;.control-label&apos;);
      assert.equal(label.innerHTML.trim(), &apos;Spanish Label&apos;);
      done();
    }).catch(done);
  });

  it(&apos;Should treat double colons as i18next namespace separators&apos;, (done) =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement);
    form.setForm({
      title: &apos;Test Form&apos;,
      components: []
    }).then(() =&gt; {
      const str = &apos;Test: this is only a test&apos;;

      assert.equal(form.t(str), str);
      assert.equal(form.t(`Namespace::${str}`), str);

      done();
    }).catch(done);
  });

  it(&apos;Should get the language passed via options&apos;, () =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement, {
      language: &apos;es&apos;
    });

    assert.equal(form.language, &apos;es&apos;);
  });

  it(&apos;Should translate form errors in alerts&apos;, () =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement, {
      language: &apos;es&apos;,
      i18n: {
        es: {
          alertMessage: &apos;{{message}}&apos;,
          required: &apos;{{field}} es obligatorio&apos;
        }
      }
    });

    return form.setForm({
      components: [
        {
          type: &apos;textfield&apos;,
          label: &apos;Field Label&apos;,
          key: &apos;myfield&apos;,
          input: true,
          inputType: &apos;text&apos;,
          validate: {
            required: true
          }
        }
      ]
    })
      .then(() =&gt; form.submit())
      .catch(() =&gt; {
        // console.warn(&apos;nooo:&apos;, error)
      })
      .then(() =&gt; {
        const ref = formElement.querySelector(&apos;[ref=&quot;errorRef&quot;]&apos;);
        assert.equal(ref.textContent.trim(), &apos;Field Label es obligatorio&apos;);
      });
  });

  it(&apos;Should translate a form after instantiate&apos;, done =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    const translateForm = new Webform(formElement, {
      template: &apos;bootstrap3&apos;,
      i18n: {
        es: {
          &apos;Default Label&apos;: &apos;Spanish Label&apos;
        }
      }
    });
    translateForm.setForm({
      title: &apos;Translate Form&apos;,
      components: [
        {
          type: &apos;textfield&apos;,
          label: &apos;Default Label&apos;,
          key: &apos;myfield&apos;,
          input: true,
          inputType: &apos;text&apos;,
          validate: {}
        }
      ]
    }).then(() =&gt; {
      translateForm.language = &apos;es&apos;;
      const label = formElement.querySelector(&apos;.control-label&apos;);
      assert.equal(label.innerHTML.trim(), &apos;Spanish Label&apos;);
      done();
    }).catch(done);
  });

  it(&apos;Should add a translation after instantiate&apos;, done =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    const translateForm = new Webform(formElement, {
      template: &apos;bootstrap3&apos;,
      i18n: {
        language: &apos;es&apos;,
        es: {
          &apos;Default Label&apos;: &apos;Spanish Label&apos;
        },
        fr: {
          &apos;Default Label&apos;: &apos;French Label&apos;
        }
      }
    });
    translateForm.setForm({
      title: &apos;Translate Form&apos;,
      components: [
        {
          type: &apos;textfield&apos;,
          label: &apos;Default Label&apos;,
          key: &apos;myfield&apos;,
          input: true,
          inputType: &apos;text&apos;,
          validate: {}
        }
      ]
    }).then(() =&gt; {
      translateForm.language = &apos;fr&apos;;
      const label = formElement.querySelector(&apos;.control-label&apos;);
      assert.equal(label.innerHTML.trim(), &apos;French Label&apos;);
      done();
    }).catch(done);
  });

  it(&apos;Should switch a translation after instantiate&apos;, done =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    const translateForm = new Webform(formElement, {
      template: &apos;bootstrap3&apos;,
    });
    translateForm.setForm({
      title: &apos;Translate Form&apos;,
      components: [
        {
          type: &apos;textfield&apos;,
          label: &apos;Default Label&apos;,
          key: &apos;myfield&apos;,
          input: true,
          inputType: &apos;text&apos;,
          validate: {}
        }
      ]
    }).then(() =&gt; {
      translateForm.addLanguage(&apos;es&apos;, { &apos;Default Label&apos;: &apos;Spanish Label&apos; }, true);
      const label = formElement.querySelector(&apos;.control-label&apos;);
      assert.equal(label.innerHTML.trim(), &apos;Spanish Label&apos;);
      done();
    }).catch(done);
  });

  it(&apos;Should keep translation after redraw&apos;, done =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement, {
      template: &apos;bootstrap3&apos;,
    });
    const schema = {
      title: &apos;Translate Form&apos;,
      components: [
        {
          type: &apos;textfield&apos;,
          label: &apos;Default Label&apos;,
          key: &apos;myfield&apos;,
          input: true,
          inputType: &apos;text&apos;,
          validate: {}
        }
      ]
    };

    try {
      form.setForm(schema)
        .then(() =&gt; {
          form.addLanguage(&apos;ru&apos;, { &apos;Default Label&apos;: &apos;Russian Label&apos; }, true);
          return form.language = &apos;ru&apos;;
        }, done)
        .then(() =&gt; {
          expect(form.options.language).to.equal(&apos;ru&apos;);
          expect(formElement.querySelector(&apos;.control-label&apos;).innerHTML.trim()).to.equal(&apos;Russian Label&apos;);
          form.redraw();
          expect(form.options.language).to.equal(&apos;ru&apos;);
          expect(formElement.querySelector(&apos;.control-label&apos;).innerHTML.trim()).to.equal(&apos;Russian Label&apos;);
          done();
        }, done)
        .catch(done);
    }
    catch (error) {
      done(error);
    }
  });

  it(&apos;Should fire languageChanged event when language is set&apos;, done =&gt; {
    let isLanguageChangedEventFired = false;
    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement, {
      template: &apos;bootstrap3&apos;,
    });
    const schema = {
      title: &apos;Translate Form&apos;,
      components: [
        {
          type: &apos;textfield&apos;,
          label: &apos;Default Label&apos;,
          key: &apos;myfield&apos;,
          input: true,
          inputType: &apos;text&apos;,
          validate: {}
        }
      ]
    };

    try {
      form.setForm(schema)
        .then(() =&gt; {
          form.addLanguage(&apos;ru&apos;, { &apos;Default Label&apos;: &apos;Russian Label&apos; }, false);
          form.on(&apos;languageChanged&apos;, () =&gt; {
            isLanguageChangedEventFired = true;
          });
          return form.language = &apos;ru&apos;;
        }, done)
        .then(() =&gt; {
          assert(isLanguageChangedEventFired);
          done();
        }, done)
        .catch(done);
    }
    catch (error) {
      done(error);
    }
  });

  it(&apos;When submitted should strip fields with persistent: client-only from submission&apos;, done =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    simpleForm = new Webform(formElement);
    /* eslint-disable quotes */
    simpleForm.setForm({
      title: &apos;Simple Form&apos;,
      components: [
        {
          &quot;label&quot;: &quot;Name&quot;,
          &quot;allowMultipleMasks&quot;: false,
          &quot;showWordCount&quot;: false,
          &quot;showCharCount&quot;: false,
          &quot;tableView&quot;: true,
          &quot;type&quot;: &quot;textfield&quot;,
          &quot;input&quot;: true,
          &quot;key&quot;: &quot;name&quot;,
          &quot;widget&quot;: {
            &quot;type&quot;: &quot;&quot;
          }
        },
        {
          &quot;label&quot;: &quot;Age&quot;,
          &quot;persistent&quot;: &quot;client-only&quot;,
          &quot;mask&quot;: false,
          &quot;tableView&quot;: true,
          &quot;type&quot;: &quot;number&quot;,
          &quot;input&quot;: true,
          &quot;key&quot;: &quot;age&quot;
        }
      ]
    });
    /* eslint-enable quotes */

    Harness.testSubmission(simpleForm, {
      data: { name: &apos;noname&apos;, age: &apos;1&apos; }
    });

    simpleForm.submit().then((submission) =&gt; {
      assert.deepEqual(submission.data, { name: &apos;noname&apos; });
      done();
    });
  });

  it(&apos;Should not mutate the global i18next if it gets an instance&apos;, async function() {
    await i18next.init({ lng: &apos;en&apos; });
    const instance = i18next.createInstance();

    const formElement = document.createElement(&apos;div&apos;);
    const translateForm = new Webform(formElement, {
      template: &apos;bootstrap3&apos;,
      language: &apos;es&apos;,
      i18next: instance,
      i18n: {
        es: {
          &apos;Default Label&apos;: &apos;Spanish Label&apos;
        }
      }
    });

    return translateForm.setForm({
      title: &apos;Translate Form&apos;,
      components: [
        {
          type: &apos;textfield&apos;,
          label: &apos;Default Label&apos;,
          key: &apos;myfield&apos;,
          input: true,
          inputType: &apos;text&apos;,
          validate: {}
        }
      ]
    }).then(() =&gt; {
      assert.equal(i18next.language, &apos;en&apos;);
      assert.equal(translateForm.i18next.language, &apos;es&apos;);
      assert.equal(translateForm.i18next, instance);

      const label = formElement.querySelector(&apos;.control-label&apos;);
      assert.equal(label.innerHTML.trim(), &apos;Spanish Label&apos;);
    });
  });

  it(&apos;Should keep components valid if they are pristine&apos;, (done) =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement, { language: &apos;en&apos;, template: &apos;bootstrap3&apos; });
    form.setForm(settingErrors).then(() =&gt; {
      const inputEvent = new Event(&apos;input&apos;, { bubbles: true, cancelable: true });
      const input = form.element.querySelector(&apos;input[name=&quot;data[textField]&quot;]&apos;);
      for (let i = 0; i &lt; 50; i++) {
        input.value += i;
        input.dispatchEvent(inputEvent);
      }

      setTimeout(() =&gt; {
        assert.equal(form.errors.length, 0);
        Harness.setInputValue(form, &apos;data[textField]&apos;, &apos;&apos;);
        setTimeout(() =&gt; {
          assert.equal(form.errors.length, 1);
          done();
        }, 250);
      }, 250);
    }).catch(done);
  });

  it(&apos;Should delete value of hidden component if clearOnHide is turned on&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement, { language: &apos;en&apos;, template: &apos;bootstrap3&apos; });
    form.setForm(clearOnHide).then(() =&gt; {
      const visibleData = {
        data: {
          visible: &apos;yes&apos;,
          clearOnHideField: &apos;some text&apos;,
          submit: false
        },
        metadata: {}
      };

      const hiddenData = {
        data: {
          visible: &apos;no&apos;,
          submit: false
        }
      };
      const inputEvent = new Event(&apos;input&apos;, { bubbles: true, cancelable: true });
      const textField = form.element.querySelector(&apos;input[name=&quot;data[clearOnHideField]&quot;]&apos;);
      textField.value = &apos;some text&apos;;
      textField.dispatchEvent(inputEvent);
      this.timeout(1000);
      setTimeout(() =&gt; {
        assert.deepEqual(form.data, visibleData.data);
        Harness.setInputValue(form, &apos;data[visible]&apos;, &apos;no&apos;);

        setTimeout(() =&gt; {
          assert.deepEqual(form.data, hiddenData.data);
          done();
        }, 250);
      }, 250);
    });
  });

  const formElement = document.createElement(&apos;div&apos;);
  const checkForErrors = function(form, flags = {}, submission, numErrors, done) {
    form.setSubmission(submission, flags).then(() =&gt; {
      setTimeout(() =&gt; {
        const errors = formElement.querySelectorAll(&apos;.formio-error-wrapper&apos;);
        expect(errors.length).to.equal(numErrors);
        expect(form.errors.length).to.equal(numErrors);
        done();
      }, 100);
    }).catch(done);
  };

  it(&apos;Should not fire validations when fields are either protected or not persistent.&apos;, (done) =&gt; {
    const form = new Webform(formElement,{ language: &apos;en&apos;, template: &apos;bootstrap3&apos; });
    form.setForm(
      {
        title: &apos;protected and persistent&apos;,
        components: [
          {
            type: &apos;textfield&apos;,
            label: &apos;A&apos;,
            key: &apos;a&apos;,
            validate: {
              required: true
            }
          },
          {
            type: &apos;textfield&apos;,
            label: &apos;B&apos;,
            key: &apos;b&apos;,
            protected: true,
            validate: {
              required: true
            }
          }
        ],
      }).then(() =&gt; {
        checkForErrors(form, {}, {}, 0, () =&gt; {
          checkForErrors(form, {}, {
            data: {
              a: &apos;Testing&apos;,
              b: &apos;&apos;
            }
          }, 1, () =&gt; {
            checkForErrors(form, {}, {
              _id: &apos;123123123&apos;,
              data: {
                a: &apos;Testing&apos;,
                b: &apos;&apos;
              }
            }, 0, done);
          });
        });
    });
  });

  it(&apos;Should not fire validation on init.&apos;, (done) =&gt; {
    formElement.innerHTML = &apos;&apos;;
    const form = new Webform(formElement,{ language: &apos;en&apos;, template: &apos;bootstrap3&apos; });
    form.setForm(
      { title: &apos;noValidation flag&apos;,
        components: [{
          label: &apos;Number&apos;,
          validate: {
            required: true,
            min: 5
          },
          key: &apos;number&apos;,
          type: &apos;number&apos;,
          input: true
        }, {
          label: &apos;Text Area&apos;,
          validate: {
            required: true,
            minLength: 10
          },
          key: &apos;textArea&apos;,
          type: &apos;textarea&apos;,
          input: true
        }],
      }).then(() =&gt; {
        checkForErrors(form, {}, {}, 0, done);
    });
  });

  it(&apos;Should validation on init when alwaysDirty flag is set.&apos;, (done) =&gt; {
    formElement.innerHTML = &apos;&apos;;
    const form = new Webform(formElement, {
      language: &apos;en&apos;,
      template: &apos;bootstrap3&apos;,
      alwaysDirty: true
    });
    form.setForm(
      { title: &apos;noValidation flag&apos;,
        components: [{
          label: &apos;Number&apos;,
          validate: {
            required: true,
            min: 5
          },
          key: &apos;number&apos;,
          type: &apos;number&apos;,
          input: true
        }, {
          label: &apos;Text Area&apos;,
          validate: {
            required: true,
            minLength: 10
          },
          key: &apos;textArea&apos;,
          type: &apos;textarea&apos;,
          input: true
        }],
      }).then(() =&gt; {
      checkForErrors(form, {}, {}, 2, done);
    });
  });

  it(&apos;Should validation on init when dirty flag is set.&apos;, (done) =&gt; {
    formElement.innerHTML = &apos;&apos;;
    const form = new Webform(formElement, {
      language: &apos;en&apos;,
      template: &apos;bootstrap3&apos;
    });
    form.setForm(
      { title: &apos;noValidation flag&apos;,
        components: [{
          label: &apos;Number&apos;,
          validate: {
            required: true,
            min: 5
          },
          key: &apos;number&apos;,
          type: &apos;number&apos;,
          input: true
        }, {
          label: &apos;Text Area&apos;,
          validate: {
            required: true,
            minLength: 10
          },
          key: &apos;textArea&apos;,
          type: &apos;textarea&apos;,
          input: true
        }],
      }).then(() =&gt; {
      checkForErrors(form, {
        dirty: true
      }, {}, 2, done);
    });
  });

  it(&apos;Should not show any errors on setSubmission when providing an empty data object&apos;, (done) =&gt; {
    formElement.innerHTML = &apos;&apos;;
    const form = new Webform(formElement,{ language: &apos;en&apos;, template: &apos;bootstrap3&apos; });
    form.setForm(
      { title: &apos;noValidation flag&apos;,
        components: [{
          label: &apos;Number&apos;,
          validate: {
            required: true,
            min: 5
          },
          key: &apos;number&apos;,
          type: &apos;number&apos;,
          input: true
        }, {
          label: &apos;Text Area&apos;,
          validate: {
            required: true,
            minLength: 10
          },
          key: &apos;textArea&apos;,
          type: &apos;textarea&apos;,
          input: true
        }],
      }
    ).then(() =&gt; {
      checkForErrors(form, {}, {}, 0, done);
    });
  });

  it(&apos;Should not show errors when providing empty data object with data set.&apos;, (done) =&gt; {
    formElement.innerHTML = &apos;&apos;;
    const form = new Webform(formElement,{ language: &apos;en&apos;, template: &apos;bootstrap3&apos; });
    form.setForm(
      { title: &apos;noValidation flag&apos;,
        components: [{
          label: &apos;Number&apos;,
          validate: {
            required: true,
            min: 5
          },
          key: &apos;number&apos;,
          type: &apos;number&apos;,
          input: true
        }, {
          label: &apos;Text Area&apos;,
          validate: {
            required: true,
            minLength: 10
          },
          key: &apos;textArea&apos;,
          type: &apos;textarea&apos;,
          input: true
        }],
      }
    ).then(() =&gt; {
      checkForErrors(form, {}, { data: {} }, 0, done);
    });
  });

  it(&apos;Should show errors on setSubmission when providing explicit data values.&apos;, (done) =&gt; {
    formElement.innerHTML = &apos;&apos;;
    const form = new Webform(formElement,{ language: &apos;en&apos;, template: &apos;bootstrap3&apos; });
    form.setForm(
      { title: &apos;noValidation flag&apos;,
        components: [{
          label: &apos;Number&apos;,
          validate: {
            required: true,
            min: 5
          },
          key: &apos;number&apos;,
          type: &apos;number&apos;,
          input: true
        }, {
          label: &apos;Text Area&apos;,
          validate: {
            required: true,
            minLength: 10
          },
          key: &apos;textArea&apos;,
          type: &apos;textarea&apos;,
          input: true
        }],
      }
    ).then(() =&gt; {
      checkForErrors(form, {}, {
        data:{
          number: 2,
          textArea: &apos;&apos;
        }
      }, 2, done);
    });
  });

  it(&apos;Should not show errors on setSubmission with noValidate:TRUE&apos;, (done) =&gt; {
    formElement.innerHTML = &apos;&apos;;
    const form = new Webform(formElement,{ language: &apos;en&apos;, template: &apos;bootstrap3&apos; });
    form.setForm(
      { title: &apos;noValidation flag&apos;,
        components: [{
          label: &apos;Number&apos;,
          validate: {
            required: true,
            min: 5
          },
          key: &apos;number&apos;,
          type: &apos;number&apos;,
          input: true
        }, {
          label: &apos;Text Area&apos;,
          validate: {
            required: true,
            minLength: 10
          },
          key: &apos;textArea&apos;,
          type: &apos;textarea&apos;,
          input: true
        }],
      }
    ).then(() =&gt; {
      checkForErrors(form, {
        noValidate:true
      }, {
        data:{
          number: 2,
          textArea: &apos;&apos;
        }
      }, 0, done);
    });
  });

  it(&apos;Should set calculated value correctly&apos;, (done) =&gt; {
    formElement.innerHTML = &apos;&apos;;
    const form = new Webform(formElement);
    form.setForm(calculateZeroValue).then(() =&gt; {
      const a = form.components[0];
      const b = form.components[1];
      const sum = form.components[2];

      a.setValue(10);
      b.setValue(5);
      setTimeout(() =&gt; {
        assert.equal(a.dataValue, 10);
        assert.equal(b.dataValue, 5);
        assert.equal(sum.dataValue, 15);

        a.setValue(&apos;0&apos;);
        b.setValue(&apos;0&apos;);
        setTimeout(() =&gt; {
          assert.equal(a.dataValue, 0);
          assert.equal(b.dataValue,0);
          assert.equal(sum.dataValue, 0);

          done();
        }, 250);
      }, 250);
    }).catch(done);
  });

  it(&apos;Should render Nested Modal Wizard Form correctly&apos;, (done) =&gt; {
    formElement.innerHTML = &apos;&apos;;
    const form = new Webform(formElement);
    form.setForm(nestedModalWizard).then(() =&gt; {
      const openModalRef = form.element.querySelector(&apos;[ref=&quot;openModal&quot;]&apos;);
      assert(openModalRef, &apos;Should render Open Modal button&apos;);
      const wizard = form.components[1].subForm;
      wizard.setPage(1);
      setTimeout(() =&gt; {
        const openModalRef = form.element.querySelector(&apos;[ref=&quot;openModal&quot;]&apos;);
        assert(openModalRef, &apos;Should render Open Modal button after the page was changed&apos;);
        done();
      }, 250);
    }).catch(done);
  });

  it(&apos;Should set calculated value correctly&apos;, (done) =&gt; {
    formElement.innerHTML = &apos;&apos;;
    const form = new Webform(formElement);
    form.setForm(disableSubmitButton).then(() =&gt; {
      const textField = form.getComponent([&apos;textField&apos;]);
      const fileA = form.getComponent([&apos;upload&apos;]);
      const fileB = form.getComponent([&apos;file&apos;]);
      const submitButton = form.getComponent([&apos;submit&apos;]);
      assert.equal(submitButton.disabled, false, &apos;Button should be enabled at the beginning&apos;);

      const simulateFileUploading = (comp, debounce = 250) =&gt; {
        const filePromise = new NativePromise((resolve) =&gt; {
          setTimeout(() =&gt; resolve(), debounce);
        });
        filePromise.then(() =&gt; comp.emit(&apos;fileUploadingEnd&apos;, filePromise));
        comp.emit(&apos;fileUploadingStart&apos;, filePromise);
      };

      simulateFileUploading(fileA, 1000);
      textField.setValue(&apos;12345&apos;);
      setTimeout(() =&gt; {
        assert.equal(submitButton.filesUploading.length, 1);
        assert.equal(submitButton.isDisabledOnInvalid, true, &apos;Should be disabled on invalid due to the invalid TextField\&apos;s value&apos;);
        assert.equal(submitButton.disabled, true, &apos;Should be disabled&apos;);
        simulateFileUploading(fileB, 500);
        setTimeout(() =&gt; {
          assert.equal(submitButton.filesUploading.length, 2);
          assert.equal(submitButton.disabled, true, &apos;Should be disabled&apos;);
          setTimeout(() =&gt; {
            assert.equal(submitButton.filesUploading.length, 0);
            assert.equal(submitButton.disabled, true, &apos;Should be disabled since TextField is still invalid&apos;);
            textField.setValue(&apos;123&apos;);
            setTimeout(() =&gt; {
              assert.equal(submitButton.disabled, false, &apos;Should be enabled&apos;);
              done();
            }, 250);
          }, 650);
        }, 100);
      }, 250);
    }).catch(done);
  });

  describe(&apos;set/get nosubmit&apos;, () =&gt; {
    it(&apos;should set/get nosubmit flag and emit nosubmit event&apos;, () =&gt; {
      const form = new Webform(null, {});
      const emit = sinon.spy(form, &apos;emit&apos;);
      expect(form.nosubmit).to.be.false;
      form.nosubmit = true;
      expect(form.nosubmit).to.be.true;
      expect(emit.callCount).to.equal(1);
      expect(emit.args[0]).to.deep.equal([&apos;nosubmit&apos;, true]);
      form.nosubmit = false;
      expect(form.nosubmit).to.be.false;
      expect(emit.callCount).to.equal(2);
      expect(emit.args[1]).to.deep.equal([&apos;nosubmit&apos;, false]);
    });
  });

  describe(&apos;getValue and setValue&apos;, () =&gt; {
    it(&apos;should setValue and getValue&apos;, (done) =&gt; {
      formElement.innerHTML = &apos;&apos;;
      const form = new Webform(formElement, { language: &apos;en&apos;, template: &apos;bootstrap3&apos; });
      form.setForm({
        components: [
          {
            type: &apos;textfield&apos;,
            key: &apos;a&apos;
          },
          {
            type: &apos;container&apos;,
            key: &apos;b&apos;,
            components: [
              {
                type: &apos;datagrid&apos;,
                key: &apos;c&apos;,
                components: [
                  {
                    type: &apos;textfield&apos;,
                    key: &apos;d&apos;
                  },
                  {
                    type: &apos;textfield&apos;,
                    key: &apos;e&apos;
                  },
                  {
                    type: &apos;editgrid&apos;,
                    key: &apos;f&apos;,
                    components: [
                      {
                        type: &apos;textfield&apos;,
                        key: &apos;g&apos;
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }).then(() =&gt; {
        let count = 0;
        const onChange = form.onChange;
        form.onChange = function(...args) {
          count++;
          return onChange.apply(form, args);
        };

        // Ensure that it says it changes.
        assert.equal(form.setValue({
          a: &apos;a&apos;,
          b: {
            c: [
              { d: &apos;d1&apos;, e: &apos;e1&apos;, f: [{ g: &apos;g1&apos; }] },
              { d: &apos;d2&apos;, e: &apos;e2&apos;, f: [{ g: &apos;g2&apos; }] },
            ]
          }
        }), true);

        setTimeout(() =&gt; {
          // It should have only updated once.
          assert.equal(count, 1);
          done();
        }, 500);
      });
    });
  });

  describe(&apos;ReadOnly Form&apos;, () =&gt; {
    it(&apos;Should apply conditionals when in readOnly mode.&apos;, (done) =&gt; {
      done = _.once(done);
      const Conditions = require(&apos;../test/forms/conditions&apos;).default;
      const formElement = document.createElement(&apos;div&apos;);
      const form = new Webform(formElement, {
        readOnly: true,
        language: &apos;en&apos;,
        template: &apos;bootstrap3&apos;
      });
      form.setForm(Conditions.form).then(() =&gt; {
        Harness.testConditionals(form, {
          data: {
            typeShow: &apos;Show&apos;,
            typeMe: &apos;Me&apos;,
            typeThe: &apos;The&apos;,
            typeMonkey: &apos;Monkey!&apos;
          }
        }, [], (error) =&gt; {
          form.destroy();
          if (error) {
            throw new Error(error);
          }
          done();
        });
      });
    });
  });

  describe(&apos;Validate onBlur&apos;, () =&gt; {
    it(&apos;Should keep component valid onChange&apos;, (done) =&gt; {
      formElement.innerHTML = &apos;&apos;;
      const form = new Webform(formElement, { language: &apos;en&apos;, template: &apos;bootstrap3&apos; });
      form.setForm(validationOnBlur).then(() =&gt; {
        const field = form.components[0];
        const field2 = form.components[1];
        const fieldInput = field.refs.input[0];

        Harness.setInputValue(field, &apos;data[textField]&apos;, &apos;12&apos;);

        setTimeout(() =&gt; {
          assert(!field.error, &apos;Should be valid while changing&apos;);
          const blurEvent = new Event(&apos;blur&apos;);
          fieldInput.dispatchEvent(blurEvent);

          setTimeout(() =&gt; {
            assert(field.error, &apos;Should set error aftre component was blured&apos;);
            Harness.setInputValue(field2, &apos;data[textField1]&apos;, &apos;ab&apos;);

            setTimeout(() =&gt; {
              assert(field.error, &apos;Should keep error when editing another component&apos;);
              done();
            }, 250);
          }, 250);
        }, 250);
      }).catch(done);
    });

    it(&apos;Should keep components inside DataGrid valid onChange&apos;, (done) =&gt; {
      formElement.innerHTML = &apos;&apos;;
      const form = new Webform(formElement, { language: &apos;en&apos;, template: &apos;bootstrap3&apos; });
      form.setForm(DataGridOnBlurValidation).then(() =&gt; {
        const component = form.components[0];
        Harness.setInputValue(component, &apos;data[dataGrid][0][textField]&apos;, &apos;12&apos;);
        const textField = component.iteratableRows[0].components.textField;
        setTimeout(() =&gt; {
          assert.equal(textField.error, &apos;&apos;, &apos;Should stay valid on input&apos;);
          const blur = new Event(&apos;blur&apos;, { bubbles: true, cancelable: true });
          const input = textField.refs.input[0];
          input.dispatchEvent(blur);
          textField.element.dispatchEvent(blur);
            setTimeout(() =&gt; {
              assert(textField.error, &apos;Should be validated after blur&apos;);
              done();
            }, 250);
        }, 250);
      }).catch(done);
    });
  });

  describe(&apos;Reset values&apos;, () =&gt; {
    it(&apos;Should reset all values correctly.&apos;, () =&gt; {
      formElement.innerHTML = &apos;&apos;;
      const form = new Webform(formElement, { language: &apos;en&apos;, template: &apos;bootstrap3&apos; });
      return form.setForm(
        {
          components: [
            {
              type: &apos;textfield&apos;,
              key: &apos;firstName&apos;,
              label: &apos;First Name&apos;,
              placeholder: &apos;Enter your first name.&apos;,
              input: true,
              tooltip: &apos;Enter your &lt;strong&gt;First Name&lt;/strong&gt;&apos;,
              description: &apos;Enter your &lt;strong&gt;First Name&lt;/strong&gt;&apos;
            },
            {
              type: &apos;textfield&apos;,
              key: &apos;lastName&apos;,
              label: &apos;Last Name&apos;,
              placeholder: &apos;Enter your last name&apos;,
              input: true,
              tooltip: &apos;Enter your &lt;strong&gt;Last Name&lt;/strong&gt;&apos;,
              description: &apos;Enter your &lt;strong&gt;Last Name&lt;/strong&gt;&apos;
            },
            {
              type: &apos;select&apos;,
              label: &apos;Favorite Things&apos;,
              key: &apos;favoriteThings&apos;,
              placeholder: &apos;These are a few of your favorite things...&apos;,
              data: {
                values: [
                  {
                    value: &apos;raindropsOnRoses&apos;,
                    label: &apos;Raindrops on roses&apos;
                  },
                  {
                    value: &apos;whiskersOnKittens&apos;,
                    label: &apos;Whiskers on Kittens&apos;
                  },
                  {
                    value: &apos;brightCopperKettles&apos;,
                    label: &apos;Bright Copper Kettles&apos;
                  },
                  {
                    value: &apos;warmWoolenMittens&apos;,
                    label: &apos;Warm Woolen Mittens&apos;
                  }
                ]
              },
              dataSrc: &apos;values&apos;,
              template: &apos;&lt;span&gt;{{ item.label }}&lt;/span&gt;&apos;,
              multiple: true,
              input: true
            },
            {
              type: &apos;number&apos;,
              key: &apos;number&apos;,
              label: &apos;Number&apos;,
              input: true
            },
            {
              type: &apos;button&apos;,
              action: &apos;submit&apos;,
              label: &apos;Submit&apos;,
              theme: &apos;primary&apos;
            }
          ]
        }
      ).then(() =&gt; {
        form.setSubmission({
          data: {
            firstName: &apos;Joe&apos;,
            lastName: &apos;Bob&apos;,
            favoriteThings: [&apos;whiskersOnKittens&apos;, &apos;warmWoolenMittens&apos;],
            number: 233
          }
        }).then(() =&gt; {
          expect(form.submission).to.deep.equal({
            data: {
              firstName: &apos;Joe&apos;,
              lastName: &apos;Bob&apos;,
              favoriteThings: [&apos;whiskersOnKittens&apos;, &apos;warmWoolenMittens&apos;],
              number: 233,
              submit: false
            }
          });
          form.setSubmission({ data: {} }).then(() =&gt; {
            expect(form.submission).to.deep.equal({
              data: {
                firstName: &apos;&apos;,
                lastName: &apos;&apos;,
                favoriteThings: [],
                submit: false
              }
            });
          });
        });
      });
    });
  });

  describe(&apos;Calculate Value with allowed manual override&apos;, () =&gt; {
    const initialSubmission = {
      data: {
        dataGrid: [
          { label: &apos;yes&apos;, value: &apos;yes&apos; },
          { label: &apos;no&apos;, value: &apos;no&apos; },
        ],
        checkbox: false,
        submit: false
      },
      metadata: {}
    };
    const submissionWithOverridenValues = {
      data: {
        dataGrid: [
          { label: &apos;yes&apos;, value: &apos;y&apos; },
          { label: &apos;no&apos;, value: &apos;n&apos; },
        ],
        checkbox: false,
        submit: false
      },
      metadata: {}
    };
    const submissionWithOverridenValues2 = {
      data: {
        dataGrid: [
          { label: &apos;yes2&apos;, value: &apos;y&apos; },
          { label: &apos;no&apos;, value: &apos;n&apos; },
        ],
        checkbox: false,
        submit: false
      },
      metadata: {}
    };
    it(&apos;Should reset all values correctly.&apos;, (done) =&gt; {
      const formElement = document.createElement(&apos;div&apos;);
      const form = new Webform(formElement, { language: &apos;en&apos;, template: &apos;bootstrap3&apos; });
      form.setForm(calculateValueWithManualOverride).then(() =&gt; {
        const dataGrid = form.getComponent(&apos;dataGrid&apos;);
        dataGrid.setValue([{ label: &apos;yes&apos; }, { label: &apos;no&apos; }]);
        setTimeout(() =&gt; {
          expect(form.submission).to.deep.equal(initialSubmission);
          const row1Value = form.getComponent([&apos;dataGrid&apos;, 0, &apos;value&apos;]);
          const row2Value = form.getComponent([&apos;dataGrid&apos;, 1, &apos;value&apos;]);
          row1Value.setValue(&apos;y&apos;);
          row2Value.setValue(&apos;n&apos;);

          setTimeout(() =&gt; {
            expect(form.submission).to.deep.equal(submissionWithOverridenValues);
            const row1Label = form.getComponent([&apos;dataGrid&apos;, 0, &apos;label&apos;]);
            row1Label.setValue(&apos;yes2&apos;);
            setTimeout(() =&gt; {
              expect(form.submission).to.deep.equal(submissionWithOverridenValues2);
              form.setSubmission(submissionWithOverridenValues).then(() =&gt; {
                setTimeout(() =&gt; {
                  const tabs = form.getComponent([&apos;tabs&apos;]);
                  tabs.setTab(1);
                  setTimeout(() =&gt; {
                    expect(form.submission).to.deep.equal(submissionWithOverridenValues);
                    done();
                  }, 250);
                }, 150);
              });
            }, 250);
          }, 250);
        }, 250);
      }).catch(done);
    });

    it(&apos;Should allow to change value.&apos;, (done) =&gt; {
      const formElement = document.createElement(&apos;div&apos;);
      const form = new Webform(formElement, { language: &apos;en&apos;, template: &apos;bootstrap3&apos; });
      form.setForm(calculatedSelectboxes).then(() =&gt; {
        const radio = form.getComponent([&apos;radio&apos;]);
        radio.setValue(&apos;a&apos;);
        setTimeout(() =&gt; {
          assert.equal(radio.dataValue, &apos;a&apos;);
          const selectBoxes = form.getComponent([&apos;selectBoxes&apos;]);
          assert.equal(selectBoxes.dataValue[&apos;a&apos;], true, &apos;Should calculate value and set it to &quot;a&quot;&apos;);
          selectBoxes.setValue({
            &apos;a&apos;: true,
            &apos;b&apos;: true,
            &apos;c&apos;: false
          });
          setTimeout(() =&gt; {
            assert.deepEqual(selectBoxes.dataValue, {
              &apos;a&apos;: true,
              &apos;b&apos;: true,
              &apos;c&apos;: false
            }, &apos;Should change the value&apos;);
            done();
          }, 250);
        }, 250);
      }).catch(done);
    });
  });

  describe(&apos;Modal Edit&apos;, () =&gt; {
    const submission = {
      state: &apos;submitted&apos;,
      data: {
        checkbox: true,
        selectBoxes: {
          a: true,
          b: true
        },
        textfield: &apos;My Text&apos;,
        select: &apos;f&apos;,
        submit: true
      }
    };
    const componentsKeys = [&apos;checkbox&apos;, &apos;selectBoxes&apos;, &apos;select&apos;, &apos;textfield&apos;];
    const expectedValues = {
      checkbox: &apos;Yes&apos;,
      selectBoxes: &apos;a, b&apos;,
      select: &apos;f&apos;,
      textfield: &apos;My Text&apos;
    };
    it(&apos;Test rendering previews after the submission is set&apos;, (done) =&gt; {
      const formElement = document.createElement(&apos;div&apos;);
      const form = new Webform(formElement, { language: &apos;en&apos;, template: &apos;bootstrap3&apos; });
      form.setForm(modalEditComponents).then(() =&gt; {
        return form.setSubmission(submission, { fromSubmission: true }).then(() =&gt; {
          componentsKeys.forEach((key) =&gt; {
            const comp = form.getComponent([key]);
            assert(comp);
            const preview = comp.componentModal.refs.openModal;
            assert(preview);
            assert.equal(preview.textContent.replace(/\n|\t/g, &apos;&apos;).trim(), expectedValues[key]);
          });
          done();
        });
      }).catch(done);
    });

    it(&apos;Test updating previews after aboting changes&apos;, (done) =&gt; {
      const formElement = document.createElement(&apos;div&apos;);
      const form = new Webform(formElement, { language: &apos;en&apos;, template: &apos;bootstrap3&apos; });
      form.setForm(modalEditComponents).then(() =&gt; {
        return form.setSubmission(submission, { fromSubmission: true }).then(() =&gt; {
          const comp = form.getComponent([&apos;textfield&apos;]);
          comp.componentModal.openModal();
          Harness.dispatchEvent(&apos;input&apos;, comp.componentModal.refs.modalContents, &apos;[name=&quot;data[textfield]&quot;]&apos;, (el) =&gt; {
            el.value = &apos;My Text v2&apos;;
          });
          setTimeout(() =&gt; {
            const fakeEvent = {
              preventDefault: () =&gt; {}
            };
            comp.componentModal.closeModalHandler(fakeEvent);
            const preview = comp.componentModal.refs.openModal;
            assert.equal(preview.textContent.replace(/\n|\t/g, &apos;&apos;).trim(), &apos;My Text&apos;);
            done();
          }, 100);
        });
      }).catch(done);
    });
  });

  describe(&apos;Initially Collapsed Panel&apos;, () =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement, { language: &apos;en&apos;, template: &apos;bootstrap3&apos; });
    form.setForm(initiallyCollapsedPanel).then(() =&gt; {
      it(&apos;Should be collapsed&apos;, (done) =&gt; {
        try {
          const panelBody = form.element.querySelector(&apos;[ref=nested-panel]&apos;);
          assert.equal(panelBody, null, &apos;Should not render the panel\&apos;s body when initially collapsed&apos;);
          done();
        }
        catch (err) {
          done(err);
        }
      });
      it(&apos;Should open when an Error occured&apos;, (done) =&gt; {
        form.executeSubmit().catch(() =&gt; {
          try {
            const panelBody = form.element.querySelector(&apos;[ref=nested-panel]&apos;);
            assert(panelBody, &apos;Should open the panel when an error occured&apos;);
            done();
          }
          catch (err) {
            done(err);
          }
        });
      });
    }).catch((err) =&gt; console.error(err));
  });

  describe(&apos;Calculate Value&apos;, () =&gt; {
    it(&apos;Should calculate value when set submission if the component is not persistent&apos;, (done) =&gt; {
      const formElement = document.createElement(&apos;div&apos;);
      const form = new Webform(formElement, { language: &apos;en&apos;, template: &apos;bootstrap3&apos;, pdf: true });
      form.setForm(calculatedNotPersistentValue).then(() =&gt; {
        form.setSubmission({
          data:
            {
              a: &apos;testValue&apos;
            },
          state: &apos;submitted&apos;
        });
        setTimeout(() =&gt; {
          const persistentField = form.getComponent([&apos;a&apos;]);
          assert.equal(persistentField.dataValue, &apos;testValue&apos;, &apos;Should set the value from the submission&apos;);
          const notPersistentFieldInput = form.element.querySelector(&apos;input[name=&quot;data[textField]&quot;]&apos;);
          assert.equal(notPersistentFieldInput.value, &apos;testValue&apos;, &apos;Should calculate the value&apos;);
          done();
        }, 550);
      }).catch(done);
    });
    it(&apos;Should calculate value by datasouce component when editing mode is on&apos;, (done) =&gt; {
      const formElement = document.createElement(&apos;div&apos;);
      const form = new Webform(formElement, { language: &apos;en&apos;, template: &apos;bootstrap3&apos;, pdf: true });
      form.setForm(calculateValueInEditingMode).then(() =&gt; {
        form.editing = true;
        form.setSubmission({
          data:
            {
              select: { label: &apos;Dummy #1&apos;, value: &apos;dummy1&apos; },
              dataSourceDisplay: &apos;some value&apos;
            },
          state: &apos;submitted&apos;
        })
        .then(() =&gt; {
          const dataSource = form.getComponent(&apos;datasource&apos;);
          dataSource.dataValue = { value: &apos;some value&apos; };
          form.checkData(null, { dataSourceInitialLoading: true });
          setTimeout(() =&gt; {
            const dataSourceDisplay = form.getComponent(&apos;dataSourceDisplay&apos;);
            assert.equal(dataSourceDisplay.dataValue, &apos;some value&apos;, &apos;Should set and keep the value&apos;);
            done();
          }, 1000);
       });
      }).catch(done);
    });
    it(&apos;Should calculate value properly in editing mode&apos;, (done) =&gt; {
      const formElement = document.createElement(&apos;div&apos;);
      const form = new Webform(formElement, { language: &apos;en&apos;, template: &apos;bootstrap3&apos;, pdf: true });
      form.setForm(calculatedValue).then(() =&gt; {
        form.editing = true;
        form.setSubmission({
          data:
            {
              a: 4,
              b: 5,
              total: 9,
            },
          state: &apos;submitted&apos;
        });
        setTimeout(() =&gt; {
          const total = form.getComponent([&apos;total&apos;]);
          assert.equal(total.dataValue, 9, &apos;Should set and keep the value&apos;);

          const b = form.getComponent([&apos;b&apos;]);
          Harness.dispatchEvent(&apos;input&apos;, b.element, &apos;input&apos;, (i) =&gt; i.value = &apos;6&apos;);

          setTimeout(() =&gt; {
            assert.equal(total.dataValue, 10, &apos;Should recalculate the value&apos;);
          }, 300);
          done();
        }, 1000);
      }).catch(done);
    });
    it(&apos;Should not override value which was set from submission&apos;, (done) =&gt; {
      const formElement = document.createElement(&apos;div&apos;);
      const form = new Webform(formElement, { language: &apos;en&apos;, template: &apos;bootstrap3&apos;, pdf: true });
      form.setForm(calculateValueWithManualOverrideLableValueDataGrid).then(() =&gt; {
        form.editing = true;
        form.setSubmission({
          state: &apos;submitted&apos;,
          data: {
            dataGrid: [
              { label: &apos;1&apos;, value: &apos;1a&apos; },
              { label: &apos;2&apos;, value: &apos;2a&apos; },
              { label: &apos;3&apos;, value: &apos;3a&apos; },
            ]
          },
        });
        setTimeout(() =&gt; {
          const value1 = form.getComponent([&apos;dataGrid&apos;, 0, &apos;value&apos;]);
          assert.equal(value1.dataValue, &apos;1a&apos;, &apos;Should have a value set from submission&apos;);
          const value2 = form.getComponent([&apos;dataGrid&apos;, 1, &apos;value&apos;]);
          assert.equal(value2.dataValue, &apos;2a&apos;, &apos;Should have a value set from submission&apos;);
          const value3 = form.getComponent([&apos;dataGrid&apos;, 2, &apos;value&apos;]);
          assert.equal(value3.dataValue, &apos;3a&apos;, &apos;Should have a value set from submission&apos;);
          done();
        }, 1000);
      }).catch(done);
    });
  });

  it(&apos;Should set different ids for components inside different Table rows&apos;, (done) =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement, { language: &apos;en&apos;, template: &apos;bootstrap3&apos;, pdf: true });
    form.setForm(conditionalDataGridWithTableAndRadio).then(() =&gt; {
      const radioInspection0 = form.getComponent([&apos;inspectionDataGrid&apos;, 0, &apos;initialExam&apos;]);
      Harness.dispatchEvent(
        &apos;click&apos;,
        radioInspection0.element,
        &apos;input[value=&quot;reject&quot;]&apos;,
        i =&gt; i.checked = true,
      );

      setTimeout(() =&gt; {
        const repairDataGrid0 = form.getComponent([&apos;inspectionDataGrid&apos;, 0, &apos;repairDataGrid&apos;]);
        assert.equal(radioInspection0.dataValue, &apos;reject&apos;, &apos;Should set value&apos;);
        assert.equal(repairDataGrid0.visible, true, &apos;Should become visible&apos;);

        const radioRepair0 = form.getComponent([&apos;inspectionDataGrid&apos;, 0, &apos;repairDataGrid&apos;, 0, &apos;repairExam&apos;]);
        Harness.dispatchEvent(
          &apos;click&apos;,
          radioRepair0.element,
          &apos;input[value=&quot;accept&quot;]&apos;,
            i =&gt; i.checked = true,
        );

        setTimeout(() =&gt; {
          assert.equal(radioRepair0.dataValue, &apos;accept&apos;, &apos;Should set value&apos;);
          const inspectionDataGrid = form.getComponent([&apos;inspectionDataGrid&apos;]);
          inspectionDataGrid.addRow();

          setTimeout(() =&gt; {
            assert.equal(inspectionDataGrid.rows.length, 2, &apos;Should add a row&apos;);

            const radioInspection1 = form.getComponent([&apos;inspectionDataGrid&apos;, 1, &apos;initialExam&apos;]);
            Harness.dispatchEvent(
              &apos;click&apos;,
              radioInspection1.element,
              &apos;input[value=&quot;reject&quot;]&apos;,
              i =&gt; i.checked = true,
            );

            setTimeout(() =&gt; {
              const repairDataGrid1 = form.getComponent([&apos;inspectionDataGrid&apos;, 1, &apos;repairDataGrid&apos;]);
              assert.equal(radioInspection1.dataValue, &apos;reject&apos;, &apos;Should set value&apos;);
              assert.equal(repairDataGrid1.visible, true, &apos;Should become visible&apos;);

              const radioRepair1 = form.getComponent([&apos;inspectionDataGrid&apos;, 1, &apos;repairDataGrid&apos;, 0, &apos;repairExam&apos;]);
              Harness.dispatchEvent(
                &apos;click&apos;,
                form.element,
                form.element.querySelector(`#${radioRepair1.root.id}-${radioRepair1.id}-${radioRepair1.row}-accept`),
                i =&gt; i.checked = true
              );

              setTimeout(() =&gt; {
                assert.equal(radioRepair1.dataValue, &apos;accept&apos;, &apos;Should set value of the clicked radio&apos;);
                assert.equal(radioRepair0.dataValue, &apos;accept&apos;, &apos;Value of the radio inside another row should stay the same&apos;);

                done();
              }, 300);
            }, 350);
          }, 300);
        }, 250);
      }, 350);
    }).catch(done);
  });

  it(&apos;Should render components properly&apos;, (done) =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement, { language: &apos;en&apos;, template: &apos;bootstrap3&apos; });
    form.setForm(multipleTextareaInsideConditionalComponent).then(() =&gt; {
      form.setSubmission({
        data: {
          textArea2: [
            &apos;test&apos;
          ],
          didAnyBehavioralIssuesOccurOnYourShift: &apos;yes&apos;,
          submit: false,
        }
      });
      setTimeout(() =&gt; {
        const textarea = form.getComponent([&apos;textArea2&apos;]);
        const panel = form.getComponent([&apos;behavioralIssues&apos;]);
        assert.equal(panel.visible, true, &apos;Should be visible&apos;);
        assert.deepEqual(textarea.dataValue, [&apos;test&apos;], &apos;Should set the value from the submission&apos;);
        const inputRows = textarea.element.querySelectorAll(&apos;[ref=&quot;input&quot;]&apos;);
        assert.equal(inputRows.length, 1, &apos;Should render all the rows of the Textarea&apos;);
        done();
      }, 750);
    }).catch(done);
  });

  it(&apos;Should disable all the components inside Nested Form if it is disabled&apos;, (done) =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement, { language: &apos;en&apos;, template: &apos;bootstrap3&apos; });
    form.setForm(disabledNestedForm).then(() =&gt; {
      assert.equal(form.components[0].disabled, false, &apos;Component that is outside of disabled Nested Form should be editable&apos;);
      const subFormComponents = form.components[1].subForm.components;
      assert.deepEqual([subFormComponents[0].disabled, subFormComponents[1].disabled], [true, true], &apos;Components that are inside of disabled Nested Form should be disabled&apos;);
      done();
    }).catch(done);
  });

  it(&apos;Should restore value correctly if NestedForm is saved as reference&apos;, (done) =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement, { language: &apos;en&apos;, template: &apos;bootstrap3&apos; });
    form.setForm(nestedFormInsideDataGrid).then(() =&gt; {
      const nestedForm = form.getComponent([&apos;dataGrid&apos;, 0, &apos;form1&apos;]);
      const submissionWithIdOnly = { _id: &apos;1232&apos;, data: {} };
      nestedForm.dataValue = { ...submissionWithIdOnly };
      nestedForm.restoreValue();

      setTimeout(() =&gt; {
        assert.deepEqual(nestedForm.dataValue, submissionWithIdOnly, &apos;Should not set to defaultValue after restore&apos;);
        done();
      }, 350);
    }).catch(done);
  });

  it(&apos;Should not set the default value if there is only Radio with False value&apos;, (done) =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    Formio.createForm(formElement, nestedFormInWizard).then((form) =&gt; {
      const nestedForm = form.getComponent([&apos;form&apos;]);
      const submission = {
        data: {
          radio: false
        }
      };

      nestedForm.dataValue = { ...submission };

      setTimeout(() =&gt; {
        assert.deepEqual(nestedForm.dataValue, submission, &apos;Should set submission&apos;);
        nestedForm.valueChanged = true;
        form.setPage(1);

        setTimeout(() =&gt; {
          assert.deepEqual(nestedForm.dataValue.data, submission.data, &apos;Should not set to defaultValue after restore&apos;);
          done();
        }, 300);
      }, 300);
    }).catch(done);
  });

  it(&apos;Should add and clear input error classes correctly&apos;, (done) =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement, { language: &apos;en&apos;, template: &apos;bootstrap3&apos; });

    form.setForm(UpdateErrorClassesWidgets).then(() =&gt; {
      const checkbox = form.getComponent(&apos;showDate&apos;);
      checkbox.setValue(true);
      setTimeout(() =&gt; {
        const dateTimeComponent = form.getComponent(&apos;condtionalDate&apos;);
        const dateComponentElement = dateTimeComponent.element;
        assert.equal(!dateComponentElement.className.includes(&apos;formio-hidden&apos;), true, &apos;Should not be hidden&apos;);

        form.submit();

        setTimeout(() =&gt; {
          const dateVisibleInput = dateComponentElement.querySelector(&apos;.input&apos;);
          const flatpickerInput = dateComponentElement.querySelector(&apos;.flatpickr-input&apos;);

          assert(dateVisibleInput.className.includes(&apos;is-invalid&apos;), &apos;Visible field should have invalid class&apos;);
          assert(flatpickerInput.className.includes(&apos;is-invalid&apos;), &apos;Flatpickr field should have invalid class as well&apos;);

          dateTimeComponent.setValue(&apos;2020-12-09T00:00:00&apos;);

          setTimeout(() =&gt; {
            assert.equal(dateTimeComponent.dataValue, &apos;2020-12-09T00:00:00&apos;, &apos;Should set value&apos;);
            assert(!dateVisibleInput.className.includes(&apos;is-invalid&apos;), &apos;Invalid class should be removed&apos;);
            assert(!flatpickerInput.className.includes(&apos;is-invalid&apos;), &apos;Invalid class should be removed from flatpickr field as well&apos;);

            checkbox.setValue(false);

            setTimeout(() =&gt; {
              const dateComponentElement = dateTimeComponent.element;
              assert.equal(dateComponentElement.className.includes(&apos;formio-hidden&apos;), true, &apos;Should be hidden&apos;);
              checkbox.setValue(true);

              setTimeout(() =&gt; {
                const dateComponentElement = dateTimeComponent.element;
                assert.equal(!dateComponentElement.className.includes(&apos;formio-hidden&apos;), true, &apos;Should be visible&apos;);
                const dateVisibleInput = dateComponentElement.querySelector(&apos;.input:not([type=&quot;hidden&quot;])&apos;);
                const flatpickerInput = dateComponentElement.querySelector(&apos;.flatpickr-input&apos;);

                assert(dateVisibleInput.className.includes(&apos;is-invalid&apos;), &apos;Visible field should has invalid class&apos;);
                assert(flatpickerInput.className.includes(&apos;is-invalid&apos;), &apos;Flatpickr field should has invalid class as well&apos;);

                dateTimeComponent.setValue(&apos;2020-10-19T00:00:00&apos;);
                setTimeout(() =&gt; {
                  assert.equal(dateTimeComponent.dataValue, &apos;2020-10-19T00:00:00&apos;, &apos;Should set value&apos;);
                  assert(!dateVisibleInput.className.includes(&apos;is-invalid&apos;), &apos;Invalid class should be removed&apos;);
                  assert(!flatpickerInput.className.includes(&apos;is-invalid&apos;), &apos;Invalid class should be removed from flatpickr field as well&apos;);
                  done();
                }, 300);
              }, 400);
            }, 300);
          }, 300);
        }, 300);
      }, 350);
    }).catch(done);
  }).timeout(3000);

  it(&apos;Should have number and currency fields in empty form submission&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const form= new Webform(formElement);
    const formJson = {
      components: [
        {
          label: &apos;Number&apos;,
          key: &apos;number&apos;,
          type: &apos;number&apos;
        },
        {
          label: &apos;Currency&apos;,
          key: &apos;currency&apos;,
          type: &apos;currency&apos;
        },
        {
          type: &apos;button&apos;,
          label: &apos;Submit&apos;,
          key: &apos;submit&apos;
        },
      ],
    };

    const emptySubmissionData = {
      number: &apos;&apos;,
      currency: &apos;&apos;,
      submit: true
    };

    form.setForm(formJson).then(() =&gt; {
      const clickEvent = new Event(&apos;click&apos;);
      const submitBtn = form.element.querySelector(&apos;[name=&quot;data[submit]&quot;]&apos;);

      submitBtn.dispatchEvent(clickEvent);

      setTimeout(() =&gt; {
        assert.deepEqual(form.data, emptySubmissionData);
        done();
      }, 200);
    })
    .catch((err) =&gt; done(err));
  });

  it(&apos;Test Truncate Multiple Spaces&apos;, (done) =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    const form= new Webform(formElement);

    form.setForm(truncateMultipleSpaces).then(() =&gt; {
      const textFieldRequired = form.getComponent([&apos;textField1&apos;]);
      const textFieldMinMaxLength = form.getComponent([&apos;textField&apos;]);
      const textAreaMinMaxLength = form.getComponent([&apos;textArea&apos;]);
      Harness.dispatchEvent(&apos;input&apos;, textFieldRequired.element, &apos;input&apos;, (i) =&gt; i.value = &apos;        &apos;);
      Harness.dispatchEvent(
        &apos;input&apos;,
        textFieldMinMaxLength.element,
        &apos;input&apos;,
        (i) =&gt; i.value = &apos;     546       456     &apos;
      );
      Harness.dispatchEvent(
        &apos;input&apos;,
        textAreaMinMaxLength.element,
        &apos;textarea&apos;,
        (i) =&gt; i.value = &apos;     546       456     &apos;
      );

      setTimeout(() =&gt; {
        assert.equal(textFieldRequired.dataValue, &apos;        &apos;, &apos;Should set value&apos;);
        assert.equal(textFieldMinMaxLength.dataValue, &apos;     546       456     &apos;, &apos;Should set value&apos;);
        assert.equal(textAreaMinMaxLength.dataValue, &apos;     546       456     &apos;, &apos;Should set value&apos;);

        assert.equal(textFieldRequired.errors.length, 1, &apos;Should be invalid since it does not have a value&apos;);
        assert.equal(
          textFieldMinMaxLength.errors.length,
          0,
          &apos;Should be valid since it value does not exceed the max length after truncating spaces&apos;
        );
        assert.equal(
          textAreaMinMaxLength.errors.length,
          0,
          &apos;Should be valid since it value does not exceed the max length after truncating spaces&apos;
        );

        form.submit(false, {}).finally(() =&gt; {
          assert.equal(textFieldRequired.dataValue, &apos;&apos;, &apos;Should truncate the value before submit&apos;);
          assert.equal(textFieldMinMaxLength.dataValue, &apos;546 456&apos;, &apos;Should truncate the value before submit&apos;);
          assert.equal(textAreaMinMaxLength.dataValue, &apos;546 456&apos;, &apos;Should truncate the value before submit&apos;);

          done();
        });
      }, 400);
    }).catch(done);
  });

  it(&apos;HTML render mode for Webform&apos;, (done) =&gt; {
    const element = document.createElement(&apos;div&apos;);

    const originalMakeRequest = Formio.makeRequest;
    Formio.makeRequest = function() {
      return new Promise(resolve =&gt; {
        setTimeout(() =&gt; {
          const values = [
            {
              _id: &apos;5a53f8a044398b0001023eab&apos;,
              modified: &apos;2019-02-01T16:12:06.618Z&apos;,
              data: {
                firstName: &apos;Bob&apos;,
                lastName: &apos;Thompson&apos;,
                status: &apos;inactive&apos;,
                email: &apos;bob@example.com&apos;,
                submit: true,
              },
              form: &apos;5a53f887c8930000010f8b22&apos;,
              _fvid: 0,
              _vid: 0,
              created: &apos;2018-01-08T23:02:56.484Z&apos;,
              externalIds: [],
              access: [],
              roles: [],
              owner: &apos;553dbfc08d22d5cb1a7024f2&apos;,
              state: &apos;submitted&apos;,
              project: &apos;5692b91fd1028f01000407e3&apos;,
            }, {
              _id: &apos;5a53f8ad0dc919000194ab6b&apos;,
              modified: &apos;2019-02-01T16:12:01.781Z&apos;,
              data: {
                firstName: &apos;Sally&apos;,
                lastName: &apos;Tanner&apos;,
                status: &apos;active&apos;,
                email: &apos;sally@example.com&apos;,
                submit: true,
              },
              form: &apos;5a53f887c8930000010f8b22&apos;,
              _fvid: 0,
              _vid: 0,
              created: &apos;2018-01-08T23:03:09.730Z&apos;,
              externalIds: [],
              access: [],
              roles: [],
              owner: &apos;553dbfc08d22d5cb1a7024f2&apos;,
              state: &apos;submitted&apos;,
              project: &apos;5692b91fd1028f01000407e3&apos;,
            }, {
              _id: &apos;5a53f8b744398b0001023eaf&apos;,
              modified: &apos;2019-02-01T16:11:57.139Z&apos;,
              data: {
                firstName: &apos;Jane&apos;,
                lastName: &apos;Doe&apos;,
                status: &apos;active&apos;,
                email: &apos;jane@example.com&apos;,
                submit: true,
              },
              form: &apos;5a53f887c8930000010f8b22&apos;,
              _fvid: 0,
              _vid: 0,
              created: &apos;2018-01-08T23:03:19.473Z&apos;,
              externalIds: [],
              access: [],
              roles: [],
              owner: &apos;553dbfc08d22d5cb1a7024f2&apos;,
              state: &apos;submitted&apos;,
              project: &apos;5692b91fd1028f01000407e3&apos;,
            },
          ];
          resolve(values);
        }, 50);
      });
    };

    Formio.createForm(element, htmlRenderMode, {
      readOnly: true,
      renderMode: &apos;html&apos;,
    })
      .then(form =&gt; {
        form.submission = {
          data: {
            textfieldonPage3: &apos;test&apos;,
            signature: &apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABTIAAACWCAYAAADt5XcLAAAgAElEQVR4Xu3dfWydV30H8NM1dLRdndIOKKJxGHSh0MalgBilpLAJyIsatQgJu4rT8peNiFOEhl0pyR8gxZHq/DGJJAhHCNbEEU5BHVWyJpWYuja0tOPdSctLQVBHWmAwkTi0lEFh+j3h3tqOG9vJvfa59/kcybKT3Ps85/mcE0f+5nfOOe/ZZ3/156QRIECAAAECBAgQIECAAAECBAgQIEAgY4HzBJkZj46uESBAgAABAgQIECBAgAABAgQIECBQCAgyTQQCBAgQIECAAAECBAgQIECAAAECBLIXEGRmP0Q6SIAAAQIECBAgQIAAAQIECBAgQICAINMcIECAAAECBAgQIECAAAECBAgQIEAgewFBZvZDpIMECBAgQIAAAQIECBAgQIAAAQIECAgyzQECBAgQIECAAAECBAgQIECAAAECBLIXEGRmP0Q6SIAAAQIECBAgQIAAAQIECBAgQICAINMcIECAAAECBAgQIECAAAECBAgQIEAgewFBZvZDpIMECBAgQIAAAQIECBAgQIAAAQIECAgyzQECBAgQIECAAAECBAgQIECAAAECBLIXEGRmP0Q6SIAAAQIECBAgQIAAAQIECBAgQICAINMcIECAAAECBAgQIECAAAECBAgQIEAgewFBZvZDpIMECBAgQIAAAQIECBAgQIAAAQIECAgyzQECBAgQIECAAAECBAgQIECAAAECBLIXEGRmP0Q6SIAAAQIECBAgQIAAAQIECBAgQICAINMcIECAAAECBAgQIECAAAECBAgQIEAgewFBZvZDpIMECBAgQIAAAQIECBAgQIAAAQIECAgyzQECBAgQIECAAAECBAgQIECAAAECBLIXEGRmP0Q6SIAAAQIECBAgQIAAAQIECBAgQICAINMcIECAAAECBAgQIECAAAECBAgQIEAgewFBZvZDpIMECBAgQIAAAQIECBAgQIAAAQIECAgyzQECBAgQIECAAAECBAgQIECAAAECBLIXEGRmP0Q6SIAAAQIECBAgQIAAAQIECBAgQICAINMcIECAAAECBAgQIECAAAECBAgQIEAgewFBZvZDpIO1Fjhx4kQaGTlSXHbhwoXFx6WXthSfNQIECBAgQIAAAQIECBAgQIAAgTwFBJl5jotezUIggslnnjmaTpwY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sVhGHh8aAQIECBAgQIAAAQIECBAgkL+AIDP/MdJDAgQIECBAgAABAgQIECBAgAABAqUXEGSWfgoAIECAAAECBAgQIECAAAECBAgQIJC/gCAz/zHSQwIECBAgQIAAAQIECBAgQIAAAQKlFxBkln4KACBAgAABAgQIECBAgAABAgQIECCQv4AgM/8x0kMCBAgQIECAAAECBAgQIECAAAECpRcQZJZ+CgAgQIAAAQIECBAgQIAAAQIECBAgkL+AIDP/MdJDAgQIECBAgAABAgQIECBAgAABAqUXEGSWfgoAIECAAAECBAgQIECAAAECBAgQIJC/gCAz/zHSQwIECBAgQIAAAQIECBAgQIAAAQKlFxBkln4KACBAgAABAgQIECBAgAABAgQIECCQv4AgM/8x0kMCBAgQIECAAAECBAgQIECAAAECpRcQZJZ+CgAgQIAAAQIECBAgQIAAAQIECBAgkL+AIDP/MdJDAgQIECBAgAABAgQIECBAgAABAqUXEGSWfgoAIECAAAECBAgQIECAAAECBAgQIJC/gCAz/zHSQwIECBAgQIAAAQIECBAgQIAAAQKlFxBkln4KACBAgAABAgQIECBAgAABAgQIECCQv4AgM/8x0kMCBAgQIECAAAECBAgQIECAAAECpRcQZJZ+CgAgQIAAAQIECBAgQIAAAQIECBAgkL+AIDP/MdJDAgQIECBAgAABAgQIECBAgAABAqUXEGSWfgoAIECAAAECBAgQIECAAAECBAgQIJC/gCAz/zHSQwIECBAgQIAAAQIECBAgQIAAAQKlFxBkln4KACBAgAABAgQIECBAgAABAgQIECCQv4AgM/8x0kMCBAgQIECAAAECBAgQIECAAAECpRcQZJZ+CgAgQIAAAQIECBAgQIAAAQIECBAgkL+AIDP/MdJDAgQIECBAgAABAgQIECBAgAABAqUXEGSWfgoAIECAAAECBAgQIECAAAECBAgQIJC/gCAz/zHSQwIECBAgQIAAAQIECBAgQIAAAQKlFxBkln4KACBAgAABAgQIECBAgAABAgQIECCQv4AgM/8x0kMCBAgQIECAAAECBAgQIECAAAECpRcQZJZ+CgAgQIAAAQIECBAgQIAAAQIECBAgkL+AIDP/MdJDAgQIECBAgAABAgQIECBAgAABAqUXEGSWfgoAIECAAAECBAgQIECAAAECBAgQIJC/gCAz/zHSQwIECBAgQIAAAQIECBAgQIAAAQKlFxBkln4KACBAgAABAgQIECBAgAABAgQIECCQv4AgM/8x0kMCBAgQIECAAAECBAgQIECAAAECpRcQZJZ+CgAgQIAAAQIECBAgQIAAAQIECBAgkL+AIDP/MdJDAgQIECBAgAABAgQIEL7bi68AAAGrSURBVCBAgAABAqUXEGSWfgoAIECAAAECBAgQIECAAAECBAgQIJC/gCAz/zHSQwIECBAgQIAAAQIECBAgQIAAAQKlFxBkln4KACBAgAABAgQIECBAgAABAgQIECCQv4AgM/8x0kMCBAgQIECAAAECBAgQIECAAAECpRcQZJZ+CgAgQIAAAQIECBAgQIAAAQIECBAgkL+AIDP/MdJDAgQIECBAgAABAgQIECBAgAABAqUXEGSWfgoAIECAAAECBAgQIECAAAECBAgQIJC/gCAz/zHSQwIECBAgQIAAAQIECBAgQIAAAQKlFxBkln4KACBAgAABAgQIECBAgAABAgQIECCQv4AgM/8x0kMCBAgQIECAAAECBAgQIECAAAECpRcQZJZ+CgAgQIAAAQIECBAgQIAAAQIECBAgkL+AIDP/MdJDAgQIECBAgAABAgQIECBAgAABAqUXEGSWfgoAIECAAAECBAgQIECAAAECBAgQIJC/gCAz/zHSQwIECBAgQIAAAQIECBAgQIAAAQKlFxBkln4KACBAgAABAgQIECBAgAABAgQIECCQv8D/A4EQEWXi+YzZAAAAAElFTkSuQmCC&apos;,
            panelDataGrid: [
              {
                panelDataGridD: &apos;d&apos;,
                panelDataGridC: &apos;c&apos;,
                panelDataGridB: &apos;b&apos;,
                panelDataGridA: &apos;a&apos;,
              }, {
                panelDataGridD: &apos;h&apos;,
                panelDataGridC: &apos;g&apos;,
                panelDataGridB: &apos;f&apos;,
                panelDataGridA: &apos;e&apos;,
              }, {
                panelDataGridD: &apos;l&apos;,
                panelDataGridC: &apos;k&apos;,
                panelDataGridB: &apos;j&apos;,
                panelDataGridA: &apos;i&apos;,
              },
            ],
            textfield: &apos;testing&apos;,
            page2Customer: &apos;bob@example.com&apos;,
            textfieldonPage2: &apos;test&apos;,
            numberField: 234,
            textfieldonpage1: [
              &apos;a&apos;, &apos;b&apos;, &apos;c&apos;,
            ],
            panelHtml5Select: &apos;banana&apos;,
            page3Iagreetothefollowtherules: true,
            panelText: &apos;hello&apos;,
          },
        };

        setTimeout(() =&gt; {
          const customerSelectEl = form.element.querySelector(&apos;.formio-component-page2Customer&apos;);
          const customerSelectValueEl = customerSelectEl.querySelector(&apos;[ref=&quot;value&quot;]&apos;);
          const htmlSelectEl = form.element.querySelector(&apos;.formio-component-panelHtml5Select&apos;);
          const htmlSelectValueEl = htmlSelectEl.querySelector(&apos;[ref=&quot;value&quot;]&apos;);
          const checkboxEl = form.element.querySelector(&apos;.formio-component-page3Iagreetothefollowtherules&apos;);
          const checkboxValueEl = checkboxEl.querySelector(&apos;[ref=&quot;value&quot;]&apos;);

          assert.equal(customerSelectValueEl.textContent.trim(), &apos;Bob Thompson&apos;, &apos;Should render Select value properly&apos;);
          assert.equal(htmlSelectValueEl.textContent.trim(), &apos;Banana&apos;, &apos;Should render HTML5 Select value properly&apos;);
          assert.equal(checkboxValueEl.textContent.trim(), &apos;True&apos;, &apos;Should render Checkbox value properly&apos;);

          Formio.makeRequest = originalMakeRequest;
          done();
        }, 400);
      })
      .catch(done);
  });

  it(&apos;HTML render mode for Wizard&apos;, (done) =&gt; {
    const element = document.createElement(&apos;div&apos;);
    htmlRenderMode.display = &apos;wizard&apos;;

    const originalMakeRequest = Formio.makeRequest;
    Formio.makeRequest = function() {
      return new Promise(resolve =&gt; {
        setTimeout(() =&gt; {
          const values = [
            {
              _id: &apos;5a53f8a044398b0001023eab&apos;,
              modified: &apos;2019-02-01T16:12:06.618Z&apos;,
              data: {
                firstName: &apos;Bob&apos;,
                lastName: &apos;Thompson&apos;,
                status: &apos;inactive&apos;,
                email: &apos;bob@example.com&apos;,
                submit: true,
              },
              form: &apos;5a53f887c8930000010f8b22&apos;,
              _fvid: 0,
              _vid: 0,
              created: &apos;2018-01-08T23:02:56.484Z&apos;,
              externalIds: [],
              access: [],
              roles: [],
              owner: &apos;553dbfc08d22d5cb1a7024f2&apos;,
              state: &apos;submitted&apos;,
              project: &apos;5692b91fd1028f01000407e3&apos;,
            },
            {
              _id: &apos;5a53f8ad0dc919000194ab6b&apos;,
              modified: &apos;2019-02-01T16:12:01.781Z&apos;,
              data: {
                firstName: &apos;Sally&apos;,
                lastName: &apos;Tanner&apos;,
                status: &apos;active&apos;,
                email: &apos;sally@example.com&apos;,
                submit: true,
              },
              form: &apos;5a53f887c8930000010f8b22&apos;,
              _fvid: 0,
              _vid: 0,
              created: &apos;2018-01-08T23:03:09.730Z&apos;,
              externalIds: [],
              access: [],
              roles: [],
              owner: &apos;553dbfc08d22d5cb1a7024f2&apos;,
              state: &apos;submitted&apos;,
              project: &apos;5692b91fd1028f01000407e3&apos;,
            },
            {
              _id: &apos;5a53f8b744398b0001023eaf&apos;,
              modified: &apos;2019-02-01T16:11:57.139Z&apos;,
              data: {
                firstName: &apos;Jane&apos;,
                lastName: &apos;Doe&apos;,
                status: &apos;active&apos;,
                email: &apos;jane@example.com&apos;,
                submit: true,
              },
              form: &apos;5a53f887c8930000010f8b22&apos;,
              _fvid: 0,
              _vid: 0,
              created: &apos;2018-01-08T23:03:19.473Z&apos;,
              externalIds: [],
              access: [],
              roles: [],
              owner: &apos;553dbfc08d22d5cb1a7024f2&apos;,
              state: &apos;submitted&apos;,
              project: &apos;5692b91fd1028f01000407e3&apos;,
            },
          ];
          resolve(values);
        }, 50);
      });
    };

    Formio.createForm(element, htmlRenderMode, {
      readOnly: true,
      renderMode: &apos;html&apos;,
    }).then(form =&gt; {
      form.submission = {
        data: {
          textfieldonPage3: &apos;test&apos;,
          signature: &apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABTIAAACWCAYAAADt5XcLAAAgAElEQVR4Xu3dfWydV30H8NM1dLRdndIOKKJxGHSh0MalgBilpLAJyIsatQgJu4rT8peNiFOEhl0pyR8gxZHq/DGJJAhHCNbEEU5BHVWyJpWYuja0tOPdSctLQVBHWmAwkTi0lEFh+j3h3tqOG9vJvfa59/kcybKT3Ps85/mcE0f+5nfOOe/ZZ3/156QRIECAAAECBAgQIECAAAECBAgQIEAgY4HzBJkZj46uESBAgAABAgQIECBAgAABAgQIECBQCAgyTQQCBAgQIECAAAECBAgQIECAAAECBLIXEGRmP0Q6SIAAAQIECBAgQIAAAQIECBAgQICAINMcIECAAAECBAgQIECAAAECBAgQIEAgewFBZvZDpIMECBAgQIAAAQIECBAgQIAAAQIECAgyzQECBAgQIECAAAECBAgQIECAAAECBLIXEGRmP0Q6SIAAAQIECBAgQIAAAQIECBAgQICAINMcIECAAAECBAgQIECAAAECBAgQIEAgewFBZvZDpIMECBAgQIAAAQIECBAgQIAAAQIECAgyzQECBAgQIECAAAECBAgQIECAAAECBLIXEGRmP0Q6SIAAAQIECBAgQIAAAQIECBAgQICAINMcIECAAAECBAgQIECAAAECBAgQIEAgewFBZvZDpIMECBAgQIAAAQIECBAgQIAAAQIECAgyzQECBAgQIECAAAECBAgQIECAAAECBLIXEGRmP0Q6SIAAAQIECBAgQIAAAQIECBAgQICAINMcIECAAAECBAgQIECAAAECBAgQIEAgewFBZvZDpIMECBAgQIAAAQIECBAgQIAAAQIECAgyzQECBAgQIECAAAECBAgQIECAAAECBLIXEGRmP0Q6SIAAAQIECBAgQIAAAQIECBAgQICAINMcIECAAAECBAgQIECAAAECBAgQIEAgewFBZvZDpIMECBAgQIAAAQIECBAgQIAAAQIECAgyzQECBAgQIECAAAECBAgQIECAAAECBLIXEGRmP0Q6SIAAAQIECBAgQIAAAQIECBAgQICAINMcIECAAAECBAgQIECAAAECBAgQIEAgewFBZvZDpIO1Fjhx4kQaGTlSXHbhwoXFx6WXthSfNQIECBAgQIAAAQIECBAgQIAAgTwFBJl5jotezUIggslnnjmaTpwY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sVhGHh8aAQIECBAgQIAAAQIECBAgkL+AIDP/MdJDAgQIECBAgAABAgQIECBAgAABAqUXEGSWfgoAIECAAAECBAgQIECAAAECBAgQIJC/gCAz/zHSQwIECBAgQIAAAQIECBAgQIAAAQKlFxBkln4KACBAgAABAgQIECBAgAABAgQIECCQv4AgM/8x0kMCBAgQIECAAAECBAgQIECAAAECpRcQZJZ+CgAgQIAAAQIECBAgQIAAAQIECBAgkL+AIDP/MdJDAgQIECBAgAABAgQIECBAgAABAqUXEGSWfgoAIECAAAECBAgQIECAAAECBAgQIJC/gCAz/zHSQwIECBAgQIAAAQIECBAgQIAAAQKlFxBkln4KACBAgAABAgQIECBAgAABAgQIECCQv4AgM/8x0kMCBAgQIECAAAECBAgQIECAAAECpRcQZJZ+CgAgQIAAAQIECBAgQIAAAQIECBAgkL+AIDP/MdJDAgQIECBAgAABAgQIECBAgAABAqUXEGSWfgoAIECAAAECBAgQIECAAAECBAgQIJC/gCAz/zHSQwIECBAgQIAAAQIECBAgQIAAAQKlFxBkln4KACBAgAABAgQIECBAgAABAgQIECCQv4AgM/8x0kMCBAgQIECAAAECBAgQIECAAAECpRcQZJZ+CgAgQIAAAQIECBAgQIAAAQIECBAgkL+AIDP/MdJDAgQIECBAgAABAgQIECBAgAABAqUXEGSWfgoAIECAAAECBAgQIECAAAECBAgQIJC/gCAz/zHSQwIECBAgQIAAAQIECBAgQIAAAQKlFxBkln4KACBAgAABAgQIECBAgAABAgQIECCQv4AgM/8x0kMCBAgQIECAAAECBAgQIECAAAECpRcQZJZ+CgAgQIAAAQIECBAgQIAAAQIECBAgkL+AIDP/MdJDAgQIECBAgAABAgQIECBAgAABAqUXEGSWfgoAIECAAAECBAgQIECAAAECBAgQIJC/gCAz/zHSQwIECBAgQIAAAQIECBAgQIAAAQKlFxBkln4KACBAgAABAgQIECBAgAABAgQIECCQv4AgM/8x0kMCBAgQIECAAAECBAgQIECAAAECpRcQZJZ+CgAgQIAAAQIECBAgQIAAAQIECBAgkL+AIDP/MdJDAgQIECBAgAABAgQIECBAgAABAqUXEGSWfgoAIECAAAECBAgQIECAAAECBAgQIJC/gCAz/zHSQwIECBAgQIAAAQIECBAgQIAAAQKlFxBkln4KACBAgAABAgQIECBAgAABAgQIECCQv4AgM/8x0kMCBAgQIECAAAECBAgQIECAAAECpRcQZJZ+CgAgQIAAAQIECBAgQIAAAQIECBAgkL+AIDP/MdJDAgQIECBAgAABAgQIEL7bi68AAAGrSURBVCBAgAABAqUXEGSWfgoAIECAAAECBAgQIECAAAECBAgQIJC/gCAz/zHSQwIECBAgQIAAAQIECBAgQIAAAQKlFxBkln4KACBAgAABAgQIECBAgAABAgQIECCQv4AgM/8x0kMCBAgQIECAAAECBAgQIECAAAECpRcQZJZ+CgAgQIAAAQIECBAgQIAAAQIECBAgkL+AIDP/MdJDAgQIECBAgAABAgQIECBAgAABAqUXEGSWfgoAIECAAAECBAgQIECAAAECBAgQIJC/gCAz/zHSQwIECBAgQIAAAQIECBAgQIAAAQKlFxBkln4KACBAgAABAgQIECBAgAABAgQIECCQv4AgM/8x0kMCBAgQIECAAAECBAgQIECAAAECpRcQZJZ+CgAgQIAAAQIECBAgQIAAAQIECBAgkL+AIDP/MdJDAgQIECBAgAABAgQIECBAgAABAqUXEGSWfgoAIECAAAECBAgQIECAAAECBAgQIJC/gCAz/zHSQwIECBAgQIAAAQIECBAgQIAAAQKlFxBkln4KACBAgAABAgQIECBAgAABAgQIECCQv8D/A4EQEWXi+YzZAAAAAElFTkSuQmCC&apos;,
          panelDataGrid: [
            {
              panelDataGridD: &apos;d&apos;,
              panelDataGridC: &apos;c&apos;,
              panelDataGridB: &apos;b&apos;,
              panelDataGridA: &apos;a&apos;
            },
            {
              panelDataGridD: &apos;h&apos;,
              panelDataGridC: &apos;g&apos;,
              panelDataGridB: &apos;f&apos;,
              panelDataGridA: &apos;e&apos;
            },
            {
              panelDataGridD: &apos;l&apos;,
              panelDataGridC: &apos;k&apos;,
              panelDataGridB: &apos;j&apos;,
              panelDataGridA: &apos;i&apos;
            }
          ],
          textfield: &apos;testing&apos;,
          page2Customer: &apos;bob@example.com&apos;,
          textfieldonPage2: &apos;test&apos;,
          numberField: 234,
          textfieldonpage1: [
            &apos;a&apos;,
            &apos;b&apos;,
            &apos;c&apos;
          ],
          panelHtml5Select: &apos;banana&apos;,
          page3Iagreetothefollowtherules: true,
          panelText: &apos;hello&apos;
        },
      };

      setTimeout(() =&gt; {
        form.setPage(1);

        setTimeout(() =&gt; {
          const customerSelectEl = form.element.querySelector(&apos;.formio-component-page2Customer&apos;);
          const customerSelectValueEl = customerSelectEl.querySelector(&apos;[ref=&quot;value&quot;]&apos;);

          assert.equal(customerSelectValueEl.textContent.trim(), &apos;Bob Thompson&apos;, &apos;Should render Select value properly&apos;);

          form.setPage(2);

          setTimeout(() =&gt; {
            const htmlSelectEl = form.element.querySelector(&apos;.formio-component-panelHtml5Select&apos;);
            const htmlSelectValueEl = htmlSelectEl.querySelector(&apos;[ref=&quot;value&quot;]&apos;);

            assert.equal(htmlSelectValueEl.textContent.trim(), &apos;Banana&apos;, &apos;Should render HTML5 Select value properly&apos;);

            Formio.makeRequest = originalMakeRequest;

            done();
          }, 400);
        }, 400);
      }, 300);
    }).catch(done);
  });

  it(&apos;Test optional sanitize&apos;, (done) =&gt; {
    const element = document.createElement(&apos;div&apos;);

    Formio.createForm(element, optionalSanitize, {
      sanitize: false,
    }).then(form =&gt; {
      const sanitize = sinon.spy(FormioUtils, &apos;sanitize&apos;);
      form.redraw();
      setTimeout(() =&gt; {
        assert.equal(sanitize.callCount, 0, &apos;Should not sanitize templates when sanitize in not turned on&apos;);
        element.innerHTML = &apos;&apos;;
        Formio.createForm(element, optionalSanitize, {
          sanitize: true,
        }).then(form =&gt; {
          sanitize.resetHistory();
          form.redraw();
          setTimeout(() =&gt; {
            assert.equal(sanitize.callCount, 1, &apos;Should sanitize templates when sanitize in turned on&apos;);
            done();
          }, 250);
        }, 250);
      });
    }).catch(done);
  });

  it(&apos;Should execute clearOnHide if visibility of the component inside an EditGrid has changed&apos;, (done) =&gt; {
    const formElement = document.createElement(&apos;div&apos;);
    const form = new Webform(formElement, { language: &apos;en&apos;, template: &apos;bootstrap3&apos; });

    form.setForm(testClearOnHideInsideEditGrid).then(() =&gt; {
      form.submission = {
        state: &apos;submitted&apos;,
        data: {
          subsidiaryEditGrid: [
            {
              subsidiaryEntityContainer: {
                entityFullName: &apos;test&apos;,
                divisionNum: &apos;&apos;,
                entityType: &apos;otherEntity&apos;,
                ifOtherEntityPleaseExplain: &apos;test&apos;,
              },
            },
          ],
        },
      };

      setTimeout(() =&gt; {
        const clearOnHideField = form.getComponent([
          &apos;subsidiaryEditGrid&apos;,
          0,
          &apos;subsidiaryEntityContainer&apos;,
          &apos;ifOtherEntityPleaseExplain&apos;,
        ]);
        const radioTrigger = form.getComponent([&apos;subsidiaryEditGrid&apos;, 0, &apos;subsidiaryEntityContainer&apos;, &apos;entityType&apos;]);
        assert.equal(form.rootPristine, true, &apos;Should not change this prop  after setting a submission&apos;);
        assert.equal(clearOnHideField.visible, true, &apos;Should become visible&apos;);
        assert.equal(clearOnHideField.dataValue, &apos;test&apos;, &apos;Should set a value from  the submission&apos;);

        radioTrigger.setValue(&apos;subsidiary&apos;, { modified: true });
        setTimeout(() =&gt; {
          assert.equal(clearOnHideField.visible, false, &apos;Should become invisible&apos;);

          radioTrigger.setValue(&apos;otherEntity&apos;, { modified: true });
          setTimeout(() =&gt; {
            assert.equal(clearOnHideField.visible, true, &apos;Should become visible&apos;);
            assert.equal(clearOnHideField.dataValue, &apos;&apos;, &apos;Should clear a value due to the clearOnHide&apos;);

            done();
          }, 250);
        }, 250);
      }, 250);
    }).catch(done);
  });

  it(&apos;Should show values in editGrid rows with nested dataGrid when viewing submission with initEmpty option&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const formWithNestedDataGridInitEmptyOption = new Webform(formElement);

    formWithNestedDataGridInitEmptyOption.setForm(formWithNestedDataGridInitEmpty.form).then(() =&gt; {
      formWithNestedDataGridInitEmptyOption.setSubmission(formWithNestedDataGridInitEmpty.submission);

      setTimeout(() =&gt; {
        const nestedDataGridFirstRowComponentValue = formWithNestedDataGridInitEmptyOption.element.querySelector(
          &apos;[ref=&quot;editgrid-editGrid-row&quot;]&apos;).querySelectorAll(&apos;.col-sm-2&apos;);

        assert.equal(nestedDataGridFirstRowComponentValue[1].textContent.trim(), &apos;email&apos;);
        assert.equal(nestedDataGridFirstRowComponentValue[2].textContent.trim(), &apos;hhh@gmail.com&apos;);

        done();
      }, 200);
    })
      .catch((err) =&gt; done(err));
  });

  it(&apos;Should not refetch options for Select if there was an error&apos;, function(done) {
    const formElement = document.createElement(&apos;div&apos;);
    const form= new Webform(formElement);
    const formJson = {
      components: [
        {
          label: &apos;Select&apos;,
          widget: &apos;html5&apos;,
          tableView: true,
          dataSrc: &apos;url&apos;,
          data: {
            url: &apos;http://example.com&apos;,
            headers: [
              {
                key: &apos;&apos;,
                value: &apos;&apos;,
              },
            ],
          },
          key: &apos;select&apos;,
          hidden: true,
          type: &apos;select&apos;,
          input: true,
          disableLimit: false,
        },
      ],
    };

    let counter = 0;
    const originalMakeRequest = Formio.makeRequest;
    Formio.makeRequest = function() {
      return new Promise((_, reject) =&gt; {
        setTimeout(() =&gt; {
          counter++;
          const err = new Error(&apos;Failed to fetch&apos;);
          err.networkError = true;
          reject(err);
        }, 50);
      });
    };

    form.setForm(formJson).then(() =&gt; {
      const select = form.getComponent(&apos;select&apos;);

      select.visible = true;

      setTimeout(() =&gt; {
        setTimeout(() =&gt; {
          select.visible = false;

          setTimeout(() =&gt; {
            select.visible = true;

            setTimeout(() =&gt; {
              expect(select.networkError).to.be.true;
              expect(select.loadingError).to.be.true;
              expect(counter).to.equal(1);
              Formio.makeRequest = originalMakeRequest;
              done();
            }, 200);
          }, 200);
        }, 200);
      }, 200);
    })
    .catch((err) =&gt; done(err));
  });

  it(&apos;Should show only one custom error when submitting empty required field with multiple validation&apos;, function(done) {
    const formJson =  {
      components: [
        {
          label: &apos;This line&apos;,
          tableView: false,
          storage: &apos;base64&apos;,
          webcam: false,
          fileTypes: [{ label: &apos;&apos;, value: &apos;&apos; }],
          multiple: true,
          validate: { required: true, customMessage: &apos;will be showed once&apos; },
          key: &apos;file&apos;,
          type: &apos;file&apos;,
          input: true,
        },
        {
          label: &apos;Submit&apos;,
          showValidations: false,
          tableView: false,
          key: &apos;submit&apos;,
          type: &apos;button&apos;,
          input: true,
          saveOnEnter: false,
        }
      ]
    };
    const element = document.createElement(&apos;div&apos;);
    const form = new Webform(element);

    form.setForm(formJson).then(() =&gt; {
    Harness.clickElement(form, form.element.querySelector(&apos;[name=&quot;data[submit]&quot;]&apos;));

    setTimeout(() =&gt; {
      assert.equal(form.errors[0].messages.length, 1);
      assert.equal(form.errors[0].messages[0].message, &apos;will be showed once&apos;);
      assert.equal(form.element.querySelector(&apos;[ref=&quot;errorRef&quot;]&apos;).textContent.trim().includes(&apos;will be showed once&apos;), true);
      done();
    }, 200);
    })
    .catch((err) =&gt; done(err));
  });

  it(&apos;Should show validation error when submitting number with just &quot;-&quot; sign and required validation&apos;, function(done) {
    const formJson =  {
      components: [
        {
          label: &apos;Number&apos;,
          mask: false,
          tableView: false,
          delimiter: false,
          requireDecimal: false,
          inputFormat: &apos;plain&apos;,
          truncateMultipleSpaces: false,
          validate: {
            required: true
          },
          key: &apos;number&apos;,
          type: &apos;number&apos;,
          input: true
        },
        {
          label: &apos;Submit&apos;,
          showValidations: false,
          tableView: false,
          key: &apos;submit&apos;,
          type: &apos;button&apos;,
          input: true,
          saveOnEnter: false,
        }
      ]
    };
    const element = document.createElement(&apos;div&apos;);
    const form = new Webform(element);

    form.setForm(formJson).then(() =&gt; {
      Harness.setInputValue(form, &apos;data[number]&apos;, &apos;-_&apos;);
      Harness.clickElement(form, form.element.querySelector(&apos;[name=&quot;data[submit]&quot;]&apos;));

      setTimeout(() =&gt; {
        assert.equal(form.errors[0].messages.length, 1);
        assert.equal(form.errors[0].messages[0].message, &apos;Number is required&apos;);
        assert.equal(form.element.querySelector(&apos;[ref=&quot;errorRef&quot;]&apos;).textContent.trim().includes(&apos;Number is required&apos;), true);
        done();
      }, 200);
    })
    .catch((err) =&gt; done(err));
  });

  each(FormTests, (formTest) =&gt; {
    const useDoneInsteadOfPromise = formTest.useDone;

    if (useDoneInsteadOfPromise) {
      describe(formTest.title || &apos;&apos;, () =&gt; {
        each(formTest.tests, (formTestTest, title) =&gt; {
          if (title === &apos;Email Action Test&apos;) {
            console.log(&apos;Email Action Test&apos;);
          }

          it(title, function(done) {
            const self = this;
            const formElement = document.createElement(&apos;div&apos;);
            let form = new Webform(formElement, _.cloneDeep(formTest.formOptions || {}));
            form.setForm(formTest.form).then(function() {
              formTestTest(form, function(error) {
                form = null;
                formElement.innerHTML = &apos;&apos;;
                if (error) {
                  throw new Error(error);
                }
                done();
              }, self);
            });
          });
        });
      });
    }
    else {
      describe(formTest.title || &apos;&apos;, () =&gt; {
        each(formTest.tests, (formTestTest, title) =&gt; {
          it(title, function() {
            const formElement = document.createElement(&apos;div&apos;);
            const form = new Webform(formElement, { template: &apos;bootstrap3&apos;, language: &apos;en&apos; });
            return form.setForm(formTest.form).then(function() {
              formTestTest(form, function(error) {
                form.destroy();
                if (error) {
                  throw new Error(error);
                }
              });
            });
          });
        });
      });
    }
  });
});

// describe(&apos;Test the saveDraft and restoreDraft feature&apos;, () =&gt; {
//   APIMock.submission(&apos;https://savedraft.form.io/myform&apos;, {
//     components: [
//       {
//         type: &apos;textfield&apos;,
//         key: &apos;a&apos;,
//         label: &apos;A&apos;
//       },
//       {
//         type: &apos;textfield&apos;,
//         key: &apos;b&apos;,
//         label: &apos;B&apos;
//       }
//     ]
//   });
//
//   const saveDraft = function(user, draft, newData, done) {
//     const formElement = document.createElement(&apos;div&apos;);
//     const form = new Webform(formElement, {
//       saveDraft: true,
//       saveDraftThrottle: false
//     });
//     form.src = &apos;https://savedraft.form.io/myform&apos;;
//     Formio.setUser(user);
//     form.on(&apos;restoreDraft&apos;, (existing) =&gt; {
//       assert.deepEqual(existing ? existing.data : null, draft);
//       form.setSubmission({ data: newData }, { modified: true });
//     });
//     form.on(&apos;saveDraft&apos;, (saved) =&gt; {
//       // Make sure the modified class was added to the components.
//       const a = form.getComponent(&apos;a&apos;);
//       const b = form.getComponent(&apos;b&apos;);
//       assert.equal(a.hasClass(a.getElement(), &apos;formio-modified&apos;), true);
//       assert.equal(b.hasClass(b.getElement(), &apos;formio-modified&apos;), true);
//       assert.deepEqual(saved.data, newData);
//       form.draftEnabled = false;
//       done();
//     });
//     form.formReady.then(() =&gt; {
//       assert.equal(form.savingDraft, true);
//     });
//   };
//
//   it(&apos;Should allow a user to start a save draft session.&apos;, (done) =&gt; saveDraft({
//     _id: &apos;1234&apos;,
//     data: {
//       firstName: &apos;Joe&apos;,
//       lastName: &apos;Smith&apos;
//     }
//   }, null, {
//     a: &apos;one&apos;,
//     b: &apos;two&apos;
//   }, done));
//
//   it(&apos;Should allow a different user to start a new draft session&apos;, (done) =&gt; saveDraft({
//     _id: &apos;2468&apos;,
//     data: {
//       firstName: &apos;Sally&apos;,
//       lastName: &apos;Thompson&apos;
//     }
//   }, null, {
//     a: &apos;three&apos;,
//     b: &apos;four&apos;
//   }, done));
//
//   it(&apos;Should restore a users existing draft&apos;, (done) =&gt; saveDraft({
//     _id: &apos;1234&apos;,
//     data: {
//       firstName: &apos;Joe&apos;,
//       lastName: &apos;Smith&apos;
//     }
//   }, {
//     a: &apos;one&apos;,
//     b: &apos;two&apos;
//   }, {
//     a: &apos;five&apos;,
//     b: &apos;six&apos;
//   }, done));
// });
/* eslint-enable max-statements */
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
