<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../../">
  <title data-ice="title">src/components/base/Base.js | formiojs</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="Common js library for client side interaction with &lt;form.io&gt;"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="formiojs"><meta property="twitter:description" content="Common js library for client side interaction with &lt;form.io&gt;"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/formio/formio.js"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/EventEmitter.js~EventEmitter.html">EventEmitter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Form.js~Form.html">Form</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/FormBuilder.js~FormBuilder.html">FormBuilder</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Formio.js~Formio.html">Formio</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/PDF.js~PDF.html">PDF</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/PDFBuilder.js~PDFBuilder.html">PDFBuilder</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Webform.js~Webform.html">Webform</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/WebformBuilder.js~WebformBuilder.html">WebformBuilder</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Wizard.js~Wizard.html">Wizard</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/WizardBuilder.js~WizardBuilder.html">WizardBuilder</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components">components</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/Components.js~Components.html">Components</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-address">components/address</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/address/Address.js~AddressComponent.html">AddressComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Address">Address</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-base">components/base</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/base/Base.js~BaseComponent.html">BaseComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Base">Base</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-base-editform">components/base/editForm</a><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EditFormUtils">EditFormUtils</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-button">components/button</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/button/Button.js~ButtonComponent.html">ButtonComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Button">Button</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-checkbox">components/checkbox</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/checkbox/Checkbox.js~CheckBoxComponent.html">CheckBoxComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Checkbox">Checkbox</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-columns">components/columns</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/columns/Column.js~ColumnComponent.html">ColumnComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/columns/Columns.js~ColumnsComponent.html">ColumnsComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Columns">Columns</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-container">components/container</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/container/Container.js~ContainerComponent.html">ContainerComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Container">Container</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-content">components/content</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/content/Content.js~ContentComponent.html">ContentComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Content">Content</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-currency">components/currency</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/currency/Currency.js~CurrencyComponent.html">CurrencyComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Currency">Currency</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-datagrid">components/datagrid</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/datagrid/DataGrid.js~DataGridComponent.html">DataGridComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-DataGrid">DataGrid</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-datamap">components/datamap</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/datamap/DataMap.js~DataMapComponent.html">DataMapComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-DataMap">DataMap</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-datetime">components/datetime</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/datetime/DateTime.js~DateTimeComponent.html">DateTimeComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-DateTime">DateTime</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-day">components/day</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/day/Day.js~DayComponent.html">DayComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Day">Day</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-editgrid">components/editgrid</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/editgrid/EditGrid.js~EditGridComponent.html">EditGridComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-EditGrid">EditGrid</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-edittable">components/edittable</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/edittable/EditTable.js~EditTableComponent.html">EditTableComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-EditTable">EditTable</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-email">components/email</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/email/Email.js~EmailComponent.html">EmailComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Email">Email</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-fieldset">components/fieldset</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/fieldset/Fieldset.js~FieldsetComponent.html">FieldsetComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Fieldset">Fieldset</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-file">components/file</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/file/File.js~FileComponent.html">FileComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-File">File</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-form">components/form</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/form/Form.js~FormComponent.html">FormComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Form">Form</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-hidden">components/hidden</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/hidden/Hidden.js~HiddenComponent.html">HiddenComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Hidden">Hidden</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-html">components/html</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/html/HTML.js~HTMLComponent.html">HTMLComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-HTML">HTML</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-location">components/location</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/location/Location.js~LocationComponent.html">LocationComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Location">Location</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-modaledit">components/modaledit</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/modaledit/ModalEdit.js~ModalEditComponent.html">ModalEditComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ModalEdit">ModalEdit</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-nested">components/nested</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/nested/NestedComponent.js~NestedComponent.html">NestedComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-NestedComponent">NestedComponent</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-number">components/number</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/number/Number.js~NumberComponent.html">NumberComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Number">Number</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-panel">components/panel</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/panel/Panel.js~PanelComponent.html">PanelComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Panel">Panel</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-password">components/password</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/password/Password.js~PasswordComponent.html">PasswordComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Password">Password</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-phonenumber">components/phonenumber</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/phonenumber/PhoneNumber.js~PhoneNumberComponent.html">PhoneNumberComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-PhoneNumber">PhoneNumber</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-radio">components/radio</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/radio/Radio.js~RadioComponent.html">RadioComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Radio">Radio</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-recaptcha">components/recaptcha</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/recaptcha/ReCaptcha.js~ReCaptchaComponent.html">ReCaptchaComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ReCaptcha">ReCaptcha</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-resource">components/resource</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/resource/Resource.js~ResourceComponent.html">ResourceComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Resource">Resource</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-select">components/select</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/select/Select.js~SelectComponent.html">SelectComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Select">Select</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-selectboxes">components/selectboxes</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/selectboxes/SelectBoxes.js~SelectBoxesComponent.html">SelectBoxesComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-SelectBoxes">SelectBoxes</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-signature">components/signature</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/signature/Signature.js~SignatureComponent.html">SignatureComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Signature">Signature</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-survey">components/survey</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/survey/Survey.js~SurveyComponent.html">SurveyComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Survey">Survey</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-table">components/table</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/table/Table.js~TableComponent.html">TableComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Table">Table</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-tabs">components/tabs</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/tabs/Tabs.js~TabsComponent.html">TabsComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Tabs">Tabs</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-tags">components/tags</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/tags/Tags.js~TagsComponent.html">TagsComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Tags">Tags</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-textarea">components/textarea</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/textarea/TextArea.js~TextAreaComponent.html">TextAreaComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-TextArea">TextArea</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-textfield">components/textfield</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/textfield/TextField.js~TextFieldComponent.html">TextFieldComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-TextField">TextField</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-time">components/time</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/time/Time.js~TimeComponent.html">TimeComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Time">Time</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-tree">components/tree</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Tree">Tree</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-unknown">components/unknown</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/unknown/Unknown.js~UnknownComponent.html">UnknownComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Unknown">Unknown</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-url">components/url</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/url/Url.js~UrlComponent.html">UrlComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Url">Url</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-well">components/well</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/well/Well.js~WellComponent.html">WellComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Well">Well</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#contrib">contrib</a><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Contrib">Contrib</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#contrib-sketchpad">contrib/sketchpad</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/contrib/sketchpad/sketchpad.js~Sketchpad.html">Sketchpad</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#contrib-stripe-checkout">contrib/stripe/checkout</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/contrib/stripe/checkout/StripeCheckout.js~StripeCheckoutComponent.html">StripeCheckoutComponent</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#contrib-stripe-stripe">contrib/stripe/stripe</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/contrib/stripe/stripe/Stripe.js~StripeComponent.html">StripeComponent</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#contrib-tagpad">contrib/tagpad</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/contrib/tagpad/tagpad.js~Tagpad.html">Tagpad</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#providers-storage">providers/storage</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-azure">azure</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-base64">base64</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-dropbox">dropbox</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-s3">s3</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-url">url</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-XHR">XHR</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#utils">utils</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-applyFormChanges">applyFormChanges</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-eachComponent">eachComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-escapeRegExCharacters">escapeRegExCharacters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-findComponent">findComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-findComponents">findComponents</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-flattenComponents">flattenComponents</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-formatAsCurrency">formatAsCurrency</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generateFormChange">generateFormChange</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getComponent">getComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getStrings">getStrings</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getValue">getValue</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-hasCondition">hasCondition</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isLayoutComponent">isLayoutComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-matchComponent">matchComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-parseFloatExt">parseFloatExt</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-removeComponent">removeComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-searchComponents">searchComponents</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-addTemplateHash">addTemplateHash</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-boolValue">boolValue</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-bootstrapVersion">bootstrapVersion</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-checkCalculated">checkCalculated</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-checkCondition">checkCondition</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-checkCustomConditional">checkCustomConditional</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-checkJsonConditional">checkJsonConditional</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-checkSimpleConditional">checkSimpleConditional</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-checkTrigger">checkTrigger</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-convertFormatToFlatpickr">convertFormatToFlatpickr</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-convertFormatToMask">convertFormatToMask</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-convertFormatToMoment">convertFormatToMoment</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-currentTimezone">currentTimezone</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-delay">delay</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-evaluate">evaluate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-fieldData">fieldData</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-formatDate">formatDate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-formatOffset">formatOffset</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getCurrencyAffixes">getCurrencyAffixes</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getDateSetting">getDateSetting</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getElementRect">getElementRect</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getInputMask">getInputMask</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getLocaleDateFormatInfo">getLocaleDateFormatInfo</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getNumberDecimalLimit">getNumberDecimalLimit</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getNumberSeparators">getNumberSeparators</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getPropertyValue">getPropertyValue</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getRandomComponentId">getRandomComponentId</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-guid">guid</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-interpolate">interpolate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isMongoId">isMongoId</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isValidDate">isValidDate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-iterateKey">iterateKey</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-loadZones">loadZones</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-matchInputMask">matchInputMask</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-momentDate">momentDate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-observeOverload">observeOverload</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-offsetDate">offsetDate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setActionProperty">setActionProperty</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-shouldLoadZones">shouldLoadZones</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-unfold">unfold</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-uniqueKey">uniqueKey</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-uniqueName">uniqueName</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-withSwitch">withSwitch</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-zonesLoaded">zonesLoaded</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-firstNonNil">firstNonNil</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#utils-jsonlogic">utils/jsonlogic</a><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-lodashOperators">lodashOperators</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#widgets">widgets</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/widgets/CalendarWidget.js~CalendarWidget.html">CalendarWidget</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/widgets/InputWidget.js~InputWidget.html">InputWidget</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/components/base/Base.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">/* globals Quill, ClassicEditor */
import { conformToMask } from &apos;vanilla-text-mask&apos;;
import Promise from &apos;native-promise-only&apos;;
import _ from &apos;lodash&apos;;
import Tooltip from &apos;tooltip.js&apos;;
import * as FormioUtils from &apos;../../utils/utils&apos;;
import Formio from &apos;../../Formio&apos;;
import Validator from &apos;../Validator&apos;;
import Widgets from &apos;../../widgets&apos;;
import Component from &apos;../../Component&apos;;
import dragula from &apos;dragula&apos;;
const CKEDITOR = &apos;https://cdn.staticaly.com/gh/formio/ckeditor5-build-classic/master/build/ckeditor.js&apos;;

/**
 * This is the BaseComponent class which all elements within the FormioForm derive from.
 */
export default class BaseComponent extends Component {
  static schema(...sources) {
    return _.merge({
      /**
       * Determines if this component provides an input.
       */
      input: true,

      /**
       * The data key for this component (how the data is stored in the database).
       */
      key: &apos;&apos;,

      /**
       * The input placeholder for this component.
       */
      placeholder: &apos;&apos;,

      /**
       * The input prefix
       */
      prefix: &apos;&apos;,

      /**
       * The custom CSS class to provide to this component.
       */
      customClass: &apos;&apos;,

      /**
       * The input suffix.
       */
      suffix: &apos;&apos;,

      /**
       * If this component should allow an array of values to be captured.
       */
      multiple: false,

      /**
       * The default value of this compoennt.
       */
      defaultValue: null,

      /**
       * If the data of this component should be protected (no GET api requests can see the data)
       */
      protected: false,

      /**
       * Validate if the value of this component should be unique within the form.
       */
      unique: false,

      /**
       * If the value of this component should be persisted within the backend api database.
       */
      persistent: true,

      /**
       * Determines if the component should be within the form, but not visible.
       */
      hidden: false,

      /**
       * If the component should be cleared when hidden.
       */
      clearOnHide: true,

      /**
       * If this component should be included as a column within a submission table.
       */
      tableView: true,

      /**
       * If true, will show label when component is in a datagrid.
       */
      dataGridLabel: false,

      /**
       * The input label provided to this component.
       */
      label: &apos;&apos;,
      labelPosition: &apos;top&apos;,
      labelWidth: 30,
      labelMargin: 3,
      description: &apos;&apos;,
      errorLabel: &apos;&apos;,
      tooltip: &apos;&apos;,
      hideLabel: false,
      tabindex: &apos;&apos;,
      disabled: false,
      autofocus: false,
      dbIndex: false,
      customDefaultValue: &apos;&apos;,
      calculateValue: &apos;&apos;,
      allowCalculateOverride: false,
      widget: null,

      /**
       * This will refresh this component when this field changes.
       */
      refreshOn: &apos;&apos;,

      /**
       * Determines if we should clear our value when a refresh occurs.
       */
      clearOnRefresh: false,

      /**
       * This will perform the validation on either &quot;change&quot; or &quot;blur&quot; of the input element.
       */
      validateOn: &apos;change&apos;,

      /**
       * The validation criteria for this component.
       */
      validate: {
        /**
         * If this component is required.
         */
        required: false,

        /**
         * Custom JavaScript validation.
         */
        custom: &apos;&apos;,

        /**
         * If the custom validation should remain private (only the backend will see it and execute it).
         */
        customPrivate: false
      },

      /**
       * The simple conditional settings for a component.
       */
      conditional: {
        show: null,
        when: null,
        eq: &apos;&apos;
      }
    }, ...sources);
  }

  /**
   * Provides a table view for this component. Override if you wish to do something different than using getView
   * method of your instance.
   *
   * @param value
   * @param options
   */
  /* eslint-disable no-unused-vars */
  static tableView(value, options) {}
  /* eslint-enable no-unused-vars */

  /**
   * Initialize a new BaseComponent.
   *
   * @param {Object} component - The component JSON you wish to initialize.
   * @param {Object} options - The options for this component.
   * @param {Object} data - The global data submission object this component will belong.
   */
  /* eslint-disable max-statements */
  constructor(component, options, data) {
    super(options, (component &amp;&amp; component.id) ? component.id : null);
    this.originalComponent = _.cloneDeep(component);

    // Determine if we are inside a datagrid.
    this.inDataGrid = this.options.inDataGrid;
    this.options.inDataGrid = false;

    /**
     * Determines if this component has a condition assigned to it.
     * @type {null}
     * @private
     */
    this._hasCondition = null;

    /**
     * The data object in which this component resides.
     * @type {*}
     */
    this.data = data || {};

    // Allow global override for any component JSON.
    if (
      this.options.components &amp;&amp;
      this.options.components[component.type]
    ) {
      _.merge(component, this.options.components[component.type]);
    }

    /**
     * The Form.io component JSON schema.
     * @type {*}
     */
    this.component = _.defaultsDeep(component || {}, this.defaultSchema);

    // Add the id to the component.
    this.component.id = this.id;

    /**
     * The bounding HTML Element which this component is rendered.
     * @type {null}
     */
    this.element = null;

    /**
     * The HTML Element for the table body. This is relevant for the &quot;multiple&quot; flag on inputs.
     * @type {null}
     */
    this.tbody = null;

    /**
     * The HTMLElement that is assigned to the label of this component.
     * @type {null}
     */
    this.labelElement = null;

    /**
     * The HTMLElement for which the errors are rendered for this component (usually underneath the component).
     * @type {null}
     */
    this.errorElement = null;

    /**
     * The existing error that this component has.
     * @type {string}
     */
    this.error = &apos;&apos;;

    /**
     * An array of all of the input HTML Elements that have been added to this component.
     * @type {Array}
     */
    this.inputs = [];

    /**
     * The basic component information which tells the BaseComponent how to render the input element of the components that derive from this class.
     * @type {null}
     */
    this.info = null;

    /**
     * The row path of this component.
     * @type {number}
     */
    this.row = this.options.row;

    /**
     * Determines if this component is disabled, or not.
     *
     * @type {boolean}
     */
    this._disabled = false;

    /**
     * Determines if this component is visible, or not.
     */
    this._visible = true;
    this._parentVisible = true;

    /**
     * If this input has been input and provided value.
     *
     * @type {boolean}
     */
    this.pristine = true;

    /**
     * Points to the parent component.
     *
     * @type {BaseComponent}
     */
    this.parent = null;

    /**
     * Points to the root component, usually the FormComponent.
     *
     * @type {BaseComponent}
     */
    this.root = this;

    this.options.name = this.options.name || &apos;data&apos;;

    /**
     * The validators that are assigned to this component.
     * @type {[string]}
     */
    this.validators = [&apos;required&apos;, &apos;minLength&apos;, &apos;maxLength&apos;, &apos;custom&apos;, &apos;pattern&apos;, &apos;json&apos;, &apos;mask&apos;];

    /**
     * Used to trigger a new change in this component.
     * @type {function} - Call to trigger a change in this component.
     */
    let lastChanged = null;
    const _triggerChange = _.debounce((...args) =&gt; {
      if (this.root) {
        this.root.changing = false;
      }
      if (!args[1] &amp;&amp; lastChanged) {
        // Set the changed component if one isn&apos;t provided.
        args[1] = lastChanged;
      }
      lastChanged = null;
      return this.onChange(...args);
    }, 100);
    this.triggerChange = (...args) =&gt; {
      if (args[1]) {
        // Make sure that during the debounce that we always track lastChanged component, even if they
        // don&apos;t provide one later.
        lastChanged = args[1];
      }
      if (this.root) {
        this.root.changing = true;
      }
      return _triggerChange(...args);
    };

    /**
     * Used to trigger a redraw event within this component.
     *
     * @type {Function}
     */
    this.triggerRedraw = _.debounce(this.redraw.bind(this), 100);

    // To force this component to be invalid.
    this.invalid = false;

    // Determine if the component has been built.
    this.isBuilt = false;

    if (this.component) {
      this.type = this.component.type;
      if (this.hasInput &amp;&amp; this.key) {
        this.options.name += `[${this.key}]`;
      }

      /**
       * The element information for creating the input element.
       * @type {*}
       */
      this.info = this.elementInfo();
    }

    // Allow anyone to hook into the component creation.
    this.hook(&apos;component&apos;);
  }
  /* eslint-enable max-statements */

  get hasInput() {
    return this.component.input || this.inputs.length;
  }

  get defaultSchema() {
    return BaseComponent.schema();
  }

  get key() {
    return _.get(this.component, &apos;key&apos;, &apos;&apos;);
  }

  get currentForm() {
    return this._currentForm;
  }

  set currentForm(instance) {
    this._currentForm = instance;
  }

  /**
   * Returns only the schema that is different from the default.
   *
   * @param schema
   * @param defaultSchema
   */
  getModifiedSchema(schema, defaultSchema) {
    const modified = {};
    if (!defaultSchema) {
      return schema;
    }
    _.each(schema, (val, key) =&gt; {
      if (!_.isArray(val) &amp;&amp; _.isObject(val) &amp;&amp; defaultSchema.hasOwnProperty(key)) {
        const subModified = this.getModifiedSchema(val, defaultSchema[key]);
        if (!_.isEmpty(subModified)) {
          modified[key] = subModified;
        }
      }
      else if (
        (key === &apos;type&apos;) ||
        (key === &apos;key&apos;) ||
        (key === &apos;label&apos;) ||
        (key === &apos;input&apos;) ||
        (key === &apos;tableView&apos;) ||
        !defaultSchema.hasOwnProperty(key) ||
        _.isArray(val) ||
        (val !== defaultSchema[key])
      ) {
        modified[key] = val;
      }
    });
    return modified;
  }

  /**
   * Returns the JSON schema for this component.
   */
  get schema() {
    return this.getModifiedSchema(_.omit(this.component, &apos;id&apos;), this.defaultSchema);
  }

  /**
   * Translate a text using the i18n system.
   *
   * @param {string} text - The i18n identifier.
   * @param {Object} params - The i18n parameters to use for translation.
   */
  t(text, params) {
    params = params || {};
    params.data = this.rootValue;
    params.row = this.data;
    params.component = this.component;
    return super.t(text, params);
  }

  performInputMapping(input) {
    return input;
  }

  getBrowserLanguage() {
    const nav = window.navigator;
    const browserLanguagePropertyKeys = [&apos;language&apos;, &apos;browserLanguage&apos;, &apos;systemLanguage&apos;, &apos;userLanguage&apos;];
    let language;

    // support for HTML 5.1 &quot;navigator.languages&quot;
    if (Array.isArray(nav.languages)) {
      for (let i = 0; i &lt; nav.languages.length; i++) {
        language = nav.languages[i];
        if (language &amp;&amp; language.length) {
          return language.split(&apos;;&apos;)[0];
        }
      }
    }

    // support for other well known properties in browsers
    for (let i = 0; i &lt; browserLanguagePropertyKeys.length; i++) {
      language = nav[browserLanguagePropertyKeys[i]];
      if (language &amp;&amp; language.length) {
        return language.split(&apos;;&apos;)[0];
      }
    }

    return null;
  }

  /**
   * Called before a next page is triggered allowing the components
   * to perform special functions.
   *
   * @return {*}
   */
  beforeNext() {
    return Promise.resolve(true);
  }

  /**
   * Called before a submission is triggered allowing the components
   * to perform special async functions.
   *
   * @return {*}
   */
  beforeSubmit() {
    return Promise.resolve(true);
  }

  /**
   * Return the submission timezone.
   *
   * @return {*}
   */
  get submissionTimezone() {
    this.options.submissionTimezone = this.options.submissionTimezone || _.get(this.root, &apos;options.submissionTimezone&apos;);
    return this.options.submissionTimezone;
  }

  get shouldDisable() {
    return (this.options.readOnly || this.component.disabled) &amp;&amp; !this.component.alwaysEnabled;
  }

  /**
   * Builds the component.
   */
  build(state) {
    state = state || {};
    this.calculatedValue = state.calculatedValue;
    if (this.viewOnly) {
      this.viewOnlyBuild();
    }
    else {
      this.createElement();

      const labelAtTheBottom = this.component.labelPosition === &apos;bottom&apos;;
      if (!labelAtTheBottom) {
        this.createLabel(this.element);
      }
      if (!this.createWrapper()) {
        this.createInput(this.element);
      }
      if (labelAtTheBottom) {
        this.createLabel(this.element);
      }
      this.createDescription(this.element);

      // Disable if needed.
      if (this.shouldDisable) {
        this.disabled = true;
      }

      // Restore the value.
      this.restoreValue();

      // Attach the refresh on events.
      this.attachRefreshOn();

      this.autofocus();
    }

    this.attachLogic();
  }

  attachRefreshEvent(refreshData) {
    this.on(&apos;change&apos;, (event) =&gt; {
      if (refreshData === &apos;data&apos;) {
        this.refresh(this.data);
      }
      else if (
        event.changed &amp;&amp;
        event.changed.component &amp;&amp;
        (event.changed.component.key === refreshData) &amp;
        // Make sure the changed component is not in a different &quot;context&quot;. Solves issues where refreshOn being set
        // in fields inside EditGrids could alter their state from other rows (which is bad).
        this.inContext(event.changed.instance)
      ) {
        this.refresh(event.changed.value);
      }
    }, true);
  }

  attachRefreshOn() {
    // If they wish to refresh on a value, then add that here.
    if (this.component.refreshOn) {
      if (Array.isArray(this.component.refreshOn)) {
        this.component.refreshOn.forEach(refreshData =&gt; {
          this.attachRefreshEvent(refreshData);
        });
      }
      else {
        this.attachRefreshEvent(this.component.refreshOn);
      }
    }
  }

  get viewOnly() {
    return this.options.readOnly &amp;&amp; this.options.viewAsHtml;
  }

  viewOnlyBuild() {
    this.createViewOnlyElement();
    this.createViewOnlyLabel(this.element);
    this.createViewOnlyValue(this.element);
  }

  createViewOnlyElement() {
    this.element = this.ce(&apos;dl&apos;, {
      id: this.id
    });

    if (this.element) {
      // Ensure you can get the component info from the element.
      this.element.component = this;
    }

    return this.element;
  }

  createViewOnlyLabel(container) {
    if (this.labelIsHidden()) {
      return;
    }

    this.labelElement = this.ce(&apos;dt&apos;);
    this.labelElement.appendChild(this.text(this.component.label));
    this.createTooltip(this.labelElement);
    container.appendChild(this.labelElement);
  }

  createViewOnlyValue(container) {
    this.valueElement = this.ce(&apos;dd&apos;);
    this.setupValueElement(this.valueElement);
    container.appendChild(this.valueElement);
  }

  setupValueElement(element) {
    let value = this.getValue();
    value = this.isEmpty(value) ? this.defaultViewOnlyValue : this.getView(value);
    element.innerHTML = value;
  }

  get defaultViewOnlyValue() {
    return &apos;-&apos;;
  }

  getView(value) {
    if (!value) {
      return &apos;&apos;;
    }
    const widget = this.widget;
    if (widget &amp;&amp; widget.getView) {
      return widget.getView(value);
    }
    if (Array.isArray(value)) {
      return value.join(&apos;, &apos;);
    }
    return value.toString();
  }

  updateItems(...args) {
    this.restoreValue();
    this.onChange(...args);
  }

  updateViewOnlyValue() {
    if (!this.valueElement) {
      return;
    }

    this.setupValueElement(this.valueElement);
  }

  createModal() {
    const modalBody = this.ce(&apos;div&apos;);
    const modalOverlay = this.ce(&apos;div&apos;, {
      class: &apos;formio-dialog-overlay&apos;
    });
    const closeDialog = this.ce(&apos;button&apos;, {
      class: &apos;formio-dialog-close pull-right btn btn-default btn-xs&apos;,
      &apos;aria-label&apos;: &apos;close&apos;
    });

    const dialog = this.ce(&apos;div&apos;, {
      class: &apos;formio-dialog formio-dialog-theme-default component-settings&apos;
    }, [
      modalOverlay,
      this.ce(&apos;div&apos;, {
        class: &apos;formio-dialog-content&apos;
      }, [
        modalBody,
        closeDialog
      ])
    ]);

    this.addEventListener(modalOverlay, &apos;click&apos;, (event) =&gt; {
      event.preventDefault();
      dialog.close();
    });
    this.addEventListener(closeDialog, &apos;click&apos;, (event) =&gt; {
      event.preventDefault();
      dialog.close();
    });
    this.addEventListener(dialog, &apos;close&apos;, () =&gt; {
      this.removeChildFrom(dialog, document.body);
    });
    document.body.appendChild(dialog);
    dialog.body = modalBody;
    dialog.close = () =&gt; {
      dialog.dispatchEvent(new CustomEvent(&apos;close&apos;));
      this.removeChildFrom(dialog, document.body);
    };
    return dialog;
  }

  /**
   * Retrieves the CSS class name of this component.
   * @returns {string} - The class name of this component.
   */
  get className() {
    let className = this.hasInput ? &apos;form-group has-feedback &apos; : &apos;&apos;;
    className += `formio-component formio-component-${this.component.type} `;
    if (this.key) {
      className += `formio-component-${this.key} `;
    }
    if (this.component.multiple) {
      className += &apos;formio-component-multiple &apos;;
    }
    if (this.component.customClass) {
      className += this.component.customClass;
    }
    if (this.hasInput &amp;&amp; this.component.validate &amp;&amp; this.component.validate.required) {
      className += &apos; required&apos;;
    }
    return className;
  }

  /**
   * Build the custom style from the layout values
   * @return {string} - The custom style
   */
  get customStyle() {
    let customCSS = &apos;&apos;;
    _.each(this.component.style, (value, key) =&gt; {
      if (value !== &apos;&apos;) {
        customCSS += `${key}:${value};`;
      }
    });
    return customCSS;
  }

  /**
   * Returns the outside wrapping element of this component.
   * @returns {HTMLElement}
   */
  getElement() {
    return this.element;
  }

  /**
   * Create the outside wrapping element for this component.
   * @returns {HTMLElement}
   */
  createElement() {
    // If the element is already created, don&apos;t recreate.
    if (this.element) {
      //update class for case when Logic changed container class (customClass)
      this.element.className = this.className;
      return this.element;
    }

    this.element = this.ce(&apos;div&apos;, {
      id: this.id,
      class: this.className,
      style: this.customStyle
    });

    // Ensure you can get the component info from the element.
    this.element.component = this;

    this.hook(&apos;element&apos;, this.element);
    return this.element;
  }

  /**
   * Create the input wrapping element. For multiple, this may be the table wrapper for the elements.
   * @returns {boolean}
   */
  createWrapper() {
    if (!this.component.multiple) {
      return false;
    }
    else {
      const table = this.ce(&apos;table&apos;, {
        class: &apos;table table-bordered&apos;
      });
      this.tbody = this.ce(&apos;tbody&apos;);
      table.appendChild(this.tbody);

      // Add a default value.
      const dataValue = this.dataValue;
      if (!dataValue || !dataValue.length) {
        this.addNewValue(this.defaultValue);
      }

      // Build the rows.
      this.buildRows();

      this.setInputStyles(table);

      // Add the table to the element.
      this.append(table);
      return true;
    }
  }

  evalContext(additional) {
    return super.evalContext(Object.assign({
      instance: this,
      component: this.component,
      row: this.data,
      value: ((this.key &amp;&amp; this.hasValue()) ? this.dataValue : this.emptyValue),
      rowIndex: this.rowIndex,
      data: this.rootValue,
      submission: (this.root ? this.root._submission : {}),
      form: this.root ? this.root._form : {}
    }, additional));
  }

  get defaultValue() {
    let defaultValue = this.emptyValue;
    if (this.component.defaultValue) {
      defaultValue = this.component.defaultValue;
    }
    if (this.component.customDefaultValue &amp;&amp; !this.options.preview) {
      defaultValue = this.evaluate(
        this.component.customDefaultValue,
        { value: &apos;&apos; },
        &apos;value&apos;
      );
    }

    if (this._inputMask) {
      defaultValue = conformToMask(defaultValue, this._inputMask).conformedValue;
      if (!FormioUtils.matchInputMask(defaultValue, this._inputMask)) {
        defaultValue = &apos;&apos;;
      }
    }

    // Let the widget provide default value if none is already provided.
    if (!defaultValue) {
      const widget = this.widget;
      if (widget) {
        defaultValue = widget.defaultValue;
      }
    }

    // Clone so that it creates a new instance.
    return _.clone(defaultValue);
  }

  /**
   * Sets the pristine flag for this component.
   *
   * @param pristine {boolean} - TRUE to make pristine, FALSE not pristine.
   */
  setPristine(pristine) {
    this.pristine = pristine;
  }

  /**
   * Adds a new empty value to the data array.
   */
  addNewValue(value) {
    if (value === undefined) {
      value = this.emptyValue;
    }
    let dataValue = this.dataValue || [];
    if (!Array.isArray(dataValue)) {
      dataValue = [dataValue];
    }

    if (Array.isArray(value)) {
      dataValue = dataValue.concat(value);
    }
    else {
      dataValue.push(value);
    }
    this.dataValue = dataValue;
  }

  /**
   * Adds a new empty value to the data array, and add a new row to contain it.
   */
  addValue() {
    this.addNewValue();
    this.buildRows();
    this.checkConditions();
    this.restoreValue();
    if (this.root) {
      this.root.onChange();
    }
  }

  /**
   * Removes a value out of the data array and rebuild the rows.
   * @param {number} index - The index of the data element to remove.
   */
  removeValue(index) {
    this.splice(index);
    this.buildRows();
    this.restoreValue();
    if (this.root) {
      this.root.onChange();
    }
  }

  /**
   * Rebuild the rows to contain the values of this component.
   */
  buildRows(values) {
    if (!this.tbody) {
      return;
    }
    const allowReorder = this.allowReorder;
    this.inputs = [];
    this.tbody.innerHTML = &apos;&apos;;
    values = (values &amp;&amp; values.length &gt; 0) ? values : this.dataValue;
    _.each(values, (value, index) =&gt; {
      const tr = this.ce(&apos;tr&apos;);
      if (allowReorder) {
        tr.appendChild(this.ce(&apos;td&apos;, {
          class: &apos;formio-drag-column&apos;
        }, this.dragButton()));
      }
      const td = this.ce(&apos;td&apos;);
      this.buildInput(td, value, index);
      tr.appendChild(td);

      if (!this.shouldDisable) {
        const tdAdd = this.ce(&apos;td&apos;, {
          class: &apos;formio-remove-column&apos;
        });
        tdAdd.appendChild(this.removeButton(index));
        tr.appendChild(tdAdd);
      }

      if (allowReorder) {
        tr.dragInfo = {
          index: index
        };
      }
      this.tbody.appendChild(tr);
    });

    if (!this.shouldDisable) {
      const tr = this.ce(&apos;tr&apos;);
      const td = this.ce(&apos;td&apos;, {
        colspan: allowReorder ? &apos;3&apos; : &apos;2&apos;
      });
      td.appendChild(this.addButton());
      tr.appendChild(td);
      this.tbody.appendChild(tr);
    }

    if (this.shouldDisable) {
      this.disabled = true;
    }

    if (allowReorder) {
      this.addDraggable([this.tbody]);
    }
  }

  get allowReorder() {
    return this.component.reorder &amp;&amp; !this.options.readOnly;
  }

  addDraggable(containers) {
    this.dragula = dragula(containers, this.getRowDragulaOptions()).on(&apos;drop&apos;, this.onRowDrop.bind(this));
  }

  getRowDragulaOptions() {
    return {
      moves: function(draggedElement, oldParent, clickedElement) {
        //allow dragging only on drag button (not the whole row)
        return clickedElement.classList.contains(&apos;formio-drag-button&apos;);
      }
    };
  }

  onRowDrop(droppedElement, newParent, oldParent, nextSibling) {
    //move them in data value as well
    if (!droppedElement.dragInfo || (nextSibling &amp;&amp; !nextSibling.dragInfo)) {
      console.warn(&apos;There is no Drag Info available for either dragged or sibling element&apos;);
      return;
    }
    const oldPosition = droppedElement.dragInfo.index;
    //should drop at next sibling position; no next sibling means drop to last position
    const newPosition = nextSibling ? nextSibling.dragInfo.index : this.dataValue.length;
    const movedBelow = newPosition &gt; oldPosition;
    const dataValue = _.cloneDeep(this.dataValue);
    const draggedRowData = dataValue[oldPosition];

    //insert element at new position
    dataValue.splice(newPosition, 0, draggedRowData);
    //remove element from old position (if was moved above, after insertion it&apos;s at +1 index)
    dataValue.splice(movedBelow ? oldPosition : oldPosition + 1, 1);
    //need to re-build rows to re-calculate indexes and other indexed fields for component instance (like rows for ex.)
    this.setValue(dataValue);
  }

  buildInput(container, value) {
    const input = this.createInput(container);
    input.value = value;
  }

  /**
   * Adds a new button to add new rows to the multiple input elements.
   * @returns {HTMLElement} - The &quot;Add New&quot; button html element.
   */
  addButton(justIcon) {
    const addButton = this.ce(&apos;button&apos;, {
      class: &apos;btn btn-primary formio-button-add-row&apos;
    });
    this.addEventListener(addButton, &apos;click&apos;, (event) =&gt; {
      event.preventDefault();
      this.addValue();
    });

    const addIcon = this.ce(&apos;i&apos;, {
      class: this.iconClass(&apos;plus&apos;)
    });

    if (justIcon) {
      addButton.appendChild(addIcon);
      return addButton;
    }
    else {
      addButton.appendChild(addIcon);
      addButton.appendChild(this.text(&apos; &apos;));
      addButton.appendChild(this.text(this.component.addAnother || &apos;Add Another&apos;));
      return addButton;
    }
  }

  /**
   * The readible name for this component.
   * @returns {string} - The name of the component.
   */
  get name() {
    return this.t(this.component.label || this.component.placeholder || this.key);
  }

  /**
   * Returns the error label for this component.
   * @return {*}
   */
  get errorLabel() {
    return this.t(this.component.errorLabel
      || this.component.label
      || this.component.placeholder
      || this.key);
  }

  /**
   * Get the error message provided a certain type of error.
   * @param type
   * @return {*}
   */
  errorMessage(type) {
    return (this.component.errors &amp;&amp; this.component.errors[type]) ? this.component.errors[type] :  type;
  }

  /**
   * Creates a new &quot;remove&quot; row button and returns the html element of that button.
   * @param {number} index - The index of the row that should be removed.
   * @returns {HTMLElement} - The html element of the remove button.
   */
  removeButton(index) {
    const removeButton = this.ce(&apos;button&apos;, {
      type: &apos;button&apos;,
      class: &apos;btn btn-default btn-secondary formio-button-remove-row&apos;
    });

    this.addEventListener(removeButton, &apos;click&apos;, (event) =&gt; {
      event.preventDefault();
      this.removeValue(index);
    });

    const removeIcon = this.ce(&apos;i&apos;, {
      class: this.iconClass(&apos;remove-circle&apos;)
    });
    removeButton.appendChild(removeIcon);
    return removeButton;
  }

  dragButton() {
    return this.ce(&apos;button&apos;, {
      class: `formio-drag-button btn btn-default btn-small ${this.iconClass(&apos;menu-hamburger&apos;)}`
    });
  }

  labelOnTheLeft(position) {
    return [
      &apos;left-left&apos;,
      &apos;left-right&apos;
    ].includes(position);
  }

  labelOnTheRight(position) {
    return [
      &apos;right-left&apos;,
      &apos;right-right&apos;
    ].includes(position);
  }

  rightAlignedLabel(position) {
    return [
      &apos;left-right&apos;,
      &apos;right-right&apos;
    ].includes(position);
  }

  labelOnTheLeftOrRight(position) {
    return this.labelOnTheLeft(position) || this.labelOnTheRight(position);
  }

  getLabelWidth() {
    if (!this.component.labelWidth) {
      this.component.labelWidth = 30;
    }

    return this.component.labelWidth;
  }

  getLabelMargin() {
    if (!this.component.labelMargin) {
      this.component.labelMargin = 3;
    }

    return this.component.labelMargin;
  }

  setInputStyles(input) {
    if (this.labelIsHidden()) {
      return;
    }

    if (this.labelOnTheLeftOrRight(this.component.labelPosition)) {
      const totalLabelWidth = this.getLabelWidth() + this.getLabelMargin();
      input.style.width = `${100 - totalLabelWidth}%`;

      if (this.labelOnTheLeft(this.component.labelPosition)) {
        input.style.marginLeft = `${totalLabelWidth}%`;
      }
      else {
        input.style.marginRight = `${totalLabelWidth}%`;
      }
    }
  }

  labelIsHidden() {
    return !this.component.label ||
      this.component.hideLabel ||
      this.options.inputsOnly ||
      (this.inDataGrid &amp;&amp; !this.component.dataGridLabel);
  }

  /**
   * Create the HTML element for the label of this component.
   * @param {HTMLElement} container - The containing element that will contain this label.
   */
  createLabel(container) {
    const isLabelHidden = this.labelIsHidden();
    let className = &apos;control-label&apos;;
    let style = &apos;&apos;;
    if (!isLabelHidden) {
      const {
        labelPosition
      } = this.component;

      // Determine label styles/classes depending on position.
      if (labelPosition === &apos;bottom&apos;) {
        className += &apos; control-label--bottom&apos;;
      }
      else if (labelPosition &amp;&amp; labelPosition !== &apos;top&apos;) {
        const labelWidth = this.getLabelWidth();
        const labelMargin = this.getLabelMargin();

        // Label is on the left or right.
        if (this.labelOnTheLeft(labelPosition)) {
          style += `float: left; width: ${labelWidth}%; margin-right: ${labelMargin}%; `;
        }
        else if (this.labelOnTheRight(labelPosition)) {
          style += `float: right; width: ${labelWidth}%; margin-left: ${labelMargin}%; `;
        }
        if (this.rightAlignedLabel(labelPosition)) {
          style += &apos;text-align: right; &apos;;
        }
      }
    }
    else {
      this.addClass(container, &apos;formio-component-label-hidden&apos;);
      className += &apos; control-label--hidden&apos;;
    }

    if (this.hasInput &amp;&amp; this.component.validate &amp;&amp; this.component.validate.required) {
      className += &apos; field-required&apos;;
    }
    this.labelElement = this.ce(&apos;label&apos;, {
      class: className,
      style
    });
    if (!isLabelHidden) {
      if (this.info.attr.id) {
        this.labelElement.setAttribute(&apos;for&apos;, this.info.attr.id);
      }
      this.labelElement.appendChild(this.text(this.component.label));
      this.createTooltip(this.labelElement);
    }
    container.appendChild(this.labelElement);
  }

  addShortcutToLabel(label, shortcut) {
    if (!label) {
      label = this.component.label;
    }

    if (!shortcut) {
      shortcut = this.component.shortcut;
    }

    if (!shortcut || !/^[A-Za-z]$/.test(shortcut)) {
      return label;
    }

    const match = label.match(new RegExp(shortcut, &apos;i&apos;));

    if (!match) {
      return label;
    }

    const index = match.index + 1;
    const lowLineCombinator = &apos;\u0332&apos;;

    return label.substring(0, index) + lowLineCombinator + label.substring(index);
  }

  addShortcut(element, shortcut) {
    // Avoid infinite recursion.
    if (this.root === this) {
      return;
    }

    if (!element) {
      element = this.labelElement;
    }

    if (!shortcut) {
      shortcut = this.component.shortcut;
    }

    this.root.addShortcut(element, shortcut);
  }

  removeShortcut(element, shortcut) {
    // Avoid infinite recursion.
    if (this.root === this) {
      return;
    }

    if (!element) {
      element = this.labelElement;
    }

    if (!shortcut) {
      shortcut = this.component.shortcut;
    }

    this.root.removeShortcut(element, shortcut);
  }

  /**
   * Create the HTML element for the tooltip of this component.
   * @param {HTMLElement} container - The containing element that will contain this tooltip.
   */
  createTooltip(container, component, classes) {
    if (this.tooltip) {
      return;
    }
    component = component || this.component;
    classes = classes || `${this.iconClass(&apos;question-sign&apos;)} text-muted`;
    if (!component.tooltip) {
      return;
    }
    const ttElement = this.ce(&apos;i&apos;, {
      class: classes
    });
    container.appendChild(this.text(&apos; &apos;));
    container.appendChild(ttElement);
    this.tooltip = new Tooltip(ttElement, {
      trigger: &apos;hover click&apos;,
      placement: &apos;right&apos;,
      html: true,
      title: this.interpolate(component.tooltip).replace(/(?:\r\n|\r|\n)/g, &apos;&lt;br /&gt;&apos;)
    });
  }

  /**
   * Creates the description block for this input field.
   * @param container
   */
  createDescription(container) {
    if (!this.component.description) {
      return;
    }
    this.description = this.ce(&apos;div&apos;, {
      class: &apos;help-block&apos;
    });
    this.description.innerHTML = this.t(this.component.description);
    container.appendChild(this.description);
  }

  /**
   * Creates a new error element to hold the errors of this element.
   */
  createErrorElement() {
    if (!this.errorContainer) {
      return;
    }
    this.errorElement = this.ce(&apos;div&apos;, {
      class: &apos;formio-errors invalid-feedback&apos;
    });
    this.errorContainer.appendChild(this.errorElement);
  }

  /**
   * Adds a prefix html element.
   *
   * @param {HTMLElement} input - The input element.
   * @param {HTMLElement} inputGroup - The group that will hold this prefix.
   * @returns {HTMLElement} - The html element for this prefix.
   */
  addPrefix(input, inputGroup) {
    let prefix = null;
    if (input.widget) {
      return input.widget.addPrefix(inputGroup);
    }
    if (this.component.prefix &amp;&amp; (typeof this.component.prefix === &apos;string&apos;)) {
      prefix = this.ce(&apos;div&apos;, {
        class: &apos;input-group-addon input-group-prepend&apos;
      });
      prefix.appendChild(this.ce(&apos;span&apos;, {
        class: &apos;input-group-text&apos;
      }, this.text(this.component.prefix)));
      inputGroup.appendChild(prefix);
    }
    return prefix;
  }

  /**
   * Adds a suffix html element.
   *
   * @param {HTMLElement} input - The input element.
   * @param {HTMLElement} inputGroup - The group that will hold this suffix.
   * @returns {HTMLElement} - The html element for this suffix.
   */
  addSuffix(input, inputGroup) {
    let suffix = null;
    if (input.widget) {
      return input.widget.addSuffix(inputGroup);
    }
    if (this.component.suffix &amp;&amp; (typeof this.component.suffix === &apos;string&apos;)) {
      suffix = this.ce(&apos;div&apos;, {
        class: &apos;input-group-addon input-group-append&apos;
      });
      suffix.appendChild(this.ce(&apos;span&apos;, {
        class: &apos;input-group-text&apos;
      }, this.text(this.component.suffix)));
      inputGroup.appendChild(suffix);
    }
    return suffix;
  }

  /**
   * Adds a new input group to hold the input html elements.
   *
   * @param {HTMLElement} input - The input html element.
   * @param {HTMLElement} container - The containing html element for this group.
   * @returns {HTMLElement} - The input group element.
   */
  addInputGroup(input, container) {
    let inputGroup = null;
    if (this.component.prefix || this.component.suffix) {
      inputGroup = this.ce(&apos;div&apos;, {
        class: &apos;input-group&apos;
      });
      container.appendChild(inputGroup);
    }
    return inputGroup;
  }

  // Default the mask to the component input mask.
  setInputMask(input, inputMask) {
    return super.setInputMask(input, (inputMask || this.component.inputMask), !this.component.placeholder);
  }

  /**
   * Creates a new input element.
   * @param {HTMLElement} container - The container which should hold this new input element.
   * @returns {HTMLElement} - Either the input or the group that contains the input.
   */
  createInput(container) {
    const input = this.ce(this.info.type, this.info.attr);
    this.setInputMask(input);
    input.widget = this.createWidget();
    const inputGroup = this.addInputGroup(input, container);
    this.addPrefix(input, inputGroup);
    this.addInput(input, inputGroup || container);
    this.addSuffix(input, inputGroup);
    this.errorContainer = container;
    this.setInputStyles(inputGroup || input);
    // Attach the input to the widget.
    if (input.widget) {
      input.widget.attach(input);
    }
    return inputGroup || input;
  }

  /**
   * Returns the instance of the widget for this component.
   *
   * @return {*}
   */
  get widget() {
    if (this._widget) {
      return this._widget;
    }
    return this.createWidget();
  }

  /**
   * Creates an instance of a widget for this component.
   *
   * @return {null}
   */
  createWidget() {
    // Return null if no widget is found.
    if (!this.component.widget) {
      return null;
    }

    // Get the widget settings.
    const settings = (typeof this.component.widget === &apos;string&apos;) ? {
      type: this.component.widget
    } : this.component.widget;

    // Make sure we have a widget.
    if (!Widgets.hasOwnProperty(settings.type)) {
      return null;
    }

    // Pass along some options.
    settings.icons = this.options.icons;
    settings.i18n = this.options.i18n;
    settings.language = this.options.language;

    // Create the widget.
    const widget = new Widgets[settings.type](settings, this.component);
    widget.on(&apos;update&apos;, () =&gt; this.updateValue(), true);
    widget.on(&apos;redraw&apos;, () =&gt; this.redraw(), true);
    this._widget = widget;
    return widget;
  }

  redraw() {
    // Don&apos;t bother if we have not built yet.
    if (!this.isBuilt) {
      return;
    }
    this.build(this.clear());
  }

  destroyInputs() {
    _.each(this.inputs, (input) =&gt; {
      input = this.performInputMapping(input);
      if (input.mask &amp;&amp; input.mask.destroy) {
        input.mask.destroy();
      }
      if (input.widget) {
        input.widget.destroy();
      }
    });
    if (this.tooltip) {
      this.tooltip.dispose();
      this.tooltip = null;
    }
    this.inputs = [];
  }

  /**
   * Remove all event handlers.
   */
  destroy() {
    const state = super.destroy() || {};
    this.destroyInputs();
    state.calculatedValue = this.calculatedValue;
    return state;
  }

  /**
   * Render a template string into html.
   *
   * @param template
   * @param data
   * @param actions
   *
   * @return {HTMLElement} - The created element.
   */
  renderTemplate(template, data, actions = []) {
    return this.renderTemplateToElement(this.ce(&apos;div&apos;), template, data, actions);
  }

  renderElement(template, data, actions = []) {
    return this.renderTemplate(template, data, actions).firstChild;
  }

  renderTemplateToElement(element, template, data, actions = []) {
    element.innerHTML = this.interpolate(template, data).trim();
    this.attachActions(element, actions);
    return element;
  }

  attachActions(element, actions) {
    actions.forEach((action) =&gt; {
      const elements = element.getElementsByClassName(action.class);
      Array.prototype.forEach.call(elements, (element) =&gt; {
        element.addEventListener(action.event, action.action);
      });
    });
  }

  /**
   * Determines if this component has a condition defined.
   *
   * @return {null}
   */
  hasCondition() {
    if (this._hasCondition !== null) {
      return this._hasCondition;
    }

    this._hasCondition = FormioUtils.hasCondition(this.component);
    return this._hasCondition;
  }

  /**
   * Check if this component is conditionally visible.
   *
   * @param data
   * @return {boolean}
   */
  conditionallyVisible(data) {
    data = data || this.rootValue;
    if (this.options.builder || !this.hasCondition()) {
      return true;
    }
    return this.checkCondition(null, data);
  }

  /**
   * Checks the condition of this component.
   *
   * @param row - The row contextual data.
   * @param data - The global data object.
   *
   * @return {boolean} - True if the condition applies to this component.
   */
  checkCondition(row, data) {
    return FormioUtils.checkCondition(
      this.component,
      row || this.data,
      data || this.rootValue,
      this.root ? this.root._form : {},
      this
    );
  }

  /**
   * Check for conditionals and hide/show the element based on those conditions.
   */
  checkConditions(data) {
    data = data || this.rootValue;

    // Check advanced conditions
    const result = this.show(this.conditionallyVisible(data));
    if (!this.options.builder &amp;&amp; this.fieldLogic(data)) {
      this.redraw();
    }

    return result;
  }

  get logic() {
    return this.component.logic || [];
  }

  /**
   * Check all triggers and apply necessary actions.
   *
   * @param data
   */
  fieldLogic(data) {
    data = data || this.rootValue;
    const logics = this.logic;

    // If there aren&apos;t logic, don&apos;t go further.
    if (logics.length === 0) {
      return;
    }

    const newComponent = _.cloneDeep(this.originalComponent);

    let changed = logics.reduce((changed, logic) =&gt; {
      const result = FormioUtils.checkTrigger(
        newComponent,
        logic.trigger,
        this.data,
        data,
        this.root ? this.root._form : {},
        this
      );

      if (result) {
        changed |= this.applyActions(logic.actions, result, data, newComponent);
      }
      return changed;
    }, false);

    // If component definition changed, replace and mark as changed.
    if (!_.isEqual(this.component, newComponent)) {
      this.component = newComponent;
      changed = true;
    }

    return changed;
  }

  applyActions(actions, result, data, newComponent) {
    return actions.reduce((changed, action) =&gt; {
      switch (action.type) {
        case &apos;property&apos;:
          FormioUtils.setActionProperty(newComponent, action, this.data, data, newComponent, result, this);
          break;
        case &apos;value&apos;: {
          const oldValue = this.getValue();
          const newValue = this.evaluate(
            action.value,
            {
              value: _.clone(oldValue),
              data,
              component: newComponent,
              result
            },
            &apos;value&apos;
          );
          if (!_.isEqual(oldValue, newValue)) {
            this.setValue(newValue);
            changed = true;
          }
          break;
        }
        case &apos;validation&apos;:
          // TODO
          break;
      }
      return changed;
    }, false);
  }

  /**
   * Add a new input error to this element.
   *
   * @param message
   * @param dirty
   */
  addInputError(message, dirty) {
    if (!message) {
      return;
    }

    if (this.errorElement) {
      const errorMessage = this.ce(&apos;p&apos;, {
        class: &apos;help-block&apos;
      });
      errorMessage.appendChild(this.text(message));
      this.errorElement.appendChild(errorMessage);
    }

    // Add error classes
    this.addClass(this.element, &apos;has-error&apos;);
    this.inputs.forEach((input) =&gt; this.addClass(this.performInputMapping(input), &apos;is-invalid&apos;));
    if (dirty &amp;&amp; this.options.highlightErrors) {
      this.addClass(this.element, &apos;alert alert-danger&apos;);
    }
  }

  /**
   * Checks to see if a separate component is in the &quot;context&quot; of this component. This is determined by first checking
   * if they share the same &quot;data&quot; object. It will then walk up the parent tree and compare its parents data objects
   * with the components data and returns true if they are in the same context.
   *
   * Different rows of the same EditGrid, for example, are in different contexts.
   *
   * @param component
   */
  inContext(component) {
    if (component.data === this.data) {
      return true;
    }
    let parent = this.parent;
    while (parent) {
      if (parent.data === component.data) {
        return true;
      }
      parent = parent.parent;
    }

    return false;
  }

  /**
   * Hide or Show an element.
   *
   * @param show
   */
  show(show, noClear) {
    if (
      !this.options.builder &amp;&amp;
      this.options.hide &amp;&amp;
      this.options.hide[this.component.key]
    ) {
      show = false;
    }
    else if (
      this.options.builder ||
      (this.options.show &amp;&amp; this.options.show[this.component.key])
    ) {
      show = true;
    }

    // Execute only if visibility changes or if we are in builder mode or if hidden fields should be shown.
    if (!show === !this._visible || this.options.builder || this.options.showHiddenFields) {
      if (!show) {
        this.clearOnHide(false);
      }
      return show;
    }

    this.visible = show;
    this.showElement(show &amp;&amp; !this.component.hidden);
    if (!noClear) {
      this.clearOnHide(show);
    }
    return show;
  }

  /**
   * Show or hide the root element of this component.
   *
   * @param element
   * @param show
   */
  showElement(element, show) {
    if (typeof element === &apos;boolean&apos;) {
      show = element;
      element = this.getElement();
    }

    if (element) {
      if (show) {
        element.removeAttribute(&apos;hidden&apos;);
        element.style.visibility = &apos;visible&apos;;
        element.style.position = &apos;relative&apos;;
      }
      else if (
        this.parent &amp;&amp;
        this.parent.parent &amp;&amp;
        (this.parent.parent.component.type === &apos;columns&apos;) &amp;&amp;
        this.parent.parent.component.autoAdjust
      ) {
        element.style.visibility = &apos;hidden&apos;;
        element.style.position = &apos;relative&apos;;
      }
      else {
        element.setAttribute(&apos;hidden&apos;, true);
        element.style.visibility = &apos;hidden&apos;;
        element.style.position = &apos;absolute&apos;;
      }
    }
    return show;
  }

  clearOnHide(show) {
    // clearOnHide defaults to true for old forms (without the value set) so only trigger if the value is false.
    if (this.component.clearOnHide !== false &amp;&amp; !this.options.readOnly) {
      if (!show) {
        this.deleteValue();
      }
      else if (!this.hasValue()) {
        // If shown, ensure the default is set.
        this.setValue(this.defaultValue, {
          noUpdateEvent: true
        });
      }
    }
  }

  set visible(visible) {
    this._visible = visible;
  }

  get visible() {
    return this._visible &amp;&amp; this._parentVisible;
  }

  set parentVisible(value) {
    if (this._parentVisible !== value) {
      this._parentVisible = value;
    }
  }

  get parentVisible() {
    return this._parentVisible;
  }

  onChange(flags, fromRoot) {
    flags = flags || {};
    if (!flags.noValidate) {
      this.pristine = false;
    }

    if (flags.modified) {
      // Add a modified class if this element was manually modified.
      this.addClass(this.getElement(), &apos;formio-modified&apos;);
    }

    // If we are supposed to validate on blur, then don&apos;t trigger validation yet.
    if (this.component.validateOn === &apos;blur&apos; &amp;&amp; !this.errors.length) {
      flags.noValidate = true;
    }

    if (this.component.onChange) {
      this.evaluate(this.component.onChange);
    }

    // Set the changed variable.
    const changed = {
      instance: this,
      component: this.component,
      value: this.dataValue,
      flags: flags
    };

    // Emit the change.
    this.emit(&apos;componentChange&apos;, changed);

    // Bubble this change up to the top.
    if (this.root &amp;&amp; !fromRoot) {
      this.root.triggerChange(flags, changed);
    }
  }

  addInputSubmitListener(input) {
    if (!this.options.submitOnEnter) {
      return;
    }
    this.addEventListener(input, &apos;keypress&apos;, (event) =&gt; {
      const key = event.keyCode || event.which;
      if (key === 13) {
        event.preventDefault();
        event.stopPropagation();
        this.emit(&apos;submitButton&apos;);
      }
    });
  }

  /**
   * Add new input element listeners.
   *
   * @param input
   */
  addInputEventListener(input) {
    this.addEventListener(input, this.info.changeEvent, () =&gt; this.updateValue({
      modified: true
    }));
  }

  /**
   * Add a new input to this comonent.
   *
   * @param input
   * @param container
   * @param noSet
   */
  addInput(input, container) {
    if (!input) {
      return;
    }
    if (input &amp;&amp; container) {
      input = container.appendChild(input);
    }

    this.inputs.push(input);
    this.hook(&apos;input&apos;, input, container);
    this.addFocusBlurEvents(input);
    this.addInputEventListener(input);
    this.addInputSubmitListener(input);
    return input;
  }

  addFocusBlurEvents(element) {
    this.addEventListener(element, &apos;focus&apos;, () =&gt; {
      if (this.root.focusedComponent !== this) {
        if (this.root.pendingBlur) {
          this.root.pendingBlur();
        }

        this.root.focusedComponent = this;

        this.emit(&apos;focus&apos;, this);
      }
      else if (this.root.focusedComponent === this &amp;&amp; this.root.pendingBlur) {
        this.root.pendingBlur.cancel();
        this.root.pendingBlur = null;
      }
    });
    this.addEventListener(element, &apos;blur&apos;, () =&gt; {
      this.root.pendingBlur = FormioUtils.delay(() =&gt; {
        this.emit(&apos;blur&apos;, this);
        if (this.component.validateOn === &apos;blur&apos;) {
          this.root.triggerChange({}, {
            instance: this,
            component: this.component,
            value: this.dataValue,
            flags: {}
          });
        }
        this.root.focusedComponent = null;
        this.root.pendingBlur = null;
      });
    });
  }

  get wysiwygDefault() {
    return {
      theme: &apos;snow&apos;,
      placeholder: this.t(this.component.placeholder),
      modules: {
        clipboard: {
          matchVisual: false
        },
        toolbar: [
          [{ &apos;size&apos;: [&apos;small&apos;, false, &apos;large&apos;, &apos;huge&apos;] }],  // custom dropdown
          [{ &apos;header&apos;: [1, 2, 3, 4, 5, 6, false] }],
          [{ &apos;font&apos;: [] }],
          [&apos;bold&apos;, &apos;italic&apos;, &apos;underline&apos;, &apos;strike&apos;, { &apos;script&apos;: &apos;sub&apos; }, { &apos;script&apos;: &apos;super&apos; }, &apos;clean&apos;],
          [{ &apos;color&apos;: [] }, { &apos;background&apos;: [] }],
          [{ &apos;list&apos;: &apos;ordered&apos; }, { &apos;list&apos;: &apos;bullet&apos; }, { &apos;indent&apos;: &apos;-1&apos; }, { &apos;indent&apos;: &apos;+1&apos; }, { &apos;align&apos;: [] }],
          [&apos;blockquote&apos;, &apos;code-block&apos;],
          [&apos;link&apos;, &apos;image&apos;, &apos;video&apos;, &apos;formula&apos;, &apos;source&apos;]
        ]
      }
    };
  }

  addCKE(element, settings, onChange) {
    settings = _.isEmpty(settings) ? null : settings;
    return Formio.requireLibrary(&apos;ckeditor&apos;, &apos;ClassicEditor&apos;, CKEDITOR, true)
      .then(() =&gt; {
        if (!element.parentNode) {
          return Promise.reject();
        }
        return ClassicEditor.create(element, settings).then(editor =&gt; {
          editor.model.document.on(&apos;change&apos;, () =&gt; onChange(editor.data.get()));
          return editor;
        });
      });
  }

  addQuill(element, settings, onChange) {
    settings = _.isEmpty(settings) ? this.wysiwygDefault : settings;

    // Lazy load the quill css.
    Formio.requireLibrary(`quill-css-${settings.theme}`, &apos;Quill&apos;, [
      { type: &apos;styles&apos;, src: `https://cdn.quilljs.com/1.3.6/quill.${settings.theme}.css` }
    ], true);

    // Lazy load the quill library.
    return Formio.requireLibrary(&apos;quill&apos;, &apos;Quill&apos;, &apos;https://cdn.quilljs.com/1.3.6/quill.min.js&apos;, true)
      .then(() =&gt; {
        if (!element.parentNode) {
          return Promise.reject();
        }
        this.quill = new Quill(element, settings);

        /** This block of code adds the [source] capabilities.  See https://codepen.io/anon/pen/ZyEjrQ **/
        const txtArea = document.createElement(&apos;textarea&apos;);
        txtArea.setAttribute(&apos;class&apos;, &apos;quill-source-code&apos;);
        this.quill.addContainer(&apos;ql-custom&apos;).appendChild(txtArea);
        const qlSource = element.parentNode.querySelector(&apos;.ql-source&apos;);
        if (qlSource) {
          this.addEventListener(qlSource, &apos;click&apos;, (event) =&gt; {
            event.preventDefault();
            if (txtArea.style.display === &apos;inherit&apos;) {
              this.quill.setContents(this.quill.clipboard.convert(txtArea.value));
            }
            txtArea.style.display = (txtArea.style.display === &apos;none&apos;) ? &apos;inherit&apos; : &apos;none&apos;;
          });
        }
        /** END CODEBLOCK **/

        // Make sure to select cursor when they click on the element.
        this.addEventListener(element, &apos;click&apos;, () =&gt; this.quill.focus());

        // Allows users to skip toolbar items when tabbing though form
        const elm = document.querySelectorAll(&apos;.ql-formats &gt; button&apos;);
        for (let i = 0; i &lt; elm.length; i++) {
          elm[i].setAttribute(&apos;tabindex&apos;, &apos;-1&apos;);
        }

        this.quill.on(&apos;text-change&apos;, () =&gt; {
          txtArea.value = this.quill.root.innerHTML;
          onChange(txtArea);
        });

        return this.quill;
      });
  }

  /**
   * The empty value for this component.
   *
   * @return {null}
   */
  get emptyValue() {
    return null;
  }

  /**
   * Returns if this component has a value set.
   *
   */
  hasValue(data) {
    return _.has(data || this.data, this.key);
  }

  /**
   * Get the value of this component.
   *
   * @return {*}
   */
  get value() {
    return this.dataValue;
  }

  /**
   * Get the data value at the root level.
   *
   * @return {*}
   */
  get rootValue() {
    return this.root ? this.root.data : this.data;
  }

  /**
   * Get the static value of this component.
   * @return {*}
   */
  get dataValue() {
    if (!this.key) {
      return this.emptyValue;
    }
    if (!this.hasValue()) {
      this.dataValue = this.component.multiple ? [] : this.emptyValue;
    }
    return _.get(this.data, this.key);
  }

  /**
   * Sets the static value of this component.
   *
   * @param value
   */
  set dataValue(value) {
    if (!this.key) {
      return value;
    }
    if ((value === null) || (value === undefined)) {
      _.unset(this.data, this.key);
      return value;
    }
    _.set(this.data, this.key, value);
    return value;
  }

  /**
   * Splice a value from the dataValue.
   *
   * @param index
   */
  splice(index) {
    if (this.hasValue()) {
      const dataValue = this.dataValue || [];
      if (_.isArray(dataValue) &amp;&amp; dataValue.hasOwnProperty(index)) {
        dataValue.splice(index, 1);
        this.dataValue = dataValue;
        this.triggerChange();
      }
    }
  }

  /**
   * Deletes the value of the component.
   */
  deleteValue() {
    this.setValue(null, {
      noUpdateEvent: true,
      noDefault: true
    });
    _.unset(this.data, this.key);
  }

  /**
   * Get the value at a specific index.
   *
   * @param index
   * @returns {*}
   */
  getValueAt(index) {
    const input = this.performInputMapping(this.inputs[index]);
    if (input.widget) {
      return input.widget.getValue();
    }
    return input ? input.value : undefined;
  }

  /**
   * Get the input value of this component.
   *
   * @return {*}
   */
  getValue() {
    if (!this.hasInput) {
      return;
    }
    if (this.viewOnly) {
      return this.dataValue;
    }
    const values = [];
    for (const i in this.inputs) {
      if (this.inputs.hasOwnProperty(i)) {
        if (!this.component.multiple) {
          return this.getValueAt(i);
        }
        values.push(this.getValueAt(i));
      }
    }
    return values;
  }

  /**
   * Determine if the value of this component has changed.
   *
   * @param before
   * @param after
   * @return {boolean}
   */
  hasChanged(before, after) {
    if (
      ((before === undefined) || (before === null)) &amp;&amp;
      ((after === undefined) || (after === null))
    ) {
      return false;
    }
    return !_.isEqual(before, after);
  }

  /**
   * Update the value on change.
   *
   * @param flags
   * @param changed
   */
  updateOnChange(flags, changed) {
    if (!flags.noUpdateEvent &amp;&amp; changed) {
      this.triggerChange(flags);
      return true;
    }
    return false;
  }

  /**
   * Update a value of this component.
   *
   * @param flags
   */
  updateValue(flags, value) {
    if (!this.hasInput) {
      return false;
    }

    flags = flags || {};
    let newValue = value;
    if (!this.visible &amp;&amp; this.component.clearOnHide) {
      newValue = this.dataValue;
    }
    else if (value === undefined || value === null) {
      newValue = this.getValue(flags);
    }
    const changed = (newValue !== undefined) ? this.hasChanged(newValue, this.dataValue) : false;
    this.dataValue = newValue;
    if (this.viewOnly) {
      this.updateViewOnlyValue(newValue);
    }

    this.updateOnChange(flags, changed);
    return changed;
  }

  get hasSetValue() {
    return this.hasValue() &amp;&amp; !this.isEmpty(this.dataValue);
  }

  /**
   * Restore the value of a control.
   */
  restoreValue() {
    if (this.hasSetValue) {
      this.setValue(this.dataValue, {
        noUpdateEvent: true
      });
    }
    else {
      const defaultValue = this.defaultValue;
      if (!_.isNil(defaultValue)) {
        this.setValue(defaultValue, {
          noUpdateEvent: true
        });
      }
    }
  }

  /**
   * Perform a calculated value operation.
   *
   * @param data - The global data object.
   *
   * @return {boolean} - If the value changed during calculation.
   */
  calculateValue(data, flags) {
    // If no calculated value or
    // hidden and set to clearOnHide (Don&apos;t calculate a value for a hidden field set to clear when hidden)
    if (!this.component.calculateValue || ((!this.visible || this.component.hidden) &amp;&amp; this.component.clearOnHide)) {
      return false;
    }

    // Get the dataValue.
    let firstPass = false;
    let dataValue = null;
    const allowOverride = this.component.allowCalculateOverride;
    if (allowOverride) {
      dataValue = this.dataValue;
    }

    // First pass, the calculatedValue is undefined.
    if (this.calculatedValue === undefined) {
      firstPass = true;
      this.calculatedValue = null;
    }

    // Check to ensure that the calculated value is different than the previously calculated value.
    if (
      allowOverride &amp;&amp;
      (this.calculatedValue !== null) &amp;&amp;
      !_.isEqual(dataValue, this.calculatedValue)
    ) {
      return false;
    }

    // Calculate the new value.
    const calculatedValue = this.evaluate(this.component.calculateValue, {
      value: this.defaultValue,
      data
    }, &apos;value&apos;);

    // If this is the firstPass, and the dataValue is different than to the calculatedValue.
    if (
      allowOverride &amp;&amp;
      firstPass &amp;&amp;
      !this.isEmpty(dataValue) &amp;&amp;
      !_.isEqual(dataValue, calculatedValue)
    ) {
      // Return that we have a change so it will perform another pass.
      this.calculatedValue = calculatedValue;
      return true;
    }

    flags = flags || {};
    flags.noCheck = true;
    const changed = this.setValue(calculatedValue, flags);
    this.calculatedValue = this.dataValue;
    return changed;
  }

  /**
   * Get this component&apos;s label text.
   *
   */
  get label() {
    return this.component.label;
  }

  /**
   * Set this component&apos;s label text and render it.
   *
   * @param value - The new label text.
   */
  set label(value) {
    this.component.label = value;
    if (this.labelElement) {
      this.labelElement.innerText = value;
    }
  }

  /**
   * Get FormioForm element at the root of this component tree.
   *
   */
  getRoot() {
    return this.root;
  }

  /**
   * Returns the invalid message, or empty string if the component is valid.
   *
   * @param data
   * @param dirty
   * @return {*}
   */
  invalidMessage(data, dirty, ignoreCondition) {
    // Force valid if component is conditionally hidden.
    if (!ignoreCondition &amp;&amp; !this.checkCondition(null, data)) {
      return &apos;&apos;;
    }

    // See if this is forced invalid.
    if (this.invalid) {
      return this.invalid;
    }

    // No need to check for errors if there is no input or if it is pristine.
    if (!this.hasInput || (!dirty &amp;&amp; this.pristine)) {
      return &apos;&apos;;
    }

    return Validator.check(this, data);
  }

  /**
   * Returns if the component is valid or not.
   *
   * @param data
   * @param dirty
   * @return {boolean}
   */
  isValid(data, dirty) {
    return !this.invalidMessage(data, dirty);
  }

  checkValidity(data, dirty, rowData) {
    if (this.shouldSkipValidation(data, dirty, rowData)) {
      this.setCustomValidity(&apos;&apos;);
      return true;
    }

    const message = this.invalidMessage(data, dirty, true);
    this.setCustomValidity(message, dirty);
    return message ? false : true;
  }

  /* eslint-disable max-len */
  getRawValue() {
    console.warn(&apos;component.getRawValue() has been deprecated. Use component.validationValue or component.dataValue instead.&apos;);
    return this.validationValue;
  }
  /* eslint-enable max-len */

  get validationValue() {
    // Let widgets have the first attempt.
    const widget = this.widget;
    if (widget &amp;&amp; widget.validationValue) {
      return widget.validationValue(this.dataValue);
    }
    return this.dataValue;
  }

  isEmpty(value) {
    return value == null || value.length === 0 || _.isEqual(value, this.emptyValue);
  }

  /**
   * Check if a component is eligible for multiple validation
   *
   * @return {boolean}
   */
  validateMultiple(value) {
    return this.component.multiple &amp;&amp; Array.isArray(value);
  }

  get errors() {
    return this.error ? [this.error] : [];
  }

  setCustomValidity(message, dirty) {
    if (this.errorElement &amp;&amp; this.errorContainer) {
      this.errorElement.innerHTML = &apos;&apos;;
      this.removeChildFrom(this.errorElement, this.errorContainer);
    }
    if (message) {
      this.error = {
        component: this.component,
        message: message
      };
      this.emit(&apos;componentError&apos;, this.error);
      this.createErrorElement();
      this.addInputError(message, dirty);
    }
    else {
      this.inputs.forEach((input) =&gt; this.removeClass(this.performInputMapping(input), &apos;is-invalid&apos;));
      if (this.options.highlightErrors) {
        this.removeClass(this.element, &apos;alert alert-danger&apos;);
      }
      this.removeClass(this.element, &apos;has-error&apos;);
      this.error = null;
    }
    this.inputs.forEach((input) =&gt; {
      input = this.performInputMapping(input);
      if (typeof input.setCustomValidity === &apos;function&apos;) {
        input.setCustomValidity(message, dirty);
      }
    });
  }

  shouldSkipValidation(data, dirty, rowData) {
    const rules = [
      // Force valid if component is hidden.
      () =&gt; !this.visible,
      // Force valid if component is conditionally hidden.
      () =&gt; !this.checkCondition(rowData, data)
    ];

    return rules.some(pred =&gt; pred());
  }

  /**
   * Set the value at a specific index.
   *
   * @param index
   * @param value
   */
  setValueAt(index, value, flags) {
    flags = flags || {};
    if (!flags.noDefault &amp;&amp; (value === null || value === undefined)) {
      value = this.defaultValue;
    }
    const input = this.performInputMapping(this.inputs[index]);
    if (input.mask) {
      input.mask.textMaskInputElement.update(value);
    }
    else {
      input.value = value;
    }
    if (input.widget) {
      input.widget.setValue(value);
    }
  }

  getFlags() {
    return (typeof arguments[1] === &apos;boolean&apos;) ? {
      noUpdateEvent: arguments[1],
      noValidate: arguments[2]
    } : (arguments[1] || {});
  }

  // Maintain reverse compatibility.
  whenReady() {
    console.warn(&apos;The whenReady() method has been deprecated. Please use the dataReady property instead.&apos;);
    return this.dataReady;
  }

  get dataReady() {
    return Promise.resolve();
  }

  /**
   * Refreshes the component with a new value.
   *
   * @param value
   */
  refresh(value) {
    if (this.hasOwnProperty(&apos;refreshOnValue&apos;)) {
      this.refreshOnChanged = !_.isEqual(value, this.refreshOnValue);
    }
    else {
      this.refreshOnChanged = true;
    }
    this.refreshOnValue = value;
    if (this.refreshOnChanged) {
      if (this.component.clearOnRefresh) {
        this.setValue(null);
      }
      this.triggerRedraw();
    }
  }

  /**
   * Set the value of this component.
   *
   * @param value
   * @param flags
   *
   * @return {boolean} - If the value changed.
   */
  setValue(value, flags) {
    flags = this.getFlags.apply(this, arguments);
    if (!this.hasInput) {
      return false;
    }
    if (this.component.multiple &amp;&amp; !Array.isArray(value)) {
      value = value ? [value] : [];
    }
    this.buildRows(value);
    const isArray = Array.isArray(value);
    for (const i in this.inputs) {
      if (this.inputs.hasOwnProperty(i)) {
        this.setValueAt(i, isArray ? value[i] : value, flags);
      }
    }
    return this.updateValue(flags);
  }

  /**
   * Resets the value of this component.
   */
  resetValue() {
    this.setValue(this.emptyValue, { noUpdateEvent: true, noValidate: true });
    _.unset(this.data, this.key);
  }

  /**
   * Prints out the value of this component as a string value.
   */
  asString(value) {
    value = value || this.getValue();
    return Array.isArray(value) ? value.join(&apos;, &apos;) : value.toString();
  }

  /**
   * Return if the component is disabled.
   * @return {boolean}
   */
  get disabled() {
    return this._disabled;
  }

  /**
   * Disable this component.
   *
   * @param {boolean} disabled
   */
  set disabled(disabled) {
    // Do not allow a component to be disabled if it should be always...
    if ((!disabled &amp;&amp; this.shouldDisable) || (disabled &amp;&amp; !this.shouldDisable)) {
      return;
    }

    this._disabled = disabled;

    // Add/remove the disabled class from the element.
    if (disabled) {
      this.addClass(this.getElement(), &apos;formio-disabled-input&apos;);
    }
    else {
      this.removeClass(this.getElement(), &apos;formio-disabled-input&apos;);
    }

    // Disable all inputs.
    _.each(this.inputs, (input) =&gt; this.setDisabled(this.performInputMapping(input), disabled));
  }

  setDisabled(element, disabled) {
    element.disabled = disabled;
    if (element.widget) {
      element.widget.disabled = disabled;
    }
    if (disabled) {
      element.setAttribute(&apos;disabled&apos;, &apos;disabled&apos;);
    }
    else {
      element.removeAttribute(&apos;disabled&apos;);
    }
  }

  setLoading(element, loading) {
    if (element.loading === loading) {
      return;
    }

    element.loading = loading;
    if (!element.loader &amp;&amp; loading) {
      element.loader = this.ce(&apos;i&apos;, {
        class: `${this.iconClass(&apos;refresh&apos;, true)} button-icon-right`
      });
    }
    if (element.loader) {
      if (loading) {
        this.appendTo(element.loader, element);
      }
      else {
        this.removeChildFrom(element.loader, element);
      }
    }
  }

  selectOptions(select, tag, options, defaultValue) {
    _.each(options, (option) =&gt; {
      const attrs = {
        value: option.value
      };
      if (defaultValue !== undefined &amp;&amp; (option.value === defaultValue)) {
        attrs.selected = &apos;selected&apos;;
      }
      const optionElement = this.ce(&apos;option&apos;, attrs);
      optionElement.appendChild(this.text(option.label));
      select.appendChild(optionElement);
    });
  }

  setSelectValue(select, value) {
    const options = select.querySelectorAll(&apos;option&apos;);
    _.each(options, (option) =&gt; {
      if (option.value === value) {
        option.setAttribute(&apos;selected&apos;, &apos;selected&apos;);
      }
      else {
        option.removeAttribute(&apos;selected&apos;);
      }
    });
    if (select.onchange) {
      select.onchange();
    }
    if (select.onselect) {
      select.onchange();
    }
  }

  /**
   * Destroys and clears a component and returns the current state.
   */
  clear() {
    const state = this.destroy() || {};
    this.empty(this.getElement());
    return state;
  }

  /**
   * Get the element information.
   */
  elementInfo() {
    const attributes = {
      name: this.options.name,
      type: this.component.inputType || &apos;text&apos;,
      class: &apos;form-control&apos;,
      lang: this.options.language,
      id: this.key || this.id
    };

    if (this.component.placeholder) {
      attributes.placeholder = this.t(this.component.placeholder);
    }

    if (this.component.tabindex) {
      attributes.tabindex = this.component.tabindex;
    }

    return {
      type: &apos;input&apos;,
      component: this.component,
      changeEvent: &apos;change&apos;,
      attr: attributes
    };
  }

  autofocus() {
    if (this.component.autofocus) {
      this.on(&apos;render&apos;, () =&gt; this.focus(), true);
    }
  }

  focus() {
    // Do not focus for readOnly forms.
    if (this.options.readOnly) {
      return;
    }
    const input = this.performInputMapping(this.inputs[0]);
    if (input) {
      if (input.widget) {
        input.widget.input.focus();
      }
      else {
        input.focus();
      }
    }
  }

  /**
   * Append an element to this elements containing element.
   *
   * @param {HTMLElement} element - The DOM element to append to this component.
   */
  append(element) {
    this.appendTo(element, this.element);
  }

  /**
   * Prepend an element to this elements containing element.
   *
   * @param {HTMLElement} element - The DOM element to prepend to this component.
   */
  prepend(element) {
    this.prependTo(element, this.element);
  }

  /**
   * Removes a child from this component.
   *
   * @param {HTMLElement} element - The DOM element to remove from this component.
   */
  removeChild(element) {
    this.removeChildFrom(element, this.element);
  }

  attachLogic() {
    this.logic.forEach(logic =&gt; {
      if (logic.trigger.type === &apos;event&apos;) {
        const event = this.interpolate(logic.trigger.event);
        this.on(event, (...args) =&gt; {
          const newComponent = _.cloneDeep(this.originalComponent);
          if (this.applyActions(logic.actions, args, this.data, newComponent)) {
            // If component definition changed, replace it.
            if (!_.isEqual(this.component, newComponent)) {
              this.component = newComponent;
            }
            this.redraw();
          }
        }, true);
      }
    });
  }
}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
